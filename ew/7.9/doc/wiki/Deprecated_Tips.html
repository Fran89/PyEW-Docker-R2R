<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  
  

  


  <head>
    <title>
      Deprecated_Tips – Earthworm
    </title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <!--[if IE]><script type="text/javascript">
      if (/^#__msie303:/.test(window.location.hash))
        window.location.replace(window.location.hash.replace(/^#__msie303:/, '#'));
    </script><![endif]-->
        <link rel="search" href="http://earthwormcentral.com/trac/ew/search" />
        <link rel="help" href="TracGuide.html" />
        <link rel="alternate" href="http://earthwormcentral.com/trac/ew/wiki/Deprecated_Tips?format=txt" type="text/x-trac-wiki" title="Plain Text" />
        <link rel="start" href="http://earthwormcentral.com/trac/ew/wiki" />
        <link rel="stylesheet" href="../chrome/common/css/trac.css" type="text/css" /><link rel="stylesheet" href="../chrome/common/css/wiki.css" type="text/css" /><link rel="stylesheet" href="../chrome/tracjsgantt/jsgantt.css" type="text/css" /><link rel="stylesheet" href="../chrome/tracjsgantt/tracjsgantt.css" type="text/css" />
        <link rel="shortcut icon" href="../chrome/common/trac.ico" type="image/x-icon" />
        <link rel="icon" href="../chrome/common/trac.ico" type="image/x-icon" />
      <link type="application/opensearchdescription+xml" rel="search" href="http://earthwormcentral.com/trac/ew/search/opensearch" title="Search Earthworm" />
    <script type="text/javascript" src="../chrome/common/js/jquery.js"></script><script type="text/javascript" src="../chrome/common/js/babel.js"></script><script type="text/javascript" src="../chrome/common/js/messages/en_US.js"></script><script type="text/javascript" src="../chrome/common/js/trac.js"></script><script type="text/javascript" src="../chrome/common/js/search.js"></script><script type="text/javascript" src="../chrome/common/js/folding.js"></script><script type="text/javascript" src="../chrome/tracjsgantt/jsgantt.js"></script>
    <!--[if lt IE 7]>
    <script type="text/javascript" src="/trac/ew/chrome/common/js/ie_pre7_hacks.js"></script>
    <![endif]-->
    <script type="text/javascript">
      jQuery(document).ready(function($) {
        $("#content").find("h1,h2,h3,h4,h5,h6").addAnchor(_("Link to this section"));
        $("#content").find(".wikianchor").each(function() {
          $(this).addAnchor(babel.format(_("Link to #%(id)s"), {id: $(this).attr('id')}));
        });
        $(".foldable").enableFolding(true, true);
      });
    </script>
  </head>
  <body>
    <div id="banner">
      <div id="header">
        <a id="logo" href="http://earthwormcentral.com/trac/ew"><img src="../chrome/site/images/ew.logo_tiny.png" alt="" /></a>
      </div>
      <form id="search" action="http://earthwormcentral.com/trac/ew/search" method="get">
        <div>
          <label for="proj-search">Search:</label>
          <input type="text" id="proj-search" name="q" size="18" value="" />
          <input type="submit" value="Search" />
        </div>
      </form>
      <div id="metanav" class="nav">
    <ul>
      <li class="first"><a href="http://earthwormcentral.com/trac/ew/login">Login</a></li><li><a href="TracGuide.html">Help/Guide</a></li><li><a href="http://earthwormcentral.com/trac/ew/about">About Trac</a></li><li class="last"><a href="http://earthwormcentral.com/trac/ew/prefs">Preferences</a></li>
    </ul>
  </div>
    </div>
    <div id="mainnav" class="nav">
    <ul>
      <li class="first active"><a href="http://earthwormcentral.com/trac/ew/wiki">Wiki</a></li><li><a href="http://earthwormcentral.com/trac/ew/timeline">Timeline</a></li><li><a href="http://earthwormcentral.com/trac/ew/roadmap">Roadmap</a></li><li><a href="http://earthwormcentral.com/trac/ew/browser">Browse Source</a></li><li><a href="http://earthwormcentral.com/trac/ew/query">View Tickets</a></li><li class="last"><a href="http://earthwormcentral.com/trac/ew/search">Search</a></li>
    </ul>
  </div>
    <div id="main">
      <div id="pagepath" class="noprint">
  <a class="pathentry first" title="View WikiStart" href="http://earthwormcentral.com/trac/ew/wiki">wiki:</a><a class="pathentry" href="Deprecated_Tips.html" title="View Deprecated_Tips">Deprecated_Tips</a>
</div>
      <div id="ctxtnav" class="nav">
        <h2>Context Navigation</h2>
          <ul>
              <li class="first"><a href="WikiStart.html">Start Page</a></li><li><a href="TitleIndex.html">Index</a></li><li class="last"><a href="http://earthwormcentral.com/trac/ew/wiki/Deprecated_Tips?action=history">History</a></li>
          </ul>
        <hr />
      </div>
    <div id="content" class="wiki">
      <div class="wikipage searchable">
        
          
          <div class="trac-modifiedby">
            <span><a href="http://earthwormcentral.com/trac/ew/wiki/Deprecated_Tips?action=diff&amp;version=1" title="Version 1 by stefan">Last modified</a> <a class="timeline" href="http://earthwormcentral.com/trac/ew/timeline?from=2013-09-11T22%3A09%3A59-07%3A00&amp;precision=second" title="2013-09-11T22:09:59-07:00 in Timeline">15 minutes</a> ago</span>
            <span class="trac-print">Last modified on 09/11/13 22:09:59</span>
          </div>
          <div id="wikipage"><p>
If you want to look at the Status of Earthworm, or if you want to Restart an Earthworm module or Reconfigure Earthworm's modules and rings, and you aren't logged in as Administrator, you can either use StartstopConsole, or you can do the following if you know the Administrator password: (Instructions for <strong>Windows XP</strong>, but may work on other versions of Windows. See below for Vista.):<br />
</p>
<ul><li>Go to the Windows Start menu, and choose "Run"<br />
</li><li>Type the following:
</li></ul><pre class="wiki">runas /user:YOUR_MACHINE_NAME_HERE\administrator cmd
</pre><ul><li>This will open up a command window which should be able to connect to the running Earthworm, and thus allow you to type "restart", "reconfigure", "status", "pidpau" or "pau" here.
</li></ul><ul><li>To view what's going on in <strong>Vista or Windows Server 2008</strong>
</li></ul><p>
StartstopConsole won't work in Vista, nor will "runas" give you access to the session zero.<br />
</p>
<ul><li>Beforehand, add 'cmd' as a line in your startstop_nt.d with a NewConsole, and reboot so the service starts this up.<br />
</li><li>if you're not at the machine, make a remote desktop connection as whatever user you like<br />
</li><li>open a command prompt<br />
</li><li>if you're not running as administrator, in the command prompt type:<br />
<pre class="wiki">runas /user:YOUR_MACHINE_NAME_HERE\administrator cmd
</pre></li></ul><p>
enter the admin password<br />
</p>
<ul><li>in the new administrator command prompt that comes up type:
<pre class="wiki">sc config ui0detect start= auto
sc start ui0detect
</pre></li></ul><p>
(if you get a Interactive Services Detection dialog, you can choose "Ask me later)
</p>
<p>
Once you've done all of the above, you can access session zero. The machine could be rebooted, different users couldlog in, etc. For any user to access startstop_service's session zero:
</p>
<ul><li>in a command prompt window now you can type:
<pre class="wiki">rundll32 winsta.dll,WinStationSwitchToServicesSession
</pre></li></ul><p>
This will switch you to console 0. If you added a cmd prompt to startstop_nt.d, you should see it here now, and can type "status" or whatever.
</p>
<p>
That's a bit of a handful to type. Since your earthworm bin directory is already in your Windows path, you can cd to that bin directory and do something like:
</p>
<pre class="wiki">echo rundll32 winsta.dll,WinStationSwitchToServicesSession &gt; session0.bat
</pre><p>
So now you can just type "session0" at a command prompt to get to the startstop session.
</p>
<p>
Note that this means that ANY user of the system will be able to get a prompt with administrator privileges. I this essentially the same power one has with startstopconsole which has been part of Earthworm for a while.
</p>
<p>
(This was all tested with Vista. It _should_ work with Windows Server 2008 too, but hasn't been tested there yet. If you do it successfully or unsuccessfully please let us know.)
</p>
<p>
With <strong>2003 Server</strong>
</p>
<p>
How to Connect to the Console Session
</p>
<p>
(From <a class="ext-link" href="http://support.microsoft.com/kb/278845"><span class="icon">​</span>http://support.microsoft.com/kb/278845</a>)
</p>
<p>
When you connect to the console session of a Windows Server 2003-based server, no other user has to be already logged on to the console session. Even if no one is logged on to the console, you are logged on just as if you were sitting at the physical console.
</p>
<p>
To connect from the remote Windows Server 2003-based computer, open a command prompt, and then type the following command:
</p>
<pre class="wiki">mstsc -v:servername /F -console
</pre><p>
where mstsc is the Remote Desktop connection executable file, -v indicates a server to connect to, /F indicates full screen mode, and -console is the instruction to connect to the console session.
</p>
</div>
        
        
      </div>
      

    </div>
    <div id="altlinks">
      <h3>Download in other formats:</h3>
      <ul>
        <li class="last first">
          <a rel="nofollow" href="http://earthwormcentral.com/trac/ew/wiki/Deprecated_Tips?format=txt">Plain Text</a>
        </li>
      </ul>
    </div>
    </div>
    <div id="footer" lang="en" xml:lang="en"><hr />
      <a id="tracpowered" href="http://trac.edgewall.org/"><img src="../chrome/common/trac_logo_mini.png" height="30" width="107" alt="Trac Powered" /></a>
      <p class="left">Powered by <a href="http://earthwormcentral.com/trac/ew/about"><strong>Trac 0.12.4</strong></a><br />
        By <a href="http://www.edgewall.org/">Edgewall Software</a>.</p>
      <p class="right">Visit the Trac open source project at<br /><a href="http://trac.edgewall.org/">http://trac.edgewall.org/</a></p>
    </div>
  </body>
</html>