<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  
  

  


  <head>
    <title>
      coaxtoring â€“ Earthworm
    </title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <!--[if IE]><script type="text/javascript">
      if (/^#__msie303:/.test(window.location.hash))
        window.location.replace(window.location.hash.replace(/^#__msie303:/, '#'));
    </script><![endif]-->
        <link rel="search" href="http://earthwormcentral.com/trac/ew/search" />
        <link rel="help" href="TracGuide.html" />
        <link rel="alternate" href="http://earthwormcentral.com/trac/ew/wiki/coaxtoring?format=txt" type="text/x-trac-wiki" title="Plain Text" />
        <link rel="start" href="http://earthwormcentral.com/trac/ew/wiki" />
        <link rel="stylesheet" href="../chrome/common/css/trac.css" type="text/css" /><link rel="stylesheet" href="../chrome/common/css/wiki.css" type="text/css" /><link rel="stylesheet" href="../chrome/tracjsgantt/jsgantt.css" type="text/css" /><link rel="stylesheet" href="../chrome/tracjsgantt/tracjsgantt.css" type="text/css" />
        <link rel="shortcut icon" href="../chrome/common/trac.ico" type="image/x-icon" />
        <link rel="icon" href="../chrome/common/trac.ico" type="image/x-icon" />
      <link type="application/opensearchdescription+xml" rel="search" href="http://earthwormcentral.com/trac/ew/search/opensearch" title="Search Earthworm" />
    <script type="text/javascript" src="../chrome/common/js/jquery.js"></script><script type="text/javascript" src="../chrome/common/js/babel.js"></script><script type="text/javascript" src="../chrome/common/js/messages/en_US.js"></script><script type="text/javascript" src="../chrome/common/js/trac.js"></script><script type="text/javascript" src="../chrome/common/js/search.js"></script><script type="text/javascript" src="../chrome/common/js/folding.js"></script><script type="text/javascript" src="../chrome/tracjsgantt/jsgantt.js"></script>
    <!--[if lt IE 7]>
    <script type="text/javascript" src="/trac/ew/chrome/common/js/ie_pre7_hacks.js"></script>
    <![endif]-->
    <script type="text/javascript">
      jQuery(document).ready(function($) {
        $("#content").find("h1,h2,h3,h4,h5,h6").addAnchor(_("Link to this section"));
        $("#content").find(".wikianchor").each(function() {
          $(this).addAnchor(babel.format(_("Link to #%(id)s"), {id: $(this).attr('id')}));
        });
        $(".foldable").enableFolding(true, true);
      });
    </script>
  </head>
  <body>
    <div id="banner">
      <div id="header">
        <a id="logo" href="http://earthwormcentral.com/trac/ew"><img src="../chrome/site/images/ew.logo_tiny.png" alt="" /></a>
      </div>
      <form id="search" action="http://earthwormcentral.com/trac/ew/search" method="get">
        <div>
          <label for="proj-search">Search:</label>
          <input type="text" id="proj-search" name="q" size="18" value="" />
          <input type="submit" value="Search" />
        </div>
      </form>
      <div id="metanav" class="nav">
    <ul>
      <li class="first"><a href="http://earthwormcentral.com/trac/ew/login">Login</a></li><li><a href="TracGuide.html">Help/Guide</a></li><li><a href="http://earthwormcentral.com/trac/ew/about">About Trac</a></li><li class="last"><a href="http://earthwormcentral.com/trac/ew/prefs">Preferences</a></li>
    </ul>
  </div>
    </div>
    <div id="mainnav" class="nav">
    <ul>
      <li class="first active"><a href="http://earthwormcentral.com/trac/ew/wiki">Wiki</a></li><li><a href="http://earthwormcentral.com/trac/ew/timeline">Timeline</a></li><li><a href="http://earthwormcentral.com/trac/ew/roadmap">Roadmap</a></li><li><a href="http://earthwormcentral.com/trac/ew/browser">Browse Source</a></li><li><a href="http://earthwormcentral.com/trac/ew/query">View Tickets</a></li><li class="last"><a href="http://earthwormcentral.com/trac/ew/search">Search</a></li>
    </ul>
  </div>
    <div id="main">
      <div id="pagepath" class="noprint">
  <a class="pathentry first" title="View WikiStart" href="http://earthwormcentral.com/trac/ew/wiki">wiki:</a><a class="pathentry" href="coaxtoring.html" title="View coaxtoring">coaxtoring</a>
</div>
      <div id="ctxtnav" class="nav">
        <h2>Context Navigation</h2>
          <ul>
              <li class="first"><a href="WikiStart.html">Start Page</a></li><li><a href="TitleIndex.html">Index</a></li><li class="last"><a href="http://earthwormcentral.com/trac/ew/wiki/coaxtoring?action=history">History</a></li>
          </ul>
        <hr />
      </div>
    <div id="content" class="wiki">
      <div class="wikipage searchable">
        
          
          <div class="trac-modifiedby">
            <span><a href="http://earthwormcentral.com/trac/ew/wiki/coaxtoring?action=diff&amp;version=5" title="Version 5 by branden">Last modified</a> <a class="timeline" href="http://earthwormcentral.com/trac/ew/timeline?from=2012-05-02T09%3A28%3A50-07%3A00&amp;precision=second" title="2012-05-02T09:28:50-07:00 in Timeline">17 months</a> ago</span>
            <span class="trac-print">Last modified on 05/02/12 09:28:50</span>
          </div>
          <div id="wikipage"><p>
</p><div class="wiki-toc">
<ol>
  <li>
    <a href="coaxtoring.html#EarthwormModule:coaxtoring">Earthworm Module: coaxtoring</a>
    <ol>
      <li>
        <a href="coaxtoring.html#Function">Function</a>
      </li>
      <li>
        <a href="coaxtoring.html#Details">Details</a>
      </li>
      <li>
        <a href="coaxtoring.html#ConfigurationFileCommands">Configuration File Commands</a>
        <ol>
          <li>
            <a href="coaxtoring.html#EXAMPLECONFIGURATIONFILE">EXAMPLE CONFIGURATION FILE</a>
          </li>
          <li>
            <a href="coaxtoring.html#FUNCTIONALCOMMANDLISTING">FUNCTIONAL COMMAND LISTING</a>
          </li>
          <li>
            <a href="coaxtoring.html#ALPHABETICCOMMANDLISTINGDESCRIPTION">ALPHABETIC COMMAND LISTING &amp; DESCRIPTION</a>
          </li>
        </ol>
      </li>
      <li>
        <a href="coaxtoring.html#HelpfulHints">Helpful Hints</a>
      </li>
    </ol>
  </li>
</ol>
</div><p>
</p>
<h1 id="EarthwormModule:coaxtoring"><a class="wiki" href="Earthworm.html">Earthworm</a> Module: coaxtoring</h1>
<p>
<strong>Contributed by: </strong>
</p>
<h2 id="Function">Function</h2>
<p>
Reads EARTHWORM messages from Ethernet and places them into shared memory. This program copies Earthworm messages from Ethernet to local shared memory (known as a "transport ring"). Incoming messages may be of any installation id, message type, and module id, but they must have the same port number, specified in the configuration file. The program has three threads. The first thread (MsgIn) collects packets and assembles them into messages. The second thread writes messages to the transport shared memory ring buffer. The third thread generates heartbeat messages. Messages are transferred without translation of any kind.
</p>
<h2 id="Details">Details</h2>
<h2 id="ConfigurationFileCommands">Configuration File Commands</h2>
<p>
On startup, coaxtoring reads the configuration file named on the command line. Commands in this file set up all parameters used in receiving UDP broadcast Earthworm messages from the network and placing them into shared memory. In the control file, lines may begin with a valid coaxtoring command (listed below) or with one of 2 special characters:
</p>
<pre class="wiki">#  marks the line as a comment (example: # This is a comment).

@  allows control files to be nested; one control file can be
   accessed from another with the command "@" followed by
   a string representing the path name of the next control file
   (example: @model.d).
</pre><p>
Command names must be typed in the control file exactly as shown in this document (upper/lower case matters!).
</p>
<h3 id="EXAMPLECONFIGURATIONFILE">EXAMPLE CONFIGURATION FILE</h3>
<pre class="wiki">#
#
# coaxtoring configuration file
#
#   The setup is different for Solaris and NT. The specified address
#   will be used to receive class c subnet broadcasts.
#
# Solaris:    InAddress must be of the form xxx.xxx.xxx.255
# Windows NT: InAddress must be the complete local address, eg
#             192.168.4.107
#
MyModuleId   MOD_COAXTORING_A   # Module id for this process
RingName     WAVE_RING          # Write to this shared memory region
LogFile      1                  # 1=write log file on disk; 0=don't
                                # 2=write to module log but not stderr/stdout
nMsgBuf      16                 # There should be at least one buffer per logo
MsgMaxBytes  51740              # Size of biggest message to be received
InAddress    192.168.4.255      # IP address of ethernet line to read

PortNumber   990                # Usually 990 (waveforms) or 5555 (picks)
                                # Under Solaris, if the port number is at
                                #  or below 1024, the program must run as root.

ScrnMsg      1                  # 1=print messages on screen; 0=don't
HeartbeatInt 30                 # Heartbeat interval in seconds
BufferReportInt 300             # Print high buffer count every n seconds

RcvBufSize   260000             # Size of socket receive buffer, in bytes.
                                # Set RcvBufSize to a large number to avoid
                                #   dropping packets.
                                # Max value is system dependent
                                #  (typically 260000)
                                # If you set =0, it will default to the
				        # system default. (typically 8192)
</pre><h3 id="FUNCTIONALCOMMANDLISTING">FUNCTIONAL COMMAND LISTING</h3>
<p>
Below are the commands recognized by coaxtoring, grouped by the function they influence. All of the commands are required; they must be specified in the control file in order for coaxtoring to operate.
</p>
<pre class="wiki">        Earthworm system setup:
		HeartBeatInt 	 	required
 		MyModuleId	   	required
		RingName	   	required

	Network Information:
		InAddress	   	required
		PortNumber	   	required

	Message Handling:
		nMsgBuf	   		required
		MsgMaxBytes	   	required
		RcvBufSize	   	required

	Output Control:
		ScrnMsg	   		required
		LogFile		   	required
		BufferReportInt   	required
</pre><h3 id="ALPHABETICCOMMANDLISTINGDESCRIPTION">ALPHABETIC COMMAND LISTING &amp; DESCRIPTION</h3>
<p>
In the following section, all configuration file commands are listed in alphabetical order. Listed along with the command (bold-type) are its arguments (in red), the name of the subroutine that processes the command, and the function within the module that the command influences. A detailed description of the command and is also given. Default values and example commands are listed after each command description.
</p>
<p>
The following list is organized by:
</p>
<p>
command [argument here]
</p>
<p>
<strong>BufferReportInt [nbytes]</strong><br />
Processed by: coaxtoring_config<br />
Function: msg handling
</p>
<p>
Print high buffer count every n seconds
</p>
<pre class="wiki">Default:  none
Calnet:   BufferReportInt 300
</pre><p>
<strong>HeartBeatInt [nsec]</strong><br />
Processed by: coaxtoring_config<br />
Function: Earthworm setup
</p>
<p>
Defines the number of seconds nsec between TYPE_HEARTBEAT messages issued by coaxtoring.
</p>
<pre class="wiki">Default:  none
Calnet:   HeartBeatInt 5
</pre><p>
<strong>InAddress [a.b.c.d]</strong><br />
Processed by: coaxtoring_config<br />
Function: network info
</p>
<p>
Tells coaxtoring the TCP/IP address of the ethernet line that it should listen to. a.b.c.d is a character string in tcp/ip's standard dotted-decimal notation that coaxtoring uses along with the port number from the "PortNumber" command to set up a socket from which it will receive UDP Datagram packets. Under Solaris, the "d" part of the address should be set to 255 (for example a.b.c.255). Under NT, the "d" part of the address should be set to the complete local address, eg 192.168.4.107.
</p>
<pre class="wiki">Default:  none
Example:  InAddress 130.118.49.255 (Solaris)
Example:  InAddress 192.168.4.107 (NT)
</pre><p>
<strong>LogFile [switch]</strong><br />
Processed by: coaxtoring_config<br />
Function: output
</p>
<p>
Sets the on-off switch for writing a log file to disk. If switch is 0, no log file will be written. If switch is 1, coaxtoring will write a daily log file(s) called coaxtoringxx.log_yymmdd where xx is coaxtoring's module id (set with "MyModuleId" command) and yymmdd is the current UTC date (ex: 960123) on the system clock. The file(s) will be written in the EW_LOG directory (environment variable).
</p>
<pre class="wiki">Default:  none
</pre><p>
<strong>MsgMaxBytes [nbytes]</strong><br />
Processed by: coaxtoring_config<br />
Function: msg handling
</p>
<p>
Sets the size, in bytes, of the working buffers that coaxtoring uses for rebuilding complete Earthworm messages out of the UDP packets. nbytes should be the size of the largest message you expect coaxtoring to receive. If coaxtoring receives a message larger than nbytes, it will drop the entire message and issue a TYPE_ERROR message containing the string "Message buffer overflow" and the logo of the dropped message.
</p>
<pre class="wiki">Default:  none
Calnet:   MsgMaxBytes 51740
</pre><p>
<strong>MyModuleId [mod_id]</strong><br />
Processed by: coaxtoring_config<br />
Function: Earthworm setup
</p>
<p>
Sets the module id for labeling all outgoing heartbeat and error messages. mod_id is a character string (valid strings are listed in earthworm.d) that relates (in earthworm.d) to a unique single-byte number. All messages that coaxtoring receives from ethernet are tagged with their original logos when they are placed into shared memory.
</p>
<pre class="wiki">Default:  none
Calnet:   MyModuleId MOD_COAXTORING
</pre><p>
<strong>nMsgBuf [nbuf]</strong><br />
Processed by: coaxtoring_config<br />
Function: msg handling
</p>
<p>
Defines the number of working buffers nbuf that coaxtoring should allocate. Coaxtoring uses the buffers for rebuilding complete Earthworm messages out of the UDP packets it receives from ethernet. There should be at least one buffer for each different message logo that coaxtoring might see. The maximum allowed number of buffers is controlled by MAX_BUF, currently defined to be 16 in coaxtoring.c. The size of each buffer is set with the "MsgMaxBytes" command.
</p>
<pre class="wiki">Default:  none
Calnet:   nMsgBuf 16
</pre><p>
<strong>PortNumber [port]</strong><br />
Processed by: coaxtoring_config<br />
Function: network info
</p>
<p>
Defines the well-known port number port which coaxtoring will listen to. port is an integer that coaxtoring uses along with the address from the "InAddress" command to set up a socket from which it will receive UDP Datagram packets. 
</p>
<p>
NOTE: The port number must be greater than 1024. Smaller port numbers require root permission.
</p>
<pre class="wiki">Default:  none
Example:  PortNumber 2025
</pre><p>
<strong>RcvBufSize [ring]</strong><br />
Processed by: coaxtoring_config<br />
Function: Earthworm setup
</p>
<p>
Tells coaxtoring the size of the socket receive buffer, in bytes. Set RcvBufSize to a large number to avoid dropping packets. Maximum value is system dependent, typically 260000. If no buffering desired, use the system default size, typically 8192. To determine the default size, set RcvBufSize to zero. When coaxtoring is restarted, it will log a message giving you the default buffer size. The maximum size can be found by trial and error. If the value exceeds the maximum value, coaxtoring will log the message: "Error resetting receive buffer size" and exit.
</p>
<pre class="wiki">Default:  none
Example:  RcvBufSize 260000
</pre><p>
<strong>RingName [ring]</strong><br />
Processed by: coaxtoring_config<br />
Function: Earthworm setup
</p>
<p>
Tells coaxtoring which shared memory region to use for output. ring is a character string (valid strings are listed in earthworm.d) that relates (in earthworm.d) to a unique number for the key to the shared memory region. All messages that coaxtoring receives from ethernet are tagged with their original logos when they are placed into shared memory.
</p>
<pre class="wiki">Default:  none
Example:  RingName WAVE_RING
</pre><p>
<strong>ScrnMsg [switch]</strong><br />
Processed by: coaxtoring_config<br />
Function: output
</p>
<p>
Sets a switch for writing messages to the screen. If switch is 1, a line is printed to the screen detailing the logo and the sequence number of each Earthworm message received from the ethernet. If switch is 0, no messages are written to the screen.
</p>
<pre class="wiki">Default:  none
Example:  ScrnMsg 0
</pre><h2 id="HelpfulHints">Helpful Hints</h2>
</div>
        
        
      </div>
      

    </div>
    <div id="altlinks">
      <h3>Download in other formats:</h3>
      <ul>
        <li class="last first">
          <a rel="nofollow" href="http://earthwormcentral.com/trac/ew/wiki/coaxtoring?format=txt">Plain Text</a>
        </li>
      </ul>
    </div>
    </div>
    <div id="footer" lang="en" xml:lang="en"><hr />
      <a id="tracpowered" href="http://trac.edgewall.org/"><img src="../chrome/common/trac_logo_mini.png" height="30" width="107" alt="Trac Powered" /></a>
      <p class="left">Powered by <a href="http://earthwormcentral.com/trac/ew/about"><strong>Trac 0.12.4</strong></a><br />
        By <a href="http://www.edgewall.org/">Edgewall Software</a>.</p>
      <p class="right">Visit the Trac open source project at<br /><a href="http://trac.edgewall.org/">http://trac.edgewall.org/</a></p>
    </div>
  </body>
</html>