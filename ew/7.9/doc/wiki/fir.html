<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  
  

  


  <head>
    <title>
      fir â€“ Earthworm
    </title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <!--[if IE]><script type="text/javascript">
      if (/^#__msie303:/.test(window.location.hash))
        window.location.replace(window.location.hash.replace(/^#__msie303:/, '#'));
    </script><![endif]-->
        <link rel="search" href="http://earthwormcentral.com/trac/ew/search" />
        <link rel="help" href="TracGuide.html" />
        <link rel="alternate" href="http://earthwormcentral.com/trac/ew/wiki/fir?format=txt" type="text/x-trac-wiki" title="Plain Text" />
        <link rel="start" href="http://earthwormcentral.com/trac/ew/wiki" />
        <link rel="stylesheet" href="../chrome/common/css/trac.css" type="text/css" /><link rel="stylesheet" href="../chrome/common/css/wiki.css" type="text/css" /><link rel="stylesheet" href="../chrome/tracjsgantt/jsgantt.css" type="text/css" /><link rel="stylesheet" href="../chrome/tracjsgantt/tracjsgantt.css" type="text/css" />
        <link rel="shortcut icon" href="../chrome/common/trac.ico" type="image/x-icon" />
        <link rel="icon" href="../chrome/common/trac.ico" type="image/x-icon" />
      <link type="application/opensearchdescription+xml" rel="search" href="http://earthwormcentral.com/trac/ew/search/opensearch" title="Search Earthworm" />
    <script type="text/javascript" src="../chrome/common/js/jquery.js"></script><script type="text/javascript" src="../chrome/common/js/babel.js"></script><script type="text/javascript" src="../chrome/common/js/messages/en_US.js"></script><script type="text/javascript" src="../chrome/common/js/trac.js"></script><script type="text/javascript" src="../chrome/common/js/search.js"></script><script type="text/javascript" src="../chrome/common/js/folding.js"></script><script type="text/javascript" src="../chrome/tracjsgantt/jsgantt.js"></script>
    <!--[if lt IE 7]>
    <script type="text/javascript" src="/trac/ew/chrome/common/js/ie_pre7_hacks.js"></script>
    <![endif]-->
    <script type="text/javascript">
      jQuery(document).ready(function($) {
        $("#content").find("h1,h2,h3,h4,h5,h6").addAnchor(_("Link to this section"));
        $("#content").find(".wikianchor").each(function() {
          $(this).addAnchor(babel.format(_("Link to #%(id)s"), {id: $(this).attr('id')}));
        });
        $(".foldable").enableFolding(true, true);
      });
    </script>
  </head>
  <body>
    <div id="banner">
      <div id="header">
        <a id="logo" href="http://earthwormcentral.com/trac/ew"><img src="../chrome/site/images/ew.logo_tiny.png" alt="" /></a>
      </div>
      <form id="search" action="http://earthwormcentral.com/trac/ew/search" method="get">
        <div>
          <label for="proj-search">Search:</label>
          <input type="text" id="proj-search" name="q" size="18" value="" />
          <input type="submit" value="Search" />
        </div>
      </form>
      <div id="metanav" class="nav">
    <ul>
      <li class="first"><a href="http://earthwormcentral.com/trac/ew/login">Login</a></li><li><a href="TracGuide.html">Help/Guide</a></li><li><a href="http://earthwormcentral.com/trac/ew/about">About Trac</a></li><li class="last"><a href="http://earthwormcentral.com/trac/ew/prefs">Preferences</a></li>
    </ul>
  </div>
    </div>
    <div id="mainnav" class="nav">
    <ul>
      <li class="first active"><a href="http://earthwormcentral.com/trac/ew/wiki">Wiki</a></li><li><a href="http://earthwormcentral.com/trac/ew/timeline">Timeline</a></li><li><a href="http://earthwormcentral.com/trac/ew/roadmap">Roadmap</a></li><li><a href="http://earthwormcentral.com/trac/ew/browser">Browse Source</a></li><li><a href="http://earthwormcentral.com/trac/ew/query">View Tickets</a></li><li class="last"><a href="http://earthwormcentral.com/trac/ew/search">Search</a></li>
    </ul>
  </div>
    <div id="main">
      <div id="pagepath" class="noprint">
  <a class="pathentry first" title="View WikiStart" href="http://earthwormcentral.com/trac/ew/wiki">wiki:</a><a class="pathentry" href="fir.html" title="View fir">fir</a>
</div>
      <div id="ctxtnav" class="nav">
        <h2>Context Navigation</h2>
          <ul>
              <li class="first"><a href="WikiStart.html">Start Page</a></li><li><a href="TitleIndex.html">Index</a></li><li class="last"><a href="http://earthwormcentral.com/trac/ew/wiki/fir?action=history">History</a></li>
          </ul>
        <hr />
      </div>
    <div id="content" class="wiki">
      <div class="wikipage searchable">
        
          
          <div class="trac-modifiedby">
            <span><a href="http://earthwormcentral.com/trac/ew/wiki/fir?action=diff&amp;version=2" title="Version 2 by branden">Last modified</a> <a class="timeline" href="http://earthwormcentral.com/trac/ew/timeline?from=2012-03-25T13%3A49%3A41-07%3A00&amp;precision=second" title="2012-03-25T13:49:41-07:00 in Timeline">18 months</a> ago</span>
            <span class="trac-print">Last modified on 03/25/12 13:49:41</span>
          </div>
          <div id="wikipage"><p>
</p><div class="wiki-toc">
<ol>
  <li>
    <a href="fir.html#EarthwormModule:fir">Earthworm Module: fir</a>
    <ol>
      <li>
        <a href="fir.html#Function">Function</a>
      </li>
      <li>
        <a href="fir.html#Details">Details</a>
        <ol>
          <li>
            <a href="fir.html#ExampleConfigurationFile">Example Configuration File</a>
          </li>
        </ol>
      </li>
      <li>
        <a href="fir.html#HelpfulHints">Helpful Hints</a>
      </li>
    </ol>
  </li>
</ol>
</div><p>
</p>
<h1 id="EarthwormModule:fir"><a class="wiki" href="Earthworm.html">Earthworm</a> Module: fir</h1>
<p>
<strong>Contributed by: </strong>
</p>
<h2 id="Function">Function</h2>
<p>
Implements a general-purpose FIR filter for trace data.
</p>
<h2 id="Details">Details</h2>
<p>
The fir module implements a general-purpose FIR filter routine to process wave data (TYPE_TRACEBUF2) coming from the InRing defined in decimate.d. Decimated trace messages are written to the OutRing with their SCNs changed as specified in fir.d. The filtered trace message retains its TYPE_TRACEBUF2 type, but it (normally) has a new SCNL name. This module can be configured as a low-pass, high-pass, multi-band pass or notch filter. By using multiple Band commands in the configuration file any of these filter types can be specified.
</p>
<p>
This FIR filter causes considerable time delay in the data. Fortunately filter has linear phase so the delay does not change the shape of the wave. This delay is removed by adjusting the timestamp of the output data, resulting in zero phase delay. Note that there will be small precursory artifacts before impulsive wave arrivals. See "Of Poles and Zeros" by Frank Scherbaum for more details. The FIR filter coefficients are determined using the Remez Exchange algorithm. This produces an equi-ripple filter. The coefficients and zeroes of the filter, as well as the effective delay, are logged on startup. (FIR filters have no poles.)
</p>
<h3 id="ExampleConfigurationFile">Example Configuration File</h3>
<pre class="wiki">#
#                     Configuration File for Fir
#
MyModId          MOD_FIR
InRing           WAVE_RING       # Transport ring to find waveform data on,
OutRing          WAVE_RING       # Transport ring to write output to,
                                 # InRing and OutRing may be the same.
HeartBeatInterval     30         # Heartbeat interval, in seconds,
LogFile            1             # 1 -&gt; Keep log, 0 -&gt; no log file
#Debug		 		 # Write out debug messages (optional)

MaxGap              1.5         # Maximum gap, in sample periods, allowed
                                # between trace data points.
                                # When exceeded, channel is restarted.

# Specify the filter frequency response characteristics with two or more
# commands fo the form: Band    
#
# where:
#   f_low = low frequency limit of a band
#   f_high = high frequency limit of a band
#   level = desired level of the band: 1 for pass band, 0 for stop band
#   deviation = amount of ripple allowed from desired level
#
# All frequencies specified must be in the range 0.0 - 1.0, where 1.0
# corresponds to the Nyquist frequency. (Nyquist frequency is half the sample
# rate and is the maximum frequency content that can be in a time series.)
# One band must start at 0.0 frequency; one band must end at 1.0 frequency. Any
# number of additional bands may be specified (up to a total of ten bands.)
Band 0.0 0.3 1 0.005
Band 0.4 1.0 0 0.005

# If you want Fir to compute and log its filter coefficients and then
# exit, specify "TestMode".
#TestMode

# NEW OPTIONAL SETTINGS FOR Earthworm release 7.5
# optional setting to allow a queue buffer size larger than 100 messages, defaults to 100
QueueSize 2000
# optional setting to allow a shorter sleep between ring pollings, defaults to 500
SleepMilliSeconds 50

 #
# Specify logos of the messages to grab from the InRing.
# TYPE_TRACEBUF is assumed, therefore only module ID and
# installation ID need to be specified
#
GetWavesFrom    INST_WILDCARD MOD_WILDCARD  # TYPE_TRACEBUF (assumed)

#
# List SCNL codes of trace messages to fir and their output SCNL codes
# Wildcard characters are not allowed here.
#
#        IN-SCNL     OUT-SCNL
GetSCNL TEST EHZ UW --  TEST EWZ UW --
</pre><h2 id="HelpfulHints">Helpful Hints</h2>
</div>
        
        
      </div>
      

    </div>
    <div id="altlinks">
      <h3>Download in other formats:</h3>
      <ul>
        <li class="last first">
          <a rel="nofollow" href="http://earthwormcentral.com/trac/ew/wiki/fir?format=txt">Plain Text</a>
        </li>
      </ul>
    </div>
    </div>
    <div id="footer" lang="en" xml:lang="en"><hr />
      <a id="tracpowered" href="http://trac.edgewall.org/"><img src="../chrome/common/trac_logo_mini.png" height="30" width="107" alt="Trac Powered" /></a>
      <p class="left">Powered by <a href="http://earthwormcentral.com/trac/ew/about"><strong>Trac 0.12.4</strong></a><br />
        By <a href="http://www.edgewall.org/">Edgewall Software</a>.</p>
      <p class="right">Visit the Trac open source project at<br /><a href="http://trac.edgewall.org/">http://trac.edgewall.org/</a></p>
    </div>
  </body>
</html>