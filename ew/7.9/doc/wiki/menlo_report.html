<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  
  

  


  <head>
    <title>
      menlo_report â€“ Earthworm
    </title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <!--[if IE]><script type="text/javascript">
      if (/^#__msie303:/.test(window.location.hash))
        window.location.replace(window.location.hash.replace(/^#__msie303:/, '#'));
    </script><![endif]-->
        <link rel="search" href="http://earthwormcentral.com/trac/ew/search" />
        <link rel="help" href="TracGuide.html" />
        <link rel="alternate" href="http://earthwormcentral.com/trac/ew/wiki/menlo_report?format=txt" type="text/x-trac-wiki" title="Plain Text" />
        <link rel="start" href="http://earthwormcentral.com/trac/ew/wiki" />
        <link rel="stylesheet" href="../chrome/common/css/trac.css" type="text/css" /><link rel="stylesheet" href="../chrome/common/css/wiki.css" type="text/css" /><link rel="stylesheet" href="../chrome/tracjsgantt/jsgantt.css" type="text/css" /><link rel="stylesheet" href="../chrome/tracjsgantt/tracjsgantt.css" type="text/css" />
        <link rel="shortcut icon" href="../chrome/common/trac.ico" type="image/x-icon" />
        <link rel="icon" href="../chrome/common/trac.ico" type="image/x-icon" />
      <link type="application/opensearchdescription+xml" rel="search" href="http://earthwormcentral.com/trac/ew/search/opensearch" title="Search Earthworm" />
    <script type="text/javascript" src="../chrome/common/js/jquery.js"></script><script type="text/javascript" src="../chrome/common/js/babel.js"></script><script type="text/javascript" src="../chrome/common/js/messages/en_US.js"></script><script type="text/javascript" src="../chrome/common/js/trac.js"></script><script type="text/javascript" src="../chrome/common/js/search.js"></script><script type="text/javascript" src="../chrome/common/js/folding.js"></script><script type="text/javascript" src="../chrome/tracjsgantt/jsgantt.js"></script>
    <!--[if lt IE 7]>
    <script type="text/javascript" src="/trac/ew/chrome/common/js/ie_pre7_hacks.js"></script>
    <![endif]-->
    <script type="text/javascript">
      jQuery(document).ready(function($) {
        $("#content").find("h1,h2,h3,h4,h5,h6").addAnchor(_("Link to this section"));
        $("#content").find(".wikianchor").each(function() {
          $(this).addAnchor(babel.format(_("Link to #%(id)s"), {id: $(this).attr('id')}));
        });
        $(".foldable").enableFolding(true, true);
      });
    </script>
  </head>
  <body>
    <div id="banner">
      <div id="header">
        <a id="logo" href="http://earthwormcentral.com/trac/ew"><img src="../chrome/site/images/ew.logo_tiny.png" alt="" /></a>
      </div>
      <form id="search" action="http://earthwormcentral.com/trac/ew/search" method="get">
        <div>
          <label for="proj-search">Search:</label>
          <input type="text" id="proj-search" name="q" size="18" value="" />
          <input type="submit" value="Search" />
        </div>
      </form>
      <div id="metanav" class="nav">
    <ul>
      <li class="first"><a href="http://earthwormcentral.com/trac/ew/login">Login</a></li><li><a href="TracGuide.html">Help/Guide</a></li><li><a href="http://earthwormcentral.com/trac/ew/about">About Trac</a></li><li class="last"><a href="http://earthwormcentral.com/trac/ew/prefs">Preferences</a></li>
    </ul>
  </div>
    </div>
    <div id="mainnav" class="nav">
    <ul>
      <li class="first active"><a href="http://earthwormcentral.com/trac/ew/wiki">Wiki</a></li><li><a href="http://earthwormcentral.com/trac/ew/timeline">Timeline</a></li><li><a href="http://earthwormcentral.com/trac/ew/roadmap">Roadmap</a></li><li><a href="http://earthwormcentral.com/trac/ew/browser">Browse Source</a></li><li><a href="http://earthwormcentral.com/trac/ew/query">View Tickets</a></li><li class="last"><a href="http://earthwormcentral.com/trac/ew/search">Search</a></li>
    </ul>
  </div>
    <div id="main">
      <div id="pagepath" class="noprint">
  <a class="pathentry first" title="View WikiStart" href="http://earthwormcentral.com/trac/ew/wiki">wiki:</a><a class="pathentry" href="menlo_report.html" title="View menlo_report">menlo_report</a>
</div>
      <div id="ctxtnav" class="nav">
        <h2>Context Navigation</h2>
          <ul>
              <li class="first"><a href="WikiStart.html">Start Page</a></li><li><a href="TitleIndex.html">Index</a></li><li class="last"><a href="http://earthwormcentral.com/trac/ew/wiki/menlo_report?action=history">History</a></li>
          </ul>
        <hr />
      </div>
    <div id="content" class="wiki">
      <div class="wikipage searchable">
        
          
          <div class="trac-modifiedby">
            <span><a href="http://earthwormcentral.com/trac/ew/wiki/menlo_report?action=diff&amp;version=2" title="Version 2 by branden">Last modified</a> <a class="timeline" href="http://earthwormcentral.com/trac/ew/timeline?from=2012-05-02T09%3A20%3A33-07%3A00&amp;precision=second" title="2012-05-02T09:20:33-07:00 in Timeline">17 months</a> ago</span>
            <span class="trac-print">Last modified on 05/02/12 09:20:33</span>
          </div>
          <div id="wikipage"><p>
</p><div class="wiki-toc">
<ol>
  <li>
    <a href="menlo_report.html#EarthwormModule:menlo_report">Earthworm Module: menlo_report</a>
    <ol>
      <li>
        <a href="menlo_report.html#Function">Function</a>
      </li>
      <li>
        <a href="menlo_report.html#Details">Details</a>
      </li>
      <li>
        <a href="menlo_report.html#ConfigurationFileCommands">Configuration File Commands</a>
        <ol>
          <li>
            <a href="menlo_report.html#EXAMPLECONFIGURATIONFILE">EXAMPLE CONFIGURATION FILE</a>
          </li>
          <li>
            <a href="menlo_report.html#FUNCTIONALCOMMANDLISTING">FUNCTIONAL COMMAND LISTING</a>
          </li>
          <li>
            <a href="menlo_report.html#ALPHABETICCOMMANDLISTINGDESCRIPTION">ALPHABETIC COMMAND LISTING &amp; DESCRIPTION</a>
          </li>
          <li>
            <a href="menlo_report.html#MENLO_REPORTSFILE-NAMINGCONVENTION">MENLO_REPORT'S FILE-NAMING CONVENTION</a>
          </li>
          <li>
            <a href="menlo_report.html#SETTINGUPPERMISSIONSONAREMOTESUNMACHINELOCALMACHINE">SETTING UP PERMISSIONS ON A REMOTE SUN MACHINE &amp; LOCAL MACHINE</a>
          </li>
        </ol>
      </li>
      <li>
        <a href="menlo_report.html#HelpfulHints">Helpful Hints</a>
      </li>
    </ol>
  </li>
</ol>
</div><p>
</p>
<h1 id="EarthwormModule:menlo_report"><a class="wiki" href="Earthworm.html">Earthworm</a> Module: menlo_report</h1>
<p>
<strong>Contributed by: </strong>
</p>
<h2 id="Function">Function</h2>
<p>
Transfers single-event HYPOINVERSE archive files to a remote machine.
</p>
<h2 id="Details">Details</h2>
<p>
Menlo_report is a module that writes earthquake information to disk and transfers it to a remote computer. Menlo_report watches the configured transport ring for hypoinverse archive messages (TYPE_HYP2000ARC) and summary messages (TYPE_H71SUM2K). When it finds a message of interest, menlo_report writes the message to a disk file, then copies it to the remote computer via "rcp". If the rcp succeeds, the local file is removed (unless menlo_report has been configured to "KeepLocalCopy"). If the rcp fails, the local file is NOT removed, and an error message is sent to the statmgr.
</p>
<h2 id="ConfigurationFileCommands">Configuration File Commands</h2>
<p>
On startup, menlo_report reads the configuration file named on the command line. Commands in this file set up all parameters used in transferring event files to a remote machine. In the control file, lines may begin with a valid menlo_report command (listed below) or with one of 2 special characters:
</p>
<pre class="wiki">#  marks the line as a comment (example: # This is a comment).

@  allows control files to be nested; one control file can be
   accessed from another with the command "@" followed by
   a string representing the path name of the next control file
   (example: @model.d).
</pre><p>
Command names must be typed in the control file exactly as shown in this document (upper/lower case matters!).
</p>
<h3 id="EXAMPLECONFIGURATIONFILE">EXAMPLE CONFIGURATION FILE</h3>
<pre class="wiki"> #
# This is menlo_report's parameter file

#  Basic Earthworm setup:
#
MyModuleId         MOD_REPORT     # module id for this instance of report
RingName           HYPO_RING      # ring to get input from
LogFile            1              # 0 to completely turn off disk log file
HeartBeatInterval  15             # seconds between heartbeats

# List the message logos to grab from transport ring
#              Installation       Module          Message Types
GetEventsFrom  INST_WILDCARD    MOD_EQPROC      # hyp2000arc &amp; h71sum2k

# Set suffixes for output filenames
# NOTE: If a suffix is "none", no file will
#       be reported for that type of message
ArcSuffix     ".arc"              # suffix for archive (hinvarc message) files
SumSuffix     ".sum"              # suffix for summary (h71sum message) files
TmpRemoteFile "temp.tmp"          # name for remote file while it's being copied

# Local directory to write temporary files in
LocalDir      /home/earthworm/run/log
KeepLocalCopy

# Create name for local file using the event origin time and
#   - last 2 digits of the event id and ArcSuffix/SumSuffix
#     this is the default
#     (i.e.  201011040930_57.arc)
#   - all digits of the event id, plus id-version,  and ArcSuffix/SumSuffix
#     (i.e.  201011040932_0000097658_2.arc)
#     to create long file names declare parameter EnableLongFileName
#     This parameter is useful only when KeepLocalCopy is also declared
# EnableLongFileName

# Info about remote machine to write files on
RemoteHost    squash                	# copy eq files to this machine
RemoteDir     /home/earthworm/quakes    # put them in this directory
RemoteUser    whoever            	# as this user
RemotePasswd  whatever                  # with this password;
                                        #  Required for NT version
                                        #  Not used by Solaris version
</pre><h3 id="FUNCTIONALCOMMANDLISTING">FUNCTIONAL COMMAND LISTING</h3>
<p>
Below are the commands recognized by menlo_report, grouped by the function they influence. Most of the commands are required; they must be specified in the control file in order for menlo_report to operate.
</p>
<pre class="wiki">	Earthworm system setup:
                GetEventsFrom         required
		HeartBeatInterval  			required
 		MyModuleId                	required
		RingName	                  required

	Local/Remote machine info:
		LocalDir	   	required
		RemoteDir	   	required
		RemoteHost	   	required
		RemoteUser	   	required
		RemotePasswd	   	required
                TmpRemoteFile           required

	Output Control:
		ArcSuffix		required
		SumSuffix		required
                KeepLocalCopy
                EnableLongFileName
		LogFile		   	required
</pre><h3 id="ALPHABETICCOMMANDLISTINGDESCRIPTION">ALPHABETIC COMMAND LISTING &amp; DESCRIPTION</h3>
<p>
In the following section, all configuration file commands are listed in alphabetical order. Listed along with the command (bold-type) are its arguments (in red), the name of the subroutine that processes the command, and the function within the module that the command influences. A detailed description of the command and is also given. Default values and the values used by Calnet are listed after each command description.
</p>
<p>
The following list is organized by:
</p>
<p>
command [argument here]
</p>
<p>
<strong>ArcSuffix [suffix]</strong><br />
Processed by: menlo_report_config<br />
Function: output
</p>
<p>
Sets a character string suffix that is used in naming the output files which contain hypoinverse archive messages. See section 3 below for a full description of menlo_report's file-naming convention. suffix can be enclosed in double-quotes, but is not required to be. suffix may be given with or without the period (for example, both ".arc" and "arc" are valid suffixes and will result in the same file name). If suffix is "none", menlo_report will not write or deliver files for hypoinverse archive messages.
</p>
<pre class="wiki">Default:  none				Calnet:  ArcSuffix ".arc"
</pre><p>
<strong>EnableLongFileName</strong><br />
Processed by: menlo_report_config<br />
Function: output
</p>
<p>
The parameter EnableLongFileName is useful only when KeepLocalCopy is also declared.
File name can be created in two different ways:
</p>
<ul><li>event origin time, <br />
</li></ul><p>
last 2 digits of the event id <br />
and ArcSuffix/SumSuffix<br />
(i.e. 201011040930_57.arc) THIS IS DEFAULT.
</p>
<ul><li>event origin time, <br />
</li></ul><p>
all digits of the event id, <br />
version of the event id, <br />
and ArcSuffix/SumSuffix <br />
(i.e. 201011040932_0000097658_2.arc) <br />
to create long file names declare parameter EnableLongFileName
</p>
<pre class="wiki">Default:                    # File name will be like 201011040930_57.arc
Example: EnableLongFileName # File name will be like 201011040932_0000097658_2.arc
</pre><p>
<strong>GetEventsFrom [inst mod_id]</strong><br />
Processed by: menlo_report_config<br />
Fucntion: Earthworm setup
</p>
<p>
Controls the earthquake messages input to menlo_report. menlo_report will only process hypoinvserse-archive and hypo71-summary messages that come from module mod_id at installation inst. inst and mod_id are character strings (valid strings are listed in earthworm.h/earthworm.d) which are related to single-byte numbers that uniquely identify each installation and module. Only 1 "GetEventsFrom" command may be issued; wildcards (INST_WILDCARD and MOD_WILDCARD) will force menlo_report to process all archive and summary messages, regardless of their place of origin.
</p>
<pre class="wiki">Default:  none
Calnet:   GetEventsFrom  INST_MENLO  MOD_EQPROC
</pre><p>
<strong>HeartBeatInterval [nsec]</strong><br />
Processed: menlo_report_config<br />
Function: Earthworm setup
</p>
<p>
Defines the number of seconds nsec between TYPE_HEARTBEAT messages issued by menlo_report.
</p>
<pre class="wiki">Default:  none				Calnet:  HeartBeatInterval 15
</pre><p>
<strong>KeepLocalCopy</strong><br />
Processed by: menlo_report_config<br />
Function: output
</p>
<p>
Sets a flag such that local copies of archive and summary files are NOT deleted after they are sent to the remote machine. This command is optional; if it is omitted, local files are deleted after they have been successfully copied to the remote machine (local files are always saved if there is an error in sending the file to the remote machine).
</p>
<pre class="wiki">Default:  delete local archive &amp; summary files
</pre><p>
<strong>LocalDir [path]</strong><br />
Processed by: menlo_report_config<br />
Function: machine info
</p>
<p>
Defines the local directory into which menlo_report should write its temporary event files. menlo_report changes its working directory to path. On OS/2, path must be on the same disk that menlo_report was started from. The local temporary files are removed after they have been successfully transferred to the remote machine. If an error occurs on transfer, menlo_report sends an error message and does not remove the local file.
</p>
<pre class="wiki">Default:  none
Calnet:   LocalDir /home/earthworm/run/log
</pre><p>
<strong>LogFile [switch]</strong><br />
Processed by: menlo_report_config<br />
Function: output
</p>
<p>
Sets the on-off switch for writing a log file to disk. If switch is 0, no log file will be written. If switch is 1, menlo_report will write a daily log file(s) called menlo_reportxx.log_yymmdd where xx is menlo_report's module id (set with "MyModuleId" command) and yymmdd is the current UTC date (ex: 960123) on the system clock. The file(s) will be written in the EW_LOG directory (environment variable).
</p>
<pre class="wiki">Default:  none
</pre><p>
<strong>MyModuleId [mod_id]</strong><br />
Processed by: menlo_report_config<br />
Function: Earthworm setup
</p>
<p>
Sets the module id for labeling all outgoing messages. mod_id is a character string (valid strings are listed in earthworm.d) that relates (in earthworm.d) to a unique single-byte number.
</p>
<pre class="wiki">Default:  none		Calnet:  MyModuleId MOD_REPORT
</pre><p>
<strong>RemoteDir [path]</strong><br />
Processed by: menlo_report_config<br />
Function: machine info
</p>
<p>
Defines the directory path on the remote machine in which to place the event files.
</p>
<pre class="wiki">Default:  none
</pre><p>
<strong>RemoteHost [host]</strong><br />
Processed by: menlo_report_config<br />
Function: machine info
</p>
<p>
Specifies the remote machine host to place the event files on. host is a character string; it can be either the remote host's name or its IP address. See section below on setting up permissions on remote machine.
</p>
<pre class="wiki">Default:  none
</pre><p>
<strong>RemoteUser [username]</strong><br />
Processed by: menlo_report_config<br />
Function: machine info
</p>
<p>
Copy the event files to the remote host as username. The files on the remote machine will be owned by username. username must have permission to write in the directory assigned by "RemoteDir" command.
</p>
<pre class="wiki">Default:  none
</pre><p>
<strong>RemotePasswd [passwd]</strong><br />
Processed by: menlo_report_config<br />
Function: machine info
</p>
<p>
Specifies the password passwd for the remote user on the remote machine. The OS/2 version requires that passwd be the actual password for the remote user. The Solaris version, on the other hand, does not need to use passwd; therefore, it should be set to a dummy character string for security reasons.
</p>
<pre class="wiki">Default:  none
</pre><p>
<strong>RingName [ring]</strong><br />
Processed by: menlo_report_config<br />
Function: Earthworm setup
</p>
<p>
Tells menlo_report which shared memory region to use for input/output. ring is a character string (valid strings are listed in earthworm.d) that relates (in earthworm.d) to a unique number for the key to the shared memory region.
</p>
<pre class="wiki">Default:  none				Calnet:  RingName HYPO_RING
</pre><p>
<strong>SumSuffix [suffix]</strong><br />
Processed by: menlo_report_config<br />
Function: output
</p>
<p>
Sets a character string suffix that is used in naming the output files which contain hypo71-format summary messages. See section 3 below for a full description of menlo_report's file-naming convention. suffix can be enclosed in double-quotes, but is not required to be. suffix may be given with or without the period (for example, both ".sum" and "sum" are valid suffixes and will result in the same file name). If suffix is "none", menlo_report will not write or deliver files for hypo71-format summary messages.
</p>
<pre class="wiki">Default:  none				Calnet:  SumSuffix ".sum"
</pre><p>
<strong>TmpRemoteFile [tmpname]</strong><br />
Processed by: menlo_report_config<br />
Function: machine info
</p>
<p>
Specifies a character string tmpname to use for the name of the remote file while it is being transferred to the remote machine. tmpname can be enclosed in double-quotes, but is not required to be. After the file transfer is complete, the remote file is renamed with the final file name (using the convention described in section 3.)
</p>
<p>
Warning: if more than one copy of menlo_report is transferring files to the same remote directory, be sure that they are using different tmpnames, otherwise they may over-write each other's files!
</p>
<pre class="wiki">Default:  none
Example:  TmpRemoteFile "report.tmp"
</pre><h3 id="MENLO_REPORTSFILE-NAMINGCONVENTION">MENLO_REPORT'S FILE-NAMING CONVENTION</h3>
<p>
Menlo_report writes one temporary file for each message        it processes. The prefix of each file name is unique for each event; it is derived from the event origin time and follows the convention "yyyymmddhhmm_xx" where:
</p>
<pre class="wiki">   yyyymmdd is the UTC date of the event origin time,
   hhmm   is the UTC hour-minute of the event origin time, and
   xx     is the last 2 digits of the event id assigned by binder.
</pre><p>
The suffix denotes the type of message the file contains. The suffix is set by the user in menlo_report's configuration file with these commands:
</p>
<pre class="wiki">   ArcSuffix   sets the suffix for files containing a
               hypoinverse archive message   (ex: ArcSuffix ".arc").
   SumSuffix   sets the suffix for	files contain a
               hypo71-format summary message (ex: SumSuffix ".sum").

Example file names:   199602131145_78.arc
		      199602131145_78.sum
</pre><p>
Menlo_report writes its local temporary files into the directory set by the "LocalDir" command. The local temporary files are removed after they have been successfully transferred to the remote machine. If an error occurs on transfer, menlo_report sends an error message and does not remove the local file.
</p>
<h3 id="SETTINGUPPERMISSIONSONAREMOTESUNMACHINELOCALMACHINE">SETTING UP PERMISSIONS ON A REMOTE SUN MACHINE &amp; LOCAL MACHINE</h3>
<ul><li>For menlo_report to work, make sure that the following files are set up properly on the Sun machine specified in the "RemoteHost" command:
<pre class="wiki">  /etc/hosts         must contain the local_hostname and its IP address

  /etc/hosts.equiv   must contain local_hostname

  .rhosts            in the home directory of the user specified by
		     the "RemoteUser" command must contain a line:
                     local_hostname local_username
                     describing who is running menlo_report (and thus
		     who is trying to write the files).
</pre></li></ul><ul><li>Additionally, the user identified by "RemoteUser" command must have write permission in the "RemoteDir" directory.
</li></ul><ul><li>On the local machine, make sure that entries for the remote host are included in these files:
<pre class="wiki">   c:\WINNT\system32\drivers\etc\hosts   for a local NT machine

   /etc/hosts	      for a local Solaris machine
   /etc/hosts.equiv
</pre></li></ul><h2 id="HelpfulHints">Helpful Hints</h2>
</div>
        
        
      </div>
      

    </div>
    <div id="altlinks">
      <h3>Download in other formats:</h3>
      <ul>
        <li class="last first">
          <a rel="nofollow" href="http://earthwormcentral.com/trac/ew/wiki/menlo_report?format=txt">Plain Text</a>
        </li>
      </ul>
    </div>
    </div>
    <div id="footer" lang="en" xml:lang="en"><hr />
      <a id="tracpowered" href="http://trac.edgewall.org/"><img src="../chrome/common/trac_logo_mini.png" height="30" width="107" alt="Trac Powered" /></a>
      <p class="left">Powered by <a href="http://earthwormcentral.com/trac/ew/about"><strong>Trac 0.12.4</strong></a><br />
        By <a href="http://www.edgewall.org/">Edgewall Software</a>.</p>
      <p class="right">Visit the Trac open source project at<br /><a href="http://trac.edgewall.org/">http://trac.edgewall.org/</a></p>
    </div>
  </body>
</html>