<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  
  

  


  <head>
    <title>
      vdl_ew â€“ Earthworm
    </title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <!--[if IE]><script type="text/javascript">
      if (/^#__msie303:/.test(window.location.hash))
        window.location.replace(window.location.hash.replace(/^#__msie303:/, '#'));
    </script><![endif]-->
        <link rel="search" href="http://earthwormcentral.com/trac/ew/search" />
        <link rel="help" href="TracGuide.html" />
        <link rel="alternate" href="http://earthwormcentral.com/trac/ew/wiki/vdl_ew?format=txt" type="text/x-trac-wiki" title="Plain Text" />
        <link rel="start" href="http://earthwormcentral.com/trac/ew/wiki" />
        <link rel="stylesheet" href="../chrome/common/css/trac.css" type="text/css" /><link rel="stylesheet" href="../chrome/common/css/wiki.css" type="text/css" /><link rel="stylesheet" href="../chrome/tracjsgantt/jsgantt.css" type="text/css" /><link rel="stylesheet" href="../chrome/tracjsgantt/tracjsgantt.css" type="text/css" />
        <link rel="shortcut icon" href="../chrome/common/trac.ico" type="image/x-icon" />
        <link rel="icon" href="../chrome/common/trac.ico" type="image/x-icon" />
      <link type="application/opensearchdescription+xml" rel="search" href="http://earthwormcentral.com/trac/ew/search/opensearch" title="Search Earthworm" />
    <script type="text/javascript" src="../chrome/common/js/jquery.js"></script><script type="text/javascript" src="../chrome/common/js/babel.js"></script><script type="text/javascript" src="../chrome/common/js/messages/en_US.js"></script><script type="text/javascript" src="../chrome/common/js/trac.js"></script><script type="text/javascript" src="../chrome/common/js/search.js"></script><script type="text/javascript" src="../chrome/common/js/folding.js"></script><script type="text/javascript" src="../chrome/tracjsgantt/jsgantt.js"></script>
    <!--[if lt IE 7]>
    <script type="text/javascript" src="/trac/ew/chrome/common/js/ie_pre7_hacks.js"></script>
    <![endif]-->
    <script type="text/javascript">
      jQuery(document).ready(function($) {
        $("#content").find("h1,h2,h3,h4,h5,h6").addAnchor(_("Link to this section"));
        $("#content").find(".wikianchor").each(function() {
          $(this).addAnchor(babel.format(_("Link to #%(id)s"), {id: $(this).attr('id')}));
        });
        $(".foldable").enableFolding(true, true);
      });
    </script>
  </head>
  <body>
    <div id="banner">
      <div id="header">
        <a id="logo" href="http://earthwormcentral.com/trac/ew"><img src="../chrome/site/images/ew.logo_tiny.png" alt="" /></a>
      </div>
      <form id="search" action="http://earthwormcentral.com/trac/ew/search" method="get">
        <div>
          <label for="proj-search">Search:</label>
          <input type="text" id="proj-search" name="q" size="18" value="" />
          <input type="submit" value="Search" />
        </div>
      </form>
      <div id="metanav" class="nav">
    <ul>
      <li class="first"><a href="http://earthwormcentral.com/trac/ew/login">Login</a></li><li><a href="TracGuide.html">Help/Guide</a></li><li><a href="http://earthwormcentral.com/trac/ew/about">About Trac</a></li><li class="last"><a href="http://earthwormcentral.com/trac/ew/prefs">Preferences</a></li>
    </ul>
  </div>
    </div>
    <div id="mainnav" class="nav">
    <ul>
      <li class="first active"><a href="http://earthwormcentral.com/trac/ew/wiki">Wiki</a></li><li><a href="http://earthwormcentral.com/trac/ew/timeline">Timeline</a></li><li><a href="http://earthwormcentral.com/trac/ew/roadmap">Roadmap</a></li><li><a href="http://earthwormcentral.com/trac/ew/browser">Browse Source</a></li><li><a href="http://earthwormcentral.com/trac/ew/query">View Tickets</a></li><li class="last"><a href="http://earthwormcentral.com/trac/ew/search">Search</a></li>
    </ul>
  </div>
    <div id="main">
      <div id="pagepath" class="noprint">
  <a class="pathentry first" title="View WikiStart" href="http://earthwormcentral.com/trac/ew/wiki">wiki:</a><a class="pathentry" href="vdl_ew.html" title="View vdl_ew">vdl_ew</a>
</div>
      <div id="ctxtnav" class="nav">
        <h2>Context Navigation</h2>
          <ul>
              <li class="first"><a href="WikiStart.html">Start Page</a></li><li><a href="TitleIndex.html">Index</a></li><li class="last"><a href="http://earthwormcentral.com/trac/ew/wiki/vdl_ew?action=history">History</a></li>
          </ul>
        <hr />
      </div>
    <div id="content" class="wiki">
      <div class="wikipage searchable">
        
          
          <div class="trac-modifiedby">
            <span><a href="http://earthwormcentral.com/trac/ew/wiki/vdl_ew?action=diff&amp;version=2" title="Version 2 by branden">Last modified</a> <a class="timeline" href="http://earthwormcentral.com/trac/ew/timeline?from=2012-03-02T10%3A43%3A08-08%3A00&amp;precision=second" title="2012-03-02T10:43:08-08:00 in Timeline">19 months</a> ago</span>
            <span class="trac-print">Last modified on 03/02/12 10:43:08</span>
          </div>
          <div id="wikipage"><p>
</p><div class="wiki-toc">
<ol>
  <li>
    <a href="vdl_ew.html#EarthwormModule:vdl_ew">Earthworm Module: vdl_ew</a>
    <ol>
      <li>
        <a href="vdl_ew.html#Function">Function</a>
      </li>
      <li>
        <a href="vdl_ew.html#Details">Details</a>
        <ol>
          <li>
            <a href="vdl_ew.html#EXAMPLECONFIGURATIONFILE">EXAMPLE CONFIGURATION FILE</a>
          </li>
        </ol>
      </li>
      <li>
        <a href="vdl_ew.html#HelpfulHints">Helpful Hints</a>
      </li>
    </ol>
  </li>
</ol>
</div><p>
</p>
<h1 id="EarthwormModule:vdl_ew"><a class="wiki" href="Earthworm.html">Earthworm</a> Module: vdl_ew</h1>
<p>
<strong>Contributed by: Dave Ketchum, USNSN</strong>
</p>
<h2 id="Function">Function</h2>
<p>
This is the Earthworm encapsulation of the USNSN code.
</p>
<h2 id="Details">Details</h2>
<p>
This is the Earthworm encapsulation of the USNSN code written by Dave Ketchum. It takes trace data messages from specified channels, buffers them in a circular FIFO, and feeds them to VDL. VLD executes a frequency-domain single-station event detector, and sends triggered, compressed event data to the USNSN. The encapsulating code shows its age by using numeric pin numbers rather than ASCII station-component-network names. Startup sequence: Earthworm is brought up by 'startstop'. Startstop reads its configuration file (startstop.d) containing command lines. The command line for vdl is found there. That command line contains the usual vdl command line, plus an Earthworm "-e" switch specifying the parameter file:
</p>
<blockquote>
<p>
vdl ... -e vdl_params.d ...
</p>
</blockquote>
<p>
where "vdl_params.d" will be read by feedme_init(), and contains all the Earthwormy things, like module id, ring to attach to, station to send, and what to call it. feedme_init() initiates logging, reads the parameter file, initializes the memory FIFO buffer of trace messages, and starts the MsgGet thread. This thread picks messages from the transport ring, sees if they're the pin numbers to be sent, and if so swaps as required, and pushes them into the memory FIFO.
</p>
<p>
Shutdown:
</p>
<p>
When the message getting thread gets a termination message from the transport ring, it'll set a status variable to -1, and exit. feedme() will see the negative status the next time it's called, and send the signal SIGQUIT to its own pid. VDL gets the hint, and performs a decent shutdown (we presume). This includes calling feedme_shutdown(), which shuts down the Earthwormy stuff.
</p>
<p>
Operating System:
</p>
<p>
This module is system dependent. At this time, VDL runs on Solaris only.
</p>
<h3 id="EXAMPLECONFIGURATIONFILE">EXAMPLE CONFIGURATION FILE</h3>
<pre class="wiki">#
# vdl_ew configuration file
#
# VDL under Earthworm is started by startstop, and given the commandline found in startstop.d
# That's where vdl get's its cusomary command line arguments. The file here is read
# by the "feedme" routines, which determine vdl's identity to earthworm, and what to feed to vdl.
# VDL has been modified (7/2/99) to use SCN names rather than pin numbers.
#
 MyModuleId     MOD_VDL_EW   # module id for this export,
 RingName       WAVE_RING      # transport ring to use for input/output,
 HeartBeatInt   10             # Heartbeat interval in seconds (Earthworm internal)
                # feedme() will consider beating the heart each time it's called, but will
                # not beat faster than the interval above
 LogFile        1              # If 0, don't write logfile at all,
 MaxMsgSize     500     # length of largest message we'll ever handle - in bytes
 MaxMessages    1000    # limit of number of message to buffer

# List the message logos to grab from transport ring for us to choose from
#  - as to which we will forward to VDL
#              Installation       Module       Message Type
 GetMsgLogo    INST_MENLO      MOD_WILDCARD     TYPE_TRACEBUF

# List of SCN names to send to VDL, and the corresponding VDL-USNSN designators
#               SCN name        USNSN designator
SendSCN         JSA VHZ NC              0
SendSCN         PTR VHZ NC              1
SendSCN         MTU VHZ NC              2
</pre><h2 id="HelpfulHints">Helpful Hints</h2>
</div>
        
        
      </div>
      

    </div>
    <div id="altlinks">
      <h3>Download in other formats:</h3>
      <ul>
        <li class="last first">
          <a rel="nofollow" href="http://earthwormcentral.com/trac/ew/wiki/vdl_ew?format=txt">Plain Text</a>
        </li>
      </ul>
    </div>
    </div>
    <div id="footer" lang="en" xml:lang="en"><hr />
      <a id="tracpowered" href="http://trac.edgewall.org/"><img src="../chrome/common/trac_logo_mini.png" height="30" width="107" alt="Trac Powered" /></a>
      <p class="left">Powered by <a href="http://earthwormcentral.com/trac/ew/about"><strong>Trac 0.12.4</strong></a><br />
        By <a href="http://www.edgewall.org/">Edgewall Software</a>.</p>
      <p class="right">Visit the Trac open source project at<br /><a href="http://trac.edgewall.org/">http://trac.edgewall.org/</a></p>
    </div>
  </body>
</html>