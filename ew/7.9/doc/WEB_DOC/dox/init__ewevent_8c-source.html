<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>init_ewevent.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3-rc3 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>init_ewevent.c</h1><a href="init__ewevent_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/*</span>
00002 <span class="comment"> *   THIS FILE IS UNDER RCS - DO NOT MODIFY UNLESS YOU HAVE</span>
00003 <span class="comment"> *   CHECKED IT OUT USING THE COMMAND CHECKOUT.</span>
00004 <span class="comment"> *</span>
00005 <span class="comment"> *    $Id: init__ewevent_8c-source.html 2161 2006-05-19 16:55:03Z paulf $</span>
00006 <span class="comment"> *</span>
00007 <span class="comment"> *    Revision history:</span>
00008 <span class="comment"> *     $Log$
00008 <span class="comment"> *     Revision 1.1  2006/05/19 16:55:02  paulf
00008 <span class="comment"> *     first inclusion
00008 <span class="comment"> *</span>
00009 <span class="comment"> *     Revision 1.3  2001/06/18 18:42:30  lucky</span>
00010 <span class="comment"> *     Changed Ml to ML</span>
00011 <span class="comment"> *</span>
00012 <span class="comment"> *     Revision 1.2  2001/06/06 20:54:46  lucky</span>
00013 <span class="comment"> *     Changes made to support multitude magnitudes, as well as amplitude picks. This is w</span>
00014 <span class="comment"> *     in progress - checkin in for the sake of safety.</span>
00015 <span class="comment"> *</span>
00016 <span class="comment"> *     Revision 1.1  2001/05/15 02:15:27  davidk</span>
00017 <span class="comment"> *     Initial revision</span>
00018 <span class="comment"> *</span>
00019 <span class="comment"> *     Revision 1.2  2001/04/17 17:49:28  lucky</span>
00020 <span class="comment"> *     *** empty log message ***</span>
00021 <span class="comment"> *</span>
00022 <span class="comment"> *     Revision 1.1  2000/12/18 18:55:12  lucky</span>
00023 <span class="comment"> *     Initial revision</span>
00024 <span class="comment"> *</span>
00025 <span class="comment"> *     Revision 1.6  2000/12/06 17:50:47  lucky</span>
00026 <span class="comment"> *     We now correctly keep track of the pick onset</span>
00027 <span class="comment"> *</span>
00028 <span class="comment"> *     Revision 1.5  2000/09/07 21:17:45  lucky</span>
00029 <span class="comment"> *     Final version after the Review pages have been demonstrated.</span>
00030 <span class="comment"> *</span>
00031 <span class="comment"> *     Revision 1.3  2000/08/30 17:41:57  lucky</span>
00032 <span class="comment"> *     InitEWEvent has been changed to include optional allocation of</span>
00033 <span class="comment"> *     pChanInfo space. This must be optional because GetEWEventInfo mallocs</span>
00034 <span class="comment"> *     space on the fly.</span>
00035 <span class="comment"> *</span>
00036 <span class="comment"> *     Revision 1.2  2000/08/30 14:56:28  lucky</span>
00037 <span class="comment"> *     pChanInfo will be allocated dynamically - no need to initialize</span>
00038 <span class="comment"> *     statically allocated pChanInfo structures any more.</span>
00039 <span class="comment"> *</span>
00040 <span class="comment"> *     Revision 1.1  2000/08/29 18:09:31  lucky</span>
00041 <span class="comment"> *     Initial revision</span>
00042 <span class="comment"> *</span>
00043 <span class="comment"> *</span>
00044 <span class="comment"> *</span>
00045 <span class="comment"> */</span>
00046 
00047 
00048 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
00049 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
00050 <span class="preprocessor">#include &lt;string.h&gt;</span>
00051 <span class="preprocessor">#include &lt;errno.h&gt;</span>
00052 <span class="preprocessor">#include &lt;sys/types.h&gt;</span>
00053 <span class="preprocessor">#include &lt;<a class="code" href="earthworm_8h.html">earthworm.h</a>&gt;</span>
00054 <span class="preprocessor">#include &lt;ew_event_info.h&gt;</span>
00055 
00056 <span class="comment">/******************************************************************</span>
00057 <span class="comment">*</span>
00058 <span class="comment">* Initialize the EventInfo struct -- set everything to NULL. </span>
00059 <span class="comment">*  Initialize the first chunk of pChan structs.</span>
00060 <span class="comment">*</span>
00061 <span class="comment">* WARNING!! This function uses the EW return codes not EWDB return codes!</span>
00062 <span class="comment">*</span>
00063 <span class="comment">******************************************************************/</span>
<a name="l00064"></a><a class="code" href="init__ewevent_8c.html#a0">00064</a> <span class="keywordtype">int</span>             <a class="code" href="init__ewevent_8c.html#a0">InitEWEvent</a> (EWEventInfoStruct *pEventInfo)
00065 {
00066 
00067         <span class="keywordtype">int</span>             i;
00068 
00069         <span class="keywordflow">if</span> (pEventInfo == NULL)
00070         {
00071                 <a class="code" href="logit_8c.html#a18">logit</a> (<span class="stringliteral">""</span>, <span class="stringliteral">"Invalid arguments passed in\n"</span>);
00072                 <span class="keywordflow">return</span> <a class="code" href="earthworm__defs_8h.html#a6">EW_FAILURE</a>;
00073         }
00074 
00075         pEventInfo-&gt;GotLocation = <a class="code" href="earthworm__defs_8h.html#a9">FALSE</a>;
00076         pEventInfo-&gt;GotTrigger = <a class="code" href="earthworm__defs_8h.html#a9">FALSE</a>;
00077 
00078         pEventInfo-&gt;iNumChans = 0;
00079         pEventInfo-&gt;iNumMags = 0;
00080         pEventInfo-&gt;iPrefMag = -10;
00081         pEventInfo-&gt;iMd = -1;
00082         pEventInfo-&gt;iML = -1;
00083         memset (&amp;pEventInfo-&gt;Event, 0, <span class="keyword">sizeof</span>(EWDB_EventStruct));
00084         memset (&amp;pEventInfo-&gt;Mags, 0, MAX_MAGS_PER_ORIGIN * <span class="keyword">sizeof</span>(EWDB_MagStruct));
00085         memset (&amp;pEventInfo-&gt;PrefOrigin, 0, <span class="keyword">sizeof</span>(EWDB_OriginStruct));
00086         memset (&amp;pEventInfo-&gt;CoincEvt, 0, <span class="keyword">sizeof</span>(EWDB_CoincEventStruct));
00087 
00088 
00089         <span class="keywordflow">if</span> ((pEventInfo-&gt;pChanInfo = (EWChannelDataStruct *) malloc
00090                                 (INIT_NUM_CHANS * <span class="keyword">sizeof</span> (EWChannelDataStruct))) == NULL)
00091         {
00092                 <a class="code" href="logit_8c.html#a18">logit</a> (<span class="stringliteral">""</span>,  <span class="stringliteral">"Could not malloc %d pChanInfo entries.\n"</span>, INIT_NUM_CHANS);
00093                 <span class="keywordflow">return</span>  (EW_FAILURE);
00094         }
00095 
00096         pEventInfo-&gt;iNumAllocChans = INIT_NUM_CHANS;
00097         <span class="keywordflow">for</span> (i = 0; i &lt; INIT_NUM_CHANS; i++)
00098         {
00099                 <a class="code" href="init__ewevent_8c.html#a1">InitEWChan</a>(&amp;pEventInfo-&gt;pChanInfo[i]);
00100         }
00101 
00102         <span class="keywordflow">return</span> <a class="code" href="earthworm__defs_8h.html#a5">EW_SUCCESS</a>;
00103 
00104 }  <span class="comment">/* end InitEWEvent() */</span>
00105 
00106 
00107 <span class="comment">/***********************************************************</span>
00108 <span class="comment">*</span>
00109 <span class="comment">* Initialize a single EWChannelDataStruct structure.</span>
00110 <span class="comment">*</span>
00111 <span class="comment">* WARNING!! This function uses the EW return codes not EWDB return codes!</span>
00112 <span class="comment">*</span>
00113 <span class="comment">***********************************************************/</span>
<a name="l00114"></a><a class="code" href="init__ewevent_8c.html#a1">00114</a> <span class="keywordtype">int</span>     <a class="code" href="init__ewevent_8c.html#a1">InitEWChan</a>(EWChannelDataStruct *pChan)
00115 {
00116         <span class="keywordtype">int</span>             i;
00117 
00118         <span class="keywordflow">if</span> (pChan == NULL)
00119         {
00120                 <a class="code" href="logit_8c.html#a18">logit</a> (<span class="stringliteral">""</span>, <span class="stringliteral">"Invalid argument passed in.\n"</span>);
00121                 <span class="keywordflow">return</span> <a class="code" href="earthworm__defs_8h.html#a6">EW_FAILURE</a>;
00122         }
00123 
00124         pChan-&gt;idChan = 0;
00125         pChan-&gt;iNumArrivals = 0;
00126         pChan-&gt;iNumStaMags = 0;
00127         pChan-&gt;iNumTriggers = 0;
00128         pChan-&gt;iNumWaveforms = 0;
00129         pChan-&gt;bResponseIsValid = 0;
00130 
00131         memset (&amp;pChan-&gt;Station, 0, <span class="keyword">sizeof</span>(EWDB_StationStruct));
00132         memset (&amp;pChan-&gt;ResponseInfo, 0, <span class="keyword">sizeof</span>(EWDB_ChanTCTFStruct));
00133 
00134         <span class="keywordflow">for</span> (i = 0; i &lt; MDPCPE; i++)
00135         {
00136                 memset (&amp;pChan-&gt;Waveforms[i], 0, <span class="keyword">sizeof</span>(EWDB_WaveformStruct));
00137                 memset (&amp;pChan-&gt;Arrivals[i], 0, <span class="keyword">sizeof</span>(EWDB_ArrivalStruct));
00138                 memset (&amp;pChan-&gt;Stamags[i], 0, <span class="keyword">sizeof</span>(EWDB_StationMagStruct));
00139                 memset (&amp;pChan-&gt;Triggers[i], 0, <span class="keyword">sizeof</span>(EWDB_TriggerStruct));
00140         }
00141 
00142         <span class="keywordflow">return</span> <a class="code" href="earthworm__defs_8h.html#a5">EW_SUCCESS</a>;
00143 }  <span class="comment">/* end InitEWChan() */</span>
</pre></div><hr><address style="align: right;"><small>Generated on Tue May 6 09:16:03 2003 for Earthworm Libs by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.3-rc3 </small></address>
</body>
</html>
