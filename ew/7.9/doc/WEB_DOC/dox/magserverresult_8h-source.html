<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>magserverresult.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3-rc3 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>magserverresult.h</h1><a href="magserverresult_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">// magserverresult.h: interface for the MagServerResult class.</span>
00002 <span class="comment">//</span>
00004 <span class="comment"></span>
00005 <span class="preprocessor">#if !defined(_MAGSERVERRESULT_H__INCLUDED_)</span>
<a name="l00006"></a><a class="code" href="magserverresult_8h.html#a0">00006</a> <span class="preprocessor"></span><span class="preprocessor">#define _MAGSERVERRESULT_H__INCLUDED_</span>
00007 <span class="preprocessor"></span>
00008 <span class="preprocessor">#if _MSC_VER &gt; 1000</span>
00009 <span class="preprocessor"></span><span class="preprocessor">#pragma once</span>
00010 <span class="preprocessor"></span><span class="preprocessor">#endif // _MSC_VER &gt; 1000</span>
00011 <span class="preprocessor"></span>
00012 <span class="preprocessor">#include "<a class="code" href="mutableserverresult_8h.html">mutableserverresult.h</a>"</span>
00013 <span class="preprocessor">#include &lt;<a class="code" href="earthworm__defs_8h.html">earthworm_defs.h</a>&gt;</span>  <span class="comment">// MAG_NULL</span>
00014 <span class="preprocessor">#include &lt;string&gt;</span>
00015 <span class="preprocessor">#include &lt;vector&gt;</span>
00016 
00017 
00018 <span class="comment">//-------------------------------------------------------------------</span>
00019 
00020 
<a name="l00021"></a><a class="code" href="struct__MAG__SRVR__CHANNEL.html">00021</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct__MAG__SRVR__CHANNEL.html">_MAG_SRVR_CHANNEL</a>
00022 {
<a name="l00023"></a><a class="code" href="struct__MAG__SRVR__CHANNEL.html#m0">00023</a>    <span class="keywordtype">long</span>   <a class="code" href="struct__MAG__SRVR__CHANNEL.html#m0">ampid</a>;  <span class="comment">// id if amp came from database</span>
<a name="l00024"></a><a class="code" href="struct__MAG__SRVR__CHANNEL.html#m1">00024</a>    <span class="keywordtype">long</span>   <a class="code" href="struct__MAG__SRVR__CHANNEL.html#m1">channelid</a>;
<a name="l00025"></a><a class="code" href="struct__MAG__SRVR__CHANNEL.html#m2">00025</a>    <span class="keywordtype">long</span>   <a class="code" href="struct__MAG__SRVR__CHANNEL.html#m2">componentid</a>;
<a name="l00026"></a><a class="code" href="struct__MAG__SRVR__CHANNEL.html#m3">00026</a>    <span class="keywordtype">char</span>   <a class="code" href="struct__MAG__SRVR__CHANNEL.html#m3">sta</a>[10];
<a name="l00027"></a><a class="code" href="struct__MAG__SRVR__CHANNEL.html#m4">00027</a>    <span class="keywordtype">char</span>   <a class="code" href="struct__MAG__SRVR__CHANNEL.html#m4">comp</a>[10];
<a name="l00028"></a><a class="code" href="struct__MAG__SRVR__CHANNEL.html#m5">00028</a>    <span class="keywordtype">char</span>   <a class="code" href="struct__MAG__SRVR__CHANNEL.html#m5">net</a>[10];
<a name="l00029"></a><a class="code" href="struct__MAG__SRVR__CHANNEL.html#m6">00029</a>    <span class="keywordtype">char</span>   <a class="code" href="struct__MAG__SRVR__CHANNEL.html#m6">loc</a>[10];
<a name="l00030"></a><a class="code" href="struct__MAG__SRVR__CHANNEL.html#m7">00030</a>    <span class="keywordtype">float</span>  <a class="code" href="struct__MAG__SRVR__CHANNEL.html#m7">lat</a>;
<a name="l00031"></a><a class="code" href="struct__MAG__SRVR__CHANNEL.html#m8">00031</a>    <span class="keywordtype">float</span>  <a class="code" href="struct__MAG__SRVR__CHANNEL.html#m8">lon</a>;
<a name="l00032"></a><a class="code" href="struct__MAG__SRVR__CHANNEL.html#m9">00032</a>    <span class="keywordtype">float</span>  <a class="code" href="struct__MAG__SRVR__CHANNEL.html#m9">elev</a>;
<a name="l00033"></a><a class="code" href="struct__MAG__SRVR__CHANNEL.html#m10">00033</a>    <span class="keywordtype">float</span>  <a class="code" href="struct__MAG__SRVR__CHANNEL.html#m10">azm</a>;
<a name="l00034"></a><a class="code" href="struct__MAG__SRVR__CHANNEL.html#m11">00034</a>    <span class="keywordtype">float</span>  <a class="code" href="struct__MAG__SRVR__CHANNEL.html#m11">dip</a>;
00035 
<a name="l00036"></a><a class="code" href="struct__MAG__SRVR__CHANNEL.html#m12">00036</a>    <span class="keywordtype">float</span>  <a class="code" href="struct__MAG__SRVR__CHANNEL.html#m12">magnitude</a>;
00037 
<a name="l00038"></a><a class="code" href="struct__MAG__SRVR__CHANNEL.html#m13">00038</a>    <span class="keywordtype">float</span>  <a class="code" href="struct__MAG__SRVR__CHANNEL.html#m13">amp1</a>;
<a name="l00039"></a><a class="code" href="struct__MAG__SRVR__CHANNEL.html#m14">00039</a>    <span class="keywordtype">double</span> <a class="code" href="struct__MAG__SRVR__CHANNEL.html#m14">amp1time</a>;
<a name="l00040"></a><a class="code" href="struct__MAG__SRVR__CHANNEL.html#m15">00040</a>    <span class="keywordtype">float</span>  <a class="code" href="struct__MAG__SRVR__CHANNEL.html#m15">amp1period</a>;
00041 
<a name="l00042"></a><a class="code" href="struct__MAG__SRVR__CHANNEL.html#m16">00042</a>    <span class="keywordtype">float</span>  <a class="code" href="struct__MAG__SRVR__CHANNEL.html#m16">amp2</a>;
<a name="l00043"></a><a class="code" href="struct__MAG__SRVR__CHANNEL.html#m17">00043</a>    <span class="keywordtype">double</span> <a class="code" href="struct__MAG__SRVR__CHANNEL.html#m17">amp2time</a>;
<a name="l00044"></a><a class="code" href="struct__MAG__SRVR__CHANNEL.html#m18">00044</a>    <span class="keywordtype">float</span>  <a class="code" href="struct__MAG__SRVR__CHANNEL.html#m18">amp2period</a>;
00045 
00046 } <a class="code" href="struct__MAG__SRVR__CHANNEL.html">MAG_SRVR_CHANNEL</a>;
00047 
<a name="l00048"></a><a class="code" href="magserverresult_8h.html#a2">00048</a> <span class="keyword">typedef</span> std::vector&lt;MAG_SRVR_CHANNEL&gt; <a class="code" href="magserverresult_8h.html#a2">MAG_SRVR_CHANNEL_VECTOR</a>;
00049 
00050 <span class="comment">//-------------------------------------------------------------------</span>
<a name="l00051"></a><a class="code" href="classMagServerResult.html">00051</a> <span class="keyword">class </span><a class="code" href="classMagServerResult.html">MagServerResult</a> : <span class="keyword">public</span> <a class="code" href="classMutableServerResult.html">MutableServerResult</a>  
00052 {
00053 <span class="keyword">protected</span>:
00054 
00055    <span class="comment">// ----------------------------------------------------------</span>
00056    <span class="comment">//     virtual methods from MutableServerMessage</span>
00057    <span class="comment">//     to be implemented for a complete derivative classes</span>
00058    <span class="comment">// ----------------------------------------------------------</span>
00059 
00060    <span class="comment">// BufferInitAlloc -- when preparing to format a message</span>
00061    <span class="comment">//                    using FormatBuffer()], this is</span>
00062    <span class="comment">//                    first called.  The result is,</span>
00063    <span class="comment">//                    for the first call, MessageBuffer</span>
00064    <span class="comment">//                    will be assured to be at least this</span>
00065    <span class="comment">//                    long.</span>
00066    <span class="comment">//                    Overriding this method allows</span>
00067    <span class="comment">//                    derivative classes to minimize</span>
00068    <span class="comment">//                    reallocations as bits are appended</span>
00069    <span class="comment">//                    to the message buffer;</span>
00070    <span class="comment">//</span>
00071    <span class="comment">// NOTE: In each derivative implementation,</span>
00072    <span class="comment">//       call &lt;super_class&gt;::BufferInitAlloc() to get the</span>
00073    <span class="comment">//       space needed by that super class (and all baser</span>
00074    <span class="comment">//       classes), then add the size needed by the</span>
00075    <span class="comment">//       derivative to arrive at the total size needed.</span>
00076    <span class="comment">//</span>
00077    <span class="keywordtype">long</span> <a class="code" href="classMagServerResult.html#b0">BufferInitAlloc</a>();
00078 
00079 
00080    <span class="comment">// FormatDerivativeData</span>
00081    <span class="comment">//</span>
00082    <span class="comment">//     Method by which derivative classes append</span>
00083    <span class="comment">//     their content to MessageBuffer.</span>
00084    <span class="comment">//</span>
00085    <span class="comment">//</span>
00086    <span class="comment">//  NOTE: ALWAYS CALL &lt;super_class&gt;::FormatDerivativeData()</span>
00087    <span class="comment">//        at the start of each implementation to allow</span>
00088    <span class="comment">//        base classes to append their stuff (if any)</span>
00089    <span class="comment">//        to the buffer.</span>
00090    <span class="comment">//        Thus the buffer is built up from the base-most class.</span>
00091    <span class="comment">//</span>
00092    <span class="comment">// THROW worm_exception for errors</span>
00093    <span class="comment">//</span>
00094    <span class="keywordtype">void</span> <a class="code" href="classMagServerResult.html#b1">FormatDerivativeData</a>();
00095 
00096 
00097    <span class="comment">// ParseDerivativeData</span>
00098    <span class="comment">//</span>
00099    <span class="comment">//     Method by which derivative classes extract</span>
00100    <span class="comment">//     their content from MessageBuffer.</span>
00101    <span class="comment">//</span>
00102    <span class="comment">//  NOTE: Always call &lt;super_class&gt;::ParseDerivativeData()</span>
00103    <span class="comment">//        at the top of each implementation to allow</span>
00104    <span class="comment">//        base classes to get their data out of the</span>
00105    <span class="comment">//        buffer first.</span>
00106    <span class="comment">//</span>
00107    <span class="comment">//  USAGE:</span>
00108    <span class="comment">//</span>
00109    <span class="comment">//     If parsing a multi-line message ('\n'-terminated lines),</span>
00110    <span class="comment">//     use a loop consisting of:</span>
00111    <span class="comment">//</span>
00112    <span class="comment">//       i = MessageBuffer.find("\n")  to find the first line end,</span>
00113    <span class="comment">//       MessageBuffer.substr(0, i)    to extract the string</span>
00114    <span class="comment">//                                        (excluding the '\n')</span>
00115    <span class="comment">//       MessageBuffer.erase(0, i+1)     to remove that portion</span>
00116    <span class="comment">//</span>
00117    <span class="comment">//     Since the message should be terminated by an additional</span>
00118    <span class="comment">//     '\n', when the string returned in the second step</span>
00119    <span class="comment">//     is of zero length, that is the end of the message.</span>
00120    <span class="comment">//</span>
00121    <span class="comment">//     (If find() does not, it returns MessageBuffer.npos)</span>
00122    <span class="comment">//</span>
00123    <span class="comment">// THROW worm_exception for errors</span>
00124    <span class="comment">//</span>
00125    <span class="keywordtype">void</span> <a class="code" href="classMagServerResult.html#b2">ParseDerivativeData</a>();
00126 
00127 
00128    <span class="comment">// ----------------------------------------------------------</span>
00129    <span class="comment">//                   for MagServerResult</span>
00130    <span class="comment">// ----------------------------------------------------------</span>
00131 
00132    <span class="keywordtype">long</span>  <a class="code" href="classMagServerResult.html#n0">EventId</a>
<a name="l00133"></a><a class="code" href="classMagServerResult.html#n1">00133</a>       ,  <a class="code" href="classMagServerResult.html#n1">OriginId</a>
00134       ;
<a name="l00135"></a><a class="code" href="classMagServerResult.html#n2">00135</a>    <span class="keywordtype">int</span>   <a class="code" href="classMagServerResult.html#n2">MagType</a>;
<a name="l00136"></a><a class="code" href="classMagServerResult.html#n3">00136</a>    <span class="keywordtype">float</span> <a class="code" href="classMagServerResult.html#n3">MagAverage</a>;
<a name="l00137"></a><a class="code" href="classMagServerResult.html#n4">00137</a>    <span class="keywordtype">float</span> <a class="code" href="classMagServerResult.html#n4">MagError</a>;
00138 
<a name="l00139"></a><a class="code" href="classMagServerResult.html#n5">00139</a>    std::string <a class="code" href="classMagServerResult.html#n5">Author</a>;
00140    
<a name="l00141"></a><a class="code" href="classMagServerResult.html#n6">00141</a>    <a class="code" href="magserverresult_8h.html#a2">MAG_SRVR_CHANNEL_VECTOR</a> <a class="code" href="classMagServerResult.html#n6">Channels</a>;
00142    
00143 <span class="keyword">public</span>:
00144 
00145         <a class="code" href="classMagServerResult.html#a0">MagServerResult</a>();
00146 
00147    <span class="keywordtype">void</span> <a class="code" href="classMagServerResult.html#a1">SetMagnitudeInfo</a>(       <span class="keywordtype">long</span>    p_eventid
00148                         ,       <span class="keywordtype">long</span>    p_originid
00149                         ,       <span class="keywordtype">int</span>     p_magtype
00150                         ,       <span class="keywordtype">float</span>   p_average
00151                         ,       <span class="keywordtype">float</span>   p_error
00152                         , <span class="keyword">const</span> <span class="keywordtype">char</span>  * p_author
00153                         );
00154 
00155    <span class="keywordtype">void</span> <a class="code" href="classMagServerResult.html#a2">ClearChannels</a>();
00156 
00157    <span class="comment">// This will not overwrite/update existing</span>
00158    <span class="comment">// information for a channel, calling it again</span>
00159    <span class="comment">// for the same channel will duplicate the channel</span>
00160    <span class="keywordtype">void</span> <a class="code" href="classMagServerResult.html#a3">AddChannel</a>( <a class="code" href="struct__MAG__SRVR__CHANNEL.html">MAG_SRVR_CHANNEL</a> p_channelinfo );
00161 
00162 
00163    <span class="keyword">const</span> <span class="keywordtype">long</span> <a class="code" href="classMagServerResult.html#a4">GetEventId</a>() <span class="keyword">const</span>;
00164    
00165    <span class="keyword">const</span> <span class="keywordtype">long</span> <a class="code" href="classMagServerResult.html#a5">GetOriginId</a>() <span class="keyword">const</span>;
00166 
00167    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classMagServerResult.html#a6">GetMagType</a>() <span class="keyword">const</span>;
00168 
00169    <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="classMagServerResult.html#a7">GetAverage</a>() <span class="keyword">const</span>;
00170 
00171    <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="classMagServerResult.html#a8">GetError</a>() <span class="keyword">const</span>;
00172 
00173    <span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code" href="classMagServerResult.html#a9">GetAuthor</a>() <span class="keyword">const</span>;
00174 
00175    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classMagServerResult.html#a10">GetChannelCount</a>();
00176 
00177    <span class="keywordtype">bool</span> <a class="code" href="classMagServerResult.html#a11">GetChannel</a>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> p_index
00178                   , <a class="code" href="struct__MAG__SRVR__CHANNEL.html">MAG_SRVR_CHANNEL</a> * r_channel
00179                   ) <span class="keyword">const</span>;
00180 
00181 };
00182 
00183 <span class="preprocessor">#endif // !defined(_MAGSERVERRESULT_H__INCLUDED_)</span>
</pre></div><hr><address style="align: right;"><small>Generated on Tue May 6 09:16:04 2003 for Earthworm Libs by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.3-rc3 </small></address>
</body>
</html>
