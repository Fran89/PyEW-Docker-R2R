<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>global_loc_rw.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3-rc3 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>global_loc_rw.c</h1><a href="global__loc__rw_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="preprocessor">#include &lt;<a class="code" href="global__loc__rw_8h.html">global_loc_rw.h</a>&gt;</span>
00002 
00003 <span class="preprocessor">#include &lt;string.h&gt;</span>
00004 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
00005 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
00006 
00007 <span class="preprocessor">#include &lt;<a class="code" href="kom_8h.html">kom.h</a>&gt;</span>  <span class="comment">/* string parsing */</span>
00008 
00009 
00010 <span class="comment">/*</span>
00011 <span class="comment">** Versions currently handled by this code</span>
00012 <span class="comment">*/</span>
<a name="l00013"></a><a class="code" href="global__loc__rw_8c.html#a0">00013</a> <span class="preprocessor">#define GLOBAL_AMPLINE_VERSION (short)4</span>
00014 <span class="preprocessor"></span>
<a name="l00015"></a><a class="code" href="global__loc__rw_8c.html#a1">00015</a> <span class="preprocessor">#define GLOBAL_PHSLINE_VERSION (short)2</span>
00016 <span class="preprocessor"></span>
<a name="l00017"></a><a class="code" href="global__loc__rw_8c.html#a2">00017</a> <span class="preprocessor">#define GLOBAL_LOC_VERSION (short)3</span>
00018 <span class="preprocessor"></span>
00019 <span class="preprocessor">#include &lt;<a class="code" href="earthworm_8h.html">earthworm.h</a>&gt;</span>
00020 
00021 
00022 <span class="comment">/* ==========================================================================</span>
00023 <span class="comment">**                     FUNCTION DEFINITIONS</span>
00024 <span class="comment">** ========================================================================= */</span>
00025 
00026 <span class="comment">/* ------------------------------------------------------------------------- */</span>
00027 <span class="comment">/*</span>
00028 <span class="comment">** ===============================================================================</span>
00029 <span class="comment">*/</span>
00030 
<a name="l00031"></a><a class="code" href="global__loc__rw_8c.html#a3">00031</a> <a class="code" href="global__msg_8h.html#a1">GLOBAL_MSG_STATUS</a> <a class="code" href="global__loc__rw_8c.html#a3">InitGlobalAmpLine</a>( <a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html">GLOBAL_AMPLINE_STRUCT</a> * p_struct )
00032 {
00033         <span class="keywordflow">if</span> ( p_struct == NULL )
00034    {
00035      <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a4">GLOBAL_MSG_NULL</a>;
00036    }
00037 
00038         p_struct-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m0">version</a>     = <a class="code" href="global__loc__rw_8c.html#a0">GLOBAL_AMPLINE_VERSION</a>;
00039            p_struct-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m1">logo</a>.<a class="code" href="structMSG__LOGO.html#m2">instid</a>   = 0;
00040            p_struct-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m1">logo</a>.<a class="code" href="structMSG__LOGO.html#m1">mod</a>      = 0;
00041            p_struct-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m1">logo</a>.<a class="code" href="structMSG__LOGO.html#m0">type</a>     = 0;
00042            p_struct-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m2">pick_sequence</a> = 0;
00043    strcpy( p_struct-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m3">station</a>      , <span class="stringliteral">"?"</span> );
00044    strcpy( p_struct-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m4">channel</a>      , <span class="stringliteral">"?"</span> );
00045    strcpy( p_struct-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m5">network</a>      , <span class="stringliteral">"?"</span> );
00046    strcpy( p_struct-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m6">location</a>     , <span class="stringliteral">"?"</span> );
00047    strcpy( p_struct-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m7">amp_time</a>     , <span class="stringliteral">"?"</span> );
00048            p_struct-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m8">amptype</a>      = <a class="code" href="earthworm__defs_8h.html#a39">AMPTYPE_NONE</a>;
00049            p_struct-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m9">adcounts</a>     = 0.0;
00050            p_struct-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m10">period</a>       = 0.0;
00051 
00052    <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a3">GLOBAL_MSG_SUCCESS</a>;
00053 }
00054 
00055 <span class="comment">/* ------------------------------------------------------------------------- */</span>
00056 
<a name="l00057"></a><a class="code" href="global__loc__rw_8c.html#a4">00057</a> <a class="code" href="global__msg_8h.html#a1">GLOBAL_MSG_STATUS</a> <a class="code" href="global__loc__rw_8c.html#a4">InitGlobalPhaseLine</a>( <a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html">GLOBAL_PHSLINE_STRUCT</a> * p_struct )
00058 {
00059    <span class="keywordtype">short</span> _a;
00060 
00061    <span class="keywordflow">if</span> ( p_struct == NULL )
00062    {
00063      <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a4">GLOBAL_MSG_NULL</a>;
00064    }
00065            p_struct-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m0">version</a>     = <a class="code" href="global__loc__rw_8c.html#a1">GLOBAL_PHSLINE_VERSION</a>;
00066            p_struct-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m1">logo</a>.<a class="code" href="structMSG__LOGO.html#m2">instid</a> = 0;
00067            p_struct-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m1">logo</a>.<a class="code" href="structMSG__LOGO.html#m1">mod</a>    = 0;
00068            p_struct-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m1">logo</a>.<a class="code" href="structMSG__LOGO.html#m0">type</a>   = 0;
00069            p_struct-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m2">sequence</a>    = 0;
00070    strcpy( p_struct-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m3">station</a>     , <span class="stringliteral">"?"</span> );
00071    strcpy( p_struct-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m4">channel</a>     , <span class="stringliteral">"?"</span> );
00072    strcpy( p_struct-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m5">network</a>     , <span class="stringliteral">"?"</span> );
00073    strcpy( p_struct-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m6">location</a>    , <span class="stringliteral">"?"</span> );
00074    strcpy( p_struct-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m7">pick_time</a>   , <span class="stringliteral">"?"</span> );
00075    strcpy( p_struct-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m8">phase_name</a>  , <span class="stringliteral">"?"</span> );
00076            p_struct-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m9">quality</a>     = 0.0;
00077            p_struct-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m10">polarity</a>    = <span class="charliteral">'?'</span>;
00078 
00079    <span class="keywordflow">for</span> ( _a = 0 ; _a &lt; <a class="code" href="global__loc__rw_8h.html#a1">MAX_AMPS_PER_GLOBALPHASE</a> ; _a++ )
00080    {
00081       <a class="code" href="global__loc__rw_8c.html#a3">InitGlobalAmpLine</a>( &amp;p_struct-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m11">amps</a>[_a] );
00082    }
00083 
00084    <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a3">GLOBAL_MSG_SUCCESS</a>;
00085 }
00086 
00087 <span class="comment">/* ------------------------------------------------------------------------- */</span>
00088 
<a name="l00089"></a><a class="code" href="global__loc__rw_8c.html#a5">00089</a> <a class="code" href="global__msg_8h.html#a1">GLOBAL_MSG_STATUS</a> <a class="code" href="global__loc__rw_8c.html#a5">InitGlobalLoc</a>( <a class="code" href="structGLOBAL__LOC__DATA.html">GLOBAL_LOC_STRUCT</a> * p_struct )
00090 {
00091    <span class="keywordtype">int</span> _i;
00092 
00093 
00094    <span class="keywordflow">if</span> ( p_struct == NULL )
00095    {
00096      <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a4">GLOBAL_MSG_NULL</a>;
00097    }
00098 
00099            p_struct-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m0">version</a>     = <a class="code" href="global__loc__rw_8c.html#a2">GLOBAL_LOC_VERSION</a>;
00100            p_struct-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m1">logo</a>.<a class="code" href="structMSG__LOGO.html#m2">instid</a> = 0;
00101            p_struct-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m1">logo</a>.<a class="code" href="structMSG__LOGO.html#m1">mod</a>    = 0;
00102            p_struct-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m1">logo</a>.<a class="code" href="structMSG__LOGO.html#m0">type</a>   = 0;
00103            p_struct-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m2">event_id</a>    = 0;
00104            p_struct-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m3">origin_id</a>   = 0;
00105    strcpy( p_struct-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m4">origin_time</a> , <span class="stringliteral">"?"</span> );
00106            p_struct-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m5">lat</a>         = 0.0;
00107            p_struct-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m6">lon</a>         = 0.0;
00108            p_struct-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m7">depth</a>       = 0.0;
00109            p_struct-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m8">gap</a>         = 0.0;
00110            p_struct-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m9">dmin</a>        = 0.0;
00111            p_struct-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m10">rms</a>         = 0.0;
00112            p_struct-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m11">pick_count</a>  = 0;
00113            p_struct-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m12">nphs</a>        = 0;
00114 
00115 
00116    <span class="keywordflow">for</span> ( _i = 0 ; _i &lt; <a class="code" href="global__loc__rw_8h.html#a5">GLOBAL_LOC_MAXPHS</a> ; _i++ )
00117    {
00118       <a class="code" href="global__loc__rw_8c.html#a4">InitGlobalPhaseLine</a>( &amp;p_struct-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m13">phases</a>[_i] );
00119    }
00120 
00121    <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a3">GLOBAL_MSG_SUCCESS</a>;
00122 }
00123 
00124 <span class="comment">/*</span>
00125 <span class="comment">** ===============================================================================</span>
00126 <span class="comment">*/</span>
00127 
<a name="l00128"></a><a class="code" href="global__loc__rw_8c.html#a6">00128</a> <a class="code" href="global__msg_8h.html#a1">GLOBAL_MSG_STATUS</a> <a class="code" href="global__loc__rw_8c.html#a6">WriteAmpLineToBuffer</a>( <a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html">GLOBAL_AMPLINE_STRUCT</a> * p_struct
00129                                       , <span class="keywordtype">char</span>                  * p_buffer
00130                                       , <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>            p_length
00131                                       )
00132 {
00133    <span class="keywordtype">char</span> _author[10];
00134 
00135    <span class="keywordflow">if</span> ( p_struct == NULL )
00136    {
00137       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a4">GLOBAL_MSG_NULL</a>;
00138    }
00139 
00140    <span class="keywordflow">if</span> ( p_buffer == NULL )
00141    {
00142       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a8">GLOBAL_MSG_BADPARAM</a>;
00143    }
00144 
00145    <span class="keywordflow">if</span> ( p_length &lt; <a class="code" href="global__loc__rw_8h.html#a0">GLOBAL_AMPLINE_MAXBUFSIZE</a> )
00146    {
00147       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a9">GLOBAL_MSG_TOOSMALL</a>;
00148    }
00149 
00150    <span class="keywordflow">if</span> ( p_struct-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m0">version</a> != <a class="code" href="global__loc__rw_8c.html#a0">GLOBAL_AMPLINE_VERSION</a> )
00151    {
00152       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a5">GLOBAL_MSG_VERSINVALID</a>;
00153    }
00154 
00155    <a class="code" href="global__msg_8c.html#a2">EncodeAuthor</a>( p_struct-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m1">logo</a>, _author );
00156 
00157    sprintf( p_buffer
00158           , <span class="stringliteral">"%s %d %d %s %s %s %s %s %d %1.4f %1.4f\n"</span>
00159           , _author
00160           , p_struct-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m2">pick_sequence</a>
00161           , p_struct-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m0">version</a>
00162           , p_struct-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m3">station</a>
00163           , p_struct-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m4">channel</a>
00164           , p_struct-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m5">network</a>
00165           , p_struct-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m6">location</a>
00166           , p_struct-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m7">amp_time</a>
00167           , p_struct-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m8">amptype</a>
00168           , p_struct-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m9">adcounts</a>
00169           , p_struct-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m10">period</a>
00170           );
00171 
00172    <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a3">GLOBAL_MSG_SUCCESS</a>;
00173 }
00174 
00175 <span class="comment">/* ------------------------------------------------------------------------- */</span>
00176  
<a name="l00177"></a><a class="code" href="global__loc__rw_8c.html#a7">00177</a> <a class="code" href="global__msg_8h.html#a1">GLOBAL_MSG_STATUS</a> <a class="code" href="global__loc__rw_8c.html#a7">WritePhaseLineToBuffer</a>( <a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html">GLOBAL_PHSLINE_STRUCT</a> * p_struct
00178                                         , <span class="keywordtype">char</span>                  * p_buffer
00179                                         , <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>            p_length
00180                                         )
00181 {
00182    <span class="keywordtype">char</span> _author[10];
00183 
00184    <span class="keywordflow">if</span> ( p_struct == NULL )
00185    {
00186       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a4">GLOBAL_MSG_NULL</a>;
00187    }
00188 
00189    <span class="keywordflow">if</span> ( p_buffer == NULL )
00190    {
00191       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a8">GLOBAL_MSG_BADPARAM</a>;
00192    }
00193 
00194    <span class="keywordflow">if</span> ( p_length &lt; <a class="code" href="global__loc__rw_8h.html#a3">GLOBAL_PHSLINE_MAXBUFSIZE</a> )
00195    {
00196       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a9">GLOBAL_MSG_TOOSMALL</a>;
00197    }
00198 
00199    <span class="keywordflow">if</span> ( p_struct-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m0">version</a> != <a class="code" href="global__loc__rw_8c.html#a1">GLOBAL_PHSLINE_VERSION</a> )
00200    {
00201       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a5">GLOBAL_MSG_VERSINVALID</a>;
00202    }
00203 
00204    <a class="code" href="global__msg_8c.html#a2">EncodeAuthor</a>( p_struct-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m1">logo</a>, _author );
00205 
00206    sprintf( p_buffer
00207           , <span class="stringliteral">"%s %d %d %s %s %s %s %s %s %1.4f %c %d\n"</span>
00208           ,  _author
00209           , p_struct-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m2">sequence</a>
00210           , p_struct-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m0">version</a>
00211           , p_struct-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m3">station</a>
00212           , p_struct-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m4">channel</a>
00213           , p_struct-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m5">network</a>
00214           , p_struct-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m6">location</a>
00215           , p_struct-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m7">pick_time</a>
00216           , p_struct-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m8">phase_name</a>
00217                      , p_struct-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m9">quality</a>
00218                      , p_struct-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m10">polarity</a>
00219           );
00220 
00221    <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a3">GLOBAL_MSG_SUCCESS</a>;
00222 }
00223 
00224 <span class="comment">/* ------------------------------------------------------------------------- */</span>
00225 
<a name="l00226"></a><a class="code" href="global__loc__rw_8c.html#a8">00226</a> <a class="code" href="global__msg_8h.html#a1">GLOBAL_MSG_STATUS</a> <a class="code" href="global__loc__rw_8c.html#a8">WriteLocToBuffer</a>( <a class="code" href="structGLOBAL__LOC__DATA.html">GLOBAL_LOC_STRUCT</a> * p_loc
00227                                   , <span class="keywordtype">char</span>              * p_buffer
00228                                   , <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>        p_length
00229                                   )
00230 {
00231    <a class="code" href="global__msg_8h.html#a1">GLOBAL_MSG_STATUS</a> r_code = <a class="code" href="global__msg_8h.html#a18a3">GLOBAL_MSG_SUCCESS</a>;
00232 
00233    <span class="keywordtype">char</span> * _writelocation = p_buffer;
00234 
00235    <span class="keywordtype">char</span> _author[10];
00236 
00237    <span class="keywordtype">int</span> _phaseindex
00238      , _ampindex
00239      ;
00240 
00241    <a class="code" href="global__loc__rw_8h.html#a10">GLOBAL_PHSLINE_BUFFER</a> _phs_buffer;
00242 
00243    <a class="code" href="global__loc__rw_8h.html#a7">GLOBAL_AMPLINE_BUFFER</a> _amp_buffer;
00244 
00245 
00246    <span class="keywordflow">if</span> ( p_loc == NULL )
00247    {
00248       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a4">GLOBAL_MSG_NULL</a>;
00249    }
00250 
00251    <span class="keywordflow">if</span> ( p_buffer == NULL )
00252    {
00253       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a8">GLOBAL_MSG_BADPARAM</a>;
00254    }
00255 
00256    <span class="keywordflow">if</span> ( p_length &lt; (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)(  <a class="code" href="global__loc__rw_8h.html#a4">GLOBAL_LOC_SUM_MAXSIZE</a>
00257                                   + p_loc-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m12">nphs</a> * <a class="code" href="global__loc__rw_8h.html#a3">GLOBAL_PHSLINE_MAXBUFSIZE</a>
00258                                  )
00259       )
00260    {
00261       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a9">GLOBAL_MSG_TOOSMALL</a>;
00262    }
00263 
00264    <span class="keywordflow">if</span> ( p_loc-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m0">version</a> != <a class="code" href="global__loc__rw_8c.html#a2">GLOBAL_LOC_VERSION</a> )
00265    {
00266       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a5">GLOBAL_MSG_VERSINVALID</a>;
00267    }
00268 
00269    <a class="code" href="global__msg_8c.html#a2">EncodeAuthor</a>( p_loc-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m1">logo</a>, _author );
00270 
00271    sprintf( _writelocation
00272           , <span class="stringliteral">"SUM %s %d %d %d %s %.4f %.4f %.3f %.3f %.3f %.3f %d %d\n"</span>
00273           , _author
00274           , p_loc-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m0">version</a>
00275           , p_loc-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m2">event_id</a>
00276           , p_loc-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m3">origin_id</a>
00277           , p_loc-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m4">origin_time</a>
00278           , p_loc-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m5">lat</a>
00279           , p_loc-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m6">lon</a>
00280           , p_loc-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m7">depth</a>
00281           , p_loc-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m8">gap</a>
00282           , p_loc-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m9">dmin</a>
00283           , p_loc-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m10">rms</a>
00284           , p_loc-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m11">pick_count</a>
00285           , p_loc-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m12">nphs</a>
00286           );
00287 
00288    _writelocation = p_buffer + strlen(p_buffer);
00289 
00290    <span class="keywordflow">for</span> ( _phaseindex = 0 ; _phaseindex &lt; p_loc-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m12">nphs</a> ; _phaseindex++ )
00291    {
00292       <span class="keywordflow">if</span> ( (r_code = <a class="code" href="global__loc__rw_8c.html#a7">WritePhaseLineToBuffer</a>( &amp;p_loc-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m13">phases</a>[_phaseindex]
00293                                            , _phs_buffer
00294                                            , GLOBAL_PHSLINE_MAXBUFSIZE
00295                                            ) ) == <a class="code" href="global__msg_8h.html#a18a3">GLOBAL_MSG_SUCCESS</a> )
00296       {
00297          <span class="keywordflow">if</span> ( <a class="code" href="global__loc__rw_8h.html#a6">GLOBAL_LOC_MAXBUFSIZE</a> &lt;= (strlen(p_buffer) + strlen(<span class="stringliteral">"PHS "</span>) + strlen(_phs_buffer) + 1) )
00298          {
00299             <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a11">GLOBAL_MSG_DEFINESMALL</a>;
00300          }
00301          strcat( _writelocation, <span class="stringliteral">"PHS "</span> );
00302          strcat( _writelocation, _phs_buffer );
00303 
00304          <span class="keywordflow">for</span> ( _ampindex = 0 ; _ampindex &lt; <a class="code" href="global__loc__rw_8h.html#a1">MAX_AMPS_PER_GLOBALPHASE</a> ; _ampindex++ )
00305                  {
00306             <span class="keywordflow">if</span> ( p_loc-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m13">phases</a>[_phaseindex].<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m11">amps</a>[_ampindex].<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m1">logo</a>.<a class="code" href="structMSG__LOGO.html#m0">type</a> == 0 )
00307                         {
00308                <span class="comment">/* no amp of this type */</span>
00309                            <span class="keywordflow">continue</span>;
00310                         }
00311 
00312                         <span class="keywordflow">if</span> ( (r_code = <a class="code" href="global__loc__rw_8c.html#a6">WriteAmpLineToBuffer</a>( &amp;p_loc-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m13">phases</a>[_phaseindex].<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m11">amps</a>[_ampindex]
00313                                                , _amp_buffer
00314                                                , GLOBAL_AMPLINE_MAXBUFSIZE )
00315                  ) == <a class="code" href="global__msg_8h.html#a18a3">GLOBAL_MSG_SUCCESS</a> )
00316             {
00317                <span class="keywordflow">if</span> ( <a class="code" href="global__loc__rw_8h.html#a6">GLOBAL_LOC_MAXBUFSIZE</a> &lt;= (strlen(p_buffer) + strlen(<span class="stringliteral">"AMP "</span>) + strlen(_amp_buffer) + 1) )
00318                {
00319                   <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a11">GLOBAL_MSG_DEFINESMALL</a>;
00320                }
00321                strcat( _writelocation, <span class="stringliteral">"AMP "</span> );
00322                strcat( _writelocation, _amp_buffer );
00323             }
00324             <span class="keywordflow">else</span>
00325             {
00326                <span class="keywordflow">return</span> r_code;
00327             }
00328          }
00329       }
00330       <span class="keywordflow">else</span>
00331       {
00332          <span class="keywordflow">return</span> r_code;
00333       }
00334    }
00335 
00336    <span class="comment">/* Message-Terminating newline */</span>
00337    strcat( p_buffer, <span class="stringliteral">"\n"</span> );
00338 
00339    <span class="keywordflow">return</span> r_code;
00340 }
00341 <span class="comment">/*</span>
00342 <span class="comment">** ===============================================================================</span>
00343 <span class="comment">*/</span>
00344 
<a name="l00345"></a><a class="code" href="global__loc__rw_8c.html#a9">00345</a> <a class="code" href="global__msg_8h.html#a1">GLOBAL_MSG_STATUS</a> <a class="code" href="global__loc__rw_8c.html#a9">StringToAmpLine</a>( <a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html">GLOBAL_AMPLINE_STRUCT</a> * p_amp, <span class="keywordtype">char</span> * p_string )
00346 {
00347    <span class="keywordtype">char</span> _str[80];
00348 
00349    <a class="code" href="global__loc__rw_8h.html#a7">GLOBAL_AMPLINE_BUFFER</a> workbuff;
00350 
00351    <span class="keywordflow">if</span> ( p_amp == NULL )
00352    {
00353 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToAmpLine() FAILURE A\n"</span>);
00354       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a4">GLOBAL_MSG_NULL</a>;
00355    }
00356 
00357    <span class="keywordflow">if</span> ( p_string == NULL )
00358    {
00359 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToAmpLine() FAILURE C\n"</span>);
00360       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a8">GLOBAL_MSG_BADPARAM</a>;
00361    }
00362 
00363    <a class="code" href="global__loc__rw_8c.html#a3">InitGlobalAmpLine</a>(p_amp);
00364 
00365    <span class="keywordflow">if</span> ( <a class="code" href="global__loc__rw_8h.html#a0">GLOBAL_AMPLINE_MAXBUFSIZE</a> &lt; strlen( p_string ) )
00366    {
00367       strncpy( workbuff , p_string , GLOBAL_AMPLINE_MAXBUFSIZE );
00368           workbuff[<a class="code" href="global__loc__rw_8h.html#a0">GLOBAL_AMPLINE_MAXBUFSIZE</a>] = <span class="charliteral">'\0'</span>;
00369    }
00370    <span class="keywordflow">else</span>
00371    {
00372            strcpy( workbuff, p_string );
00373    }
00374 
00375    <a class="code" href="kom_8c.html#a13">k_put</a>(workbuff);
00376 
00377    <span class="comment">/*  Author  */</span>
00378    strcpy( _str , <a class="code" href="kom_8c.html#a16">k_str</a>() );
00379    <span class="keywordflow">if</span> ( strlen(_str) == 0 )
00380    {
00381 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToAmpLine() FAILURE D\n"</span>);
00382       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a6">GLOBAL_MSG_FORMATERROR</a>;
00383    }
00384 
00385    <span class="keywordflow">if</span> ( <a class="code" href="global__msg_8c.html#a3">DecodeAuthor</a>( &amp;(p_amp-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m1">logo</a>), _str ) != <a class="code" href="global__msg_8h.html#a18a3">GLOBAL_MSG_SUCCESS</a> )
00386    {
00387 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToAmpLine() FAILURE E\n"</span>);
00388       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a6">GLOBAL_MSG_FORMATERROR</a>;
00389    }
00390 
00391    <span class="comment">/*  pick sequence number  */</span>
00392    p_amp-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m2">pick_sequence</a> = <a class="code" href="kom_8c.html#a12">k_long</a>();
00393    <span class="keywordflow">if</span> ( <a class="code" href="kom_8c.html#a9">k_err</a>() != 0 )
00394    {
00395 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToAmpLine() FAILURE F\n"</span>);
00396       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a6">GLOBAL_MSG_FORMATERROR</a>;
00397    }
00398 
00399    <span class="comment">/*  version number  */</span>
00400    p_amp-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m0">version</a> = (short)<a class="code" href="kom_8c.html#a12">k_long</a>();
00401    <span class="keywordflow">if</span> ( <a class="code" href="kom_8c.html#a9">k_err</a>() != 0 )
00402    {
00403 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToAmpLine() FAILURE F\n"</span>);
00404       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a6">GLOBAL_MSG_FORMATERROR</a>;
00405    }
00406 
00407    <span class="keywordflow">if</span> ( p_amp-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m0">version</a> != <a class="code" href="global__loc__rw_8c.html#a0">GLOBAL_AMPLINE_VERSION</a> )
00408    {
00409 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToAmpLine() FAILURE G\n"</span>);
00410       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a5">GLOBAL_MSG_VERSINVALID</a>;
00411    }
00412 
00413    <span class="comment">/*  Station  */</span>
00414    strcpy( p_amp-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m3">station</a> , <a class="code" href="kom_8c.html#a16">k_str</a>() );
00415    <span class="keywordflow">if</span> ( strlen(p_amp-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m3">station</a>) == 0 )
00416    {
00417 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToAmpLine() FAILURE H\n"</span>);
00418       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a6">GLOBAL_MSG_FORMATERROR</a>;
00419    }
00420 
00421    <span class="comment">/*  Channel  */</span>
00422    strcpy( p_amp-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m4">channel</a> , <a class="code" href="kom_8c.html#a16">k_str</a>() );
00423    <span class="keywordflow">if</span> ( strlen(p_amp-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m4">channel</a>) == 0 )
00424    {
00425 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToAmpLine() FAILURE I\n"</span>);
00426       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a6">GLOBAL_MSG_FORMATERROR</a>;
00427    }
00428 
00429    <span class="comment">/*  Network  */</span>
00430    strcpy( p_amp-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m5">network</a> , <a class="code" href="kom_8c.html#a16">k_str</a>() );
00431    <span class="keywordflow">if</span> ( strlen(p_amp-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m5">network</a>) == 0 )
00432    {
00433 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToAmpLine() FAILURE J\n"</span>);
00434       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a6">GLOBAL_MSG_FORMATERROR</a>;
00435    }
00436 
00437    <span class="comment">/*  Location  */</span>
00438    strcpy( p_amp-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m6">location</a> , <a class="code" href="kom_8c.html#a16">k_str</a>() );
00439    <span class="keywordflow">if</span> ( strlen(p_amp-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m6">location</a>) == 0 )
00440    {
00441 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToAmpLine() FAILURE K\n"</span>);
00442       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a6">GLOBAL_MSG_FORMATERROR</a>;
00443    }
00444 
00445    <span class="comment">/*  Amplitude Time  */</span>
00446    strcpy( p_amp-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m7">amp_time</a> , <a class="code" href="kom_8c.html#a16">k_str</a>() );
00447    <span class="keywordflow">if</span> ( strlen(p_amp-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m7">amp_time</a>) == 0 )
00448    {
00449 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToAmpLine() FAILURE L\n"</span>);
00450       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a6">GLOBAL_MSG_FORMATERROR</a>;
00451    }
00452 
00453    <span class="comment">/*  Amplitude Type  */</span>
00454    p_amp-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m8">amptype</a> = (int)<a class="code" href="kom_8c.html#a12">k_long</a>();
00455    <span class="keywordflow">if</span> ( <a class="code" href="kom_8c.html#a9">k_err</a>() != 0 )
00456    {
00457 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToAmpLine() FAILURE M\n"</span>);
00458       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a6">GLOBAL_MSG_FORMATERROR</a>;
00459    }
00460 
00461    <span class="comment">/*  A / D Counts  */</span>
00462    p_amp-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m9">adcounts</a> = <a class="code" href="kom_8c.html#a17">k_val</a>();
00463    <span class="keywordflow">if</span> ( <a class="code" href="kom_8c.html#a9">k_err</a>() != 0 )
00464    {
00465 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToAmpLine() FAILURE N\n"</span>);
00466       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a6">GLOBAL_MSG_FORMATERROR</a>;
00467    }
00468 
00469    <span class="comment">/*  Period  */</span>
00470    p_amp-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m10">period</a> = <a class="code" href="kom_8c.html#a17">k_val</a>();
00471    <span class="keywordflow">if</span> ( <a class="code" href="kom_8c.html#a9">k_err</a>() != 0 )
00472    {
00473 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToAmpLine() FAILURE O\n"</span>);
00474       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a6">GLOBAL_MSG_FORMATERROR</a>;
00475    }
00476 
00477    <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a3">GLOBAL_MSG_SUCCESS</a>;
00478 }
00479 
00480 <span class="comment">/* ------------------------------------------------------------------------- */</span>
00481 
<a name="l00482"></a><a class="code" href="global__loc__rw_8c.html#a10">00482</a> <a class="code" href="global__msg_8h.html#a1">GLOBAL_MSG_STATUS</a> <a class="code" href="global__loc__rw_8c.html#a10">StringToPhaseLine</a>( <a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html">GLOBAL_PHSLINE_STRUCT</a> * p_struct, <span class="keywordtype">char</span> * p_string )
00483 {
00484    <span class="keywordtype">char</span> _str[80];
00485 
00486    <a class="code" href="global__loc__rw_8h.html#a9">GLOBAL_PHSLINE_SUM_BUFFER</a> workbuff;
00487 
00488    <span class="keywordflow">if</span> ( p_struct == NULL )
00489    {
00490 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToPhaseLine() FAILURE A\n"</span>);
00491       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a4">GLOBAL_MSG_NULL</a>;
00492    }
00493 
00494    <span class="keywordflow">if</span> ( p_string == NULL )
00495    {
00496 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToPhaseLine() FAILURE C\n"</span>);
00497       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a8">GLOBAL_MSG_BADPARAM</a>;
00498    }
00499 
00500    <a class="code" href="global__loc__rw_8c.html#a4">InitGlobalPhaseLine</a>(p_struct);
00501 
00502    <span class="keywordflow">if</span> ( <a class="code" href="global__loc__rw_8h.html#a2">GLOBAL_PHSLINE_SUM_MAXSIZE</a> &lt; strlen( p_string ) )
00503    {
00504       strncpy( workbuff , p_string , GLOBAL_PHSLINE_SUM_MAXSIZE );
00505           workbuff[<a class="code" href="global__loc__rw_8h.html#a2">GLOBAL_PHSLINE_SUM_MAXSIZE</a>] = <span class="charliteral">'\0'</span>;
00506    }
00507    <span class="keywordflow">else</span>
00508    {
00509            strcpy( workbuff, p_string );
00510    }
00511 
00512    <a class="code" href="kom_8c.html#a13">k_put</a>(workbuff);
00513 
00514    <span class="comment">/*  Author  */</span>
00515    strcpy( _str , <a class="code" href="kom_8c.html#a16">k_str</a>() );
00516 
00517    <span class="keywordflow">if</span> ( strlen(_str) == 0 )
00518    {
00519 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToPhaseLine() FAILURE D\n"</span>);
00520       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a6">GLOBAL_MSG_FORMATERROR</a>;
00521    }
00522 
00523    <span class="keywordflow">if</span> ( <a class="code" href="global__msg_8c.html#a3">DecodeAuthor</a>( &amp;(p_struct-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m1">logo</a>), _str ) != <a class="code" href="global__msg_8h.html#a18a3">GLOBAL_MSG_SUCCESS</a> )
00524    {
00525 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToPhaseLine() FAILURE E\n"</span>);
00526       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a6">GLOBAL_MSG_FORMATERROR</a>;
00527    }
00528 
00529    <span class="comment">/*  sequence number  */</span>
00530    p_struct-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m2">sequence</a> = <a class="code" href="kom_8c.html#a12">k_long</a>();
00531    <span class="keywordflow">if</span> ( <a class="code" href="kom_8c.html#a9">k_err</a>() != 0 )
00532    {
00533 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToPhaseLine() FAILURE F\n"</span>);
00534       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a6">GLOBAL_MSG_FORMATERROR</a>;
00535    }
00536 
00537    <span class="comment">/*  version number  */</span>
00538    p_struct-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m0">version</a> = (short)<a class="code" href="kom_8c.html#a12">k_long</a>();
00539    <span class="keywordflow">if</span> ( <a class="code" href="kom_8c.html#a9">k_err</a>() != 0 )
00540    {
00541 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToPhaseLine() FAILURE G\n"</span>);
00542       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a6">GLOBAL_MSG_FORMATERROR</a>;
00543    }
00544 
00545    <span class="keywordflow">if</span> ( p_struct-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m0">version</a> != <a class="code" href="global__loc__rw_8c.html#a1">GLOBAL_PHSLINE_VERSION</a> )
00546    {
00547 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToPhaseLine() FAILURE H\n"</span>);
00548       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a5">GLOBAL_MSG_VERSINVALID</a>;
00549    }
00550 
00551    <span class="comment">/*  Station  */</span>
00552    strcpy( p_struct-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m3">station</a> , <a class="code" href="kom_8c.html#a16">k_str</a>() );
00553    <span class="keywordflow">if</span> ( strlen(p_struct-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m3">station</a>) == 0 )
00554    {
00555 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToPhaseLine() FAILURE I\n"</span>);
00556       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a6">GLOBAL_MSG_FORMATERROR</a>;
00557    }
00558 
00559    <span class="comment">/*  Channel  */</span>
00560    strcpy( p_struct-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m4">channel</a> , <a class="code" href="kom_8c.html#a16">k_str</a>() );
00561    <span class="keywordflow">if</span> ( strlen(p_struct-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m4">channel</a>) == 0 )
00562    {
00563 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToPhaseLine() FAILURE J\n"</span>);
00564       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a6">GLOBAL_MSG_FORMATERROR</a>;
00565    }
00566 
00567    <span class="comment">/*  Network  */</span>
00568    strcpy( p_struct-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m5">network</a> , <a class="code" href="kom_8c.html#a16">k_str</a>() );
00569    <span class="keywordflow">if</span> ( strlen(p_struct-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m5">network</a>) == 0 )
00570    {
00571 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToPhaseLine() FAILURE K\n"</span>);
00572       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a6">GLOBAL_MSG_FORMATERROR</a>;
00573    }
00574 
00575    <span class="comment">/*  Location  */</span>
00576    strcpy( p_struct-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m6">location</a> , <a class="code" href="kom_8c.html#a16">k_str</a>() );
00577    <span class="keywordflow">if</span> ( strlen(p_struct-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m6">location</a>) == 0 )
00578    {
00579 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToPhaseLine() FAILURE L\n"</span>);
00580       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a6">GLOBAL_MSG_FORMATERROR</a>;
00581    }
00582 
00583    <span class="comment">/*  Pick Time  */</span>
00584    strcpy( p_struct-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m7">pick_time</a> , <a class="code" href="kom_8c.html#a16">k_str</a>() );
00585    <span class="keywordflow">if</span> ( strlen(p_struct-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m7">pick_time</a>) == 0 )
00586    {
00587 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToPhaseLine() FAILURE M\n"</span>);
00588       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a6">GLOBAL_MSG_FORMATERROR</a>;
00589    }
00590 
00591    <span class="comment">/*  Phase Name  */</span>
00592    strcpy( p_struct-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m8">phase_name</a> , <a class="code" href="kom_8c.html#a16">k_str</a>() );
00593    <span class="keywordflow">if</span> ( strlen(p_struct-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m8">phase_name</a>) == 0 )
00594    {
00595 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToPhaseLine() FAILURE N\n"</span>);
00596       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a6">GLOBAL_MSG_FORMATERROR</a>;
00597    }
00598 
00599    <span class="comment">/*  Quality  */</span>
00600    p_struct-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m9">quality</a> = <a class="code" href="kom_8c.html#a17">k_val</a>();
00601    <span class="keywordflow">if</span> ( <a class="code" href="kom_8c.html#a9">k_err</a>() != 0 )
00602    {
00603 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToPhaseLine() FAILURE O\n"</span>);
00604       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a6">GLOBAL_MSG_FORMATERROR</a>;
00605    }
00606 
00607    <span class="comment">/*  Polarity  */</span>
00608    strcpy( _str, <a class="code" href="kom_8c.html#a16">k_str</a>() );
00609    <span class="keywordflow">if</span> ( strlen(_str) == 0 )
00610    {
00611 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToPhaseLine() FAILURE P\n"</span>);
00612       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a6">GLOBAL_MSG_FORMATERROR</a>;
00613    }
00614    p_struct-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m10">polarity</a> = _str[0];
00615 
00616 
00617    <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a3">GLOBAL_MSG_SUCCESS</a>;
00618 }
00619 
00620 <span class="comment">/* ------------------------------------------------------------------------- */</span>
00621 
<a name="l00622"></a><a class="code" href="global__loc__rw_8c.html#a11">00622</a> <a class="code" href="global__msg_8h.html#a1">GLOBAL_MSG_STATUS</a> <a class="code" href="global__loc__rw_8c.html#a11">StringToLoc</a>( <a class="code" href="structGLOBAL__LOC__DATA.html">GLOBAL_LOC_STRUCT</a> * p_loc, <span class="keywordtype">char</span> * p_string )
00623 {
00624    <span class="comment">/*</span>
00625 <span class="comment">   **  Storage space for the lines read from the file.</span>
00626 <span class="comment">   **  Will allow for contatenation of null-terminator</span>
00627 <span class="comment">   **  to simplify chunking.</span>
00628 <span class="comment">   */</span>
00629 
00630    <a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html">GLOBAL_PHSLINE_STRUCT</a> * _phs_pointer = NULL;
00631 
00632    <a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html">GLOBAL_AMPLINE_STRUCT</a>   _amp_data;
00633 
00634    <a class="code" href="global__msg_8h.html#a1">GLOBAL_MSG_STATUS</a> _processresult;
00635 
00636    <span class="keywordtype">char</span> * _readpoint = p_string
00637       , * _linemark
00638       ;
00639 
00640    <span class="keywordtype">int</span> _phscount;
00641 
00642    <span class="keywordtype">char</span> _readingchildren = 1;
00643 
00644    <span class="keywordtype">char</span> _str[80];
00645 
00646    <a class="code" href="global__loc__rw_8h.html#a12">GLOBAL_LOC_SUM_BUFFER</a> sumbuff;
00647    <span class="keywordtype">int</span>  _index;
00648 
00649    <span class="keywordflow">if</span> ( p_string == NULL )
00650    {
00651            <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a4">GLOBAL_MSG_NULL</a>;
00652    }
00653 
00654    <a class="code" href="global__loc__rw_8c.html#a5">InitGlobalLoc</a>(p_loc);
00655 
00656    <span class="comment">/* Find the end of the SUM line */</span>
00657    <span class="keywordflow">if</span> ( (_linemark = strchr( _readpoint, <span class="charliteral">'\n'</span> )) == NULL )
00658    {
00659       <span class="comment">/* didn't find the newline delimiter */</span>
00660 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToLoc() FAILURE A\n"</span>);
00661       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a6">GLOBAL_MSG_FORMATERROR</a>;
00662    }
00663 
00664    _index = _linemark - _readpoint;
00665 
00666    strncpy( sumbuff , _readpoint , _index );
00667    sumbuff[_index] = <span class="charliteral">'\0'</span>;
00668 
00669    <a class="code" href="kom_8c.html#a13">k_put</a>(sumbuff);
00670 
00671    <span class="comment">/*  Line Type (SUM) */</span>
00672    strcpy( _str , <a class="code" href="kom_8c.html#a16">k_str</a>() );
00673    <span class="keywordflow">if</span> ( strcmp(_str, <span class="stringliteral">"SUM"</span>) != 0 )
00674    {
00675 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToLoc() FAILURE B\n"</span>);
00676       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a6">GLOBAL_MSG_FORMATERROR</a>;
00677    }
00678 
00679    <span class="comment">/*  Author  */</span>
00680    strcpy( _str , <a class="code" href="kom_8c.html#a16">k_str</a>() );
00681    <span class="keywordflow">if</span> ( strlen(_str) == 0 )
00682    {
00683 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToLoc() FAILURE C\n"</span>);
00684       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a6">GLOBAL_MSG_FORMATERROR</a>;
00685    }
00686 
00687    <span class="keywordflow">if</span> ( <a class="code" href="global__msg_8c.html#a3">DecodeAuthor</a>( &amp;(p_loc-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m1">logo</a>), _str ) != <a class="code" href="global__msg_8h.html#a18a3">GLOBAL_MSG_SUCCESS</a> )
00688    {
00689 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToLoc() FAILURE D\n"</span>);
00690       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a6">GLOBAL_MSG_FORMATERROR</a>;
00691    }
00692 
00693    <span class="comment">/*  version number  */</span>
00694    p_loc-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m0">version</a> = (short)<a class="code" href="kom_8c.html#a12">k_long</a>();
00695    <span class="keywordflow">if</span> ( <a class="code" href="kom_8c.html#a9">k_err</a>() != 0 )
00696    {
00697 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToLoc() FAILURE E\n"</span>);
00698       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a6">GLOBAL_MSG_FORMATERROR</a>;
00699    }
00700 
00701 
00702    <span class="keywordflow">if</span> ( p_loc-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m0">version</a> != <a class="code" href="global__loc__rw_8c.html#a2">GLOBAL_LOC_VERSION</a> )
00703    {
00704 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToLoc() FAILURE E 2\n"</span>);
00705       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a5">GLOBAL_MSG_VERSINVALID</a>;
00706    }
00707 
00708 
00709    <span class="comment">/*  Event Id  */</span>
00710    p_loc-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m2">event_id</a> = <a class="code" href="kom_8c.html#a12">k_long</a>();
00711    <span class="keywordflow">if</span> ( <a class="code" href="kom_8c.html#a9">k_err</a>() != 0 )
00712    {
00713 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToLoc() FAILURE F\n"</span>);
00714       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a6">GLOBAL_MSG_FORMATERROR</a>;
00715    }
00716 
00717 
00718    <span class="comment">/*  Origin Id  */</span>
00719    p_loc-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m3">origin_id</a> = <a class="code" href="kom_8c.html#a12">k_long</a>();
00720    <span class="keywordflow">if</span> ( <a class="code" href="kom_8c.html#a9">k_err</a>() != 0 )
00721    {
00722 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToLoc() FAILURE G\n"</span>);
00723       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a6">GLOBAL_MSG_FORMATERROR</a>;
00724    }
00725 
00726 
00727    <span class="comment">/*  Origin Time  */</span>
00728    strcpy( p_loc-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m4">origin_time</a> , <a class="code" href="kom_8c.html#a16">k_str</a>() );
00729    <span class="keywordflow">if</span> ( strlen(p_loc-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m4">origin_time</a>) == 0 )
00730    {
00731 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToLoc() FAILURE H\n"</span>);
00732       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a6">GLOBAL_MSG_FORMATERROR</a>;
00733    }
00734 
00735 
00736    <span class="comment">/*  Latitude  */</span>
00737    p_loc-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m5">lat</a> = <a class="code" href="kom_8c.html#a17">k_val</a>();
00738    <span class="keywordflow">if</span> ( <a class="code" href="kom_8c.html#a9">k_err</a>() != 0 )
00739    {
00740 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToLoc() FAILURE I\n"</span>);
00741       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a6">GLOBAL_MSG_FORMATERROR</a>;
00742    }
00743 
00744    <span class="comment">/*  Longitude  */</span>
00745    p_loc-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m6">lon</a> = <a class="code" href="kom_8c.html#a17">k_val</a>();
00746    <span class="keywordflow">if</span> ( <a class="code" href="kom_8c.html#a9">k_err</a>() != 0 )
00747    {
00748 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToLoc() FAILURE J\n"</span>);
00749       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a6">GLOBAL_MSG_FORMATERROR</a>;
00750    }
00751 
00752    <span class="comment">/*  Depth  */</span>
00753    p_loc-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m7">depth</a> = (float)<a class="code" href="kom_8c.html#a17">k_val</a>();
00754    <span class="keywordflow">if</span> ( <a class="code" href="kom_8c.html#a9">k_err</a>() != 0 )
00755    {
00756 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToLoc() FAILURE K\n"</span>);
00757       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a6">GLOBAL_MSG_FORMATERROR</a>;
00758    }
00759 
00760 
00761    <span class="comment">/*  Gap  */</span>
00762    p_loc-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m8">gap</a> = (float)<a class="code" href="kom_8c.html#a17">k_val</a>();
00763    <span class="keywordflow">if</span> ( <a class="code" href="kom_8c.html#a9">k_err</a>() != 0 )
00764    {
00765 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToLoc() FAILURE L\n"</span>);
00766       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a6">GLOBAL_MSG_FORMATERROR</a>;
00767    }
00768 
00769    <span class="comment">/*  DMin  */</span>
00770    p_loc-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m9">dmin</a> = (float)<a class="code" href="kom_8c.html#a17">k_val</a>();
00771    <span class="keywordflow">if</span> ( <a class="code" href="kom_8c.html#a9">k_err</a>() != 0 )
00772    {
00773 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToLoc() FAILURE M\n"</span>);
00774       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a6">GLOBAL_MSG_FORMATERROR</a>;
00775    }
00776 
00777    <span class="comment">/*  RMS  */</span>
00778    p_loc-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m10">rms</a> = (float)<a class="code" href="kom_8c.html#a17">k_val</a>();
00779    <span class="keywordflow">if</span> ( <a class="code" href="kom_8c.html#a9">k_err</a>() != 0 )
00780    {
00781 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToLoc() FAILURE N\n"</span>);
00782       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a6">GLOBAL_MSG_FORMATERROR</a>;
00783    }
00784 
00785 
00786    <span class="comment">/*  Number of Picks used to calculate origin  */</span>
00787    p_loc-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m11">pick_count</a> = (int)<a class="code" href="kom_8c.html#a12">k_long</a>();
00788    <span class="keywordflow">if</span> ( <a class="code" href="kom_8c.html#a9">k_err</a>() != 0 )
00789    {
00790 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToLoc() FAILURE O\n"</span>);
00791       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a6">GLOBAL_MSG_FORMATERROR</a>;
00792    }
00793 
00794 
00795 
00796    <span class="comment">/*  Number of Phase structures included  */</span>
00797    _phscount = (int)<a class="code" href="kom_8c.html#a12">k_long</a>();
00798    <span class="keywordflow">if</span> ( <a class="code" href="kom_8c.html#a9">k_err</a>() != 0 )
00799    {
00800 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToLoc() FAILURE P\n"</span>);
00801       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a6">GLOBAL_MSG_FORMATERROR</a>;
00802    }
00803 
00804    <span class="comment">/* END OF SUM LINE */</span>
00805 
00806    <span class="keywordflow">do</span>
00807    {
00808       <span class="comment">/* Set read point to start of next child line */</span>
00809       _readpoint = _linemark + 1;
00810 
00811           <span class="comment">/*</span>
00812 <span class="comment">          ** need the \r to handle file2ring</span>
00813 <span class="comment">          */</span>
00814       <span class="keywordflow">if</span> ( *_readpoint == <span class="charliteral">'\n'</span> || *_readpoint == <span class="charliteral">'\r'</span> )
00815       {
00816          <span class="comment">/* next char in file is newline, this indicated file termination */</span>
00817          _readingchildren = 0;
00818          <span class="keywordflow">break</span>;
00819       }
00820 <span class="comment">/*</span>
00821 <span class="comment">logit( ""</span>
00822 <span class="comment">         , "DEBUG parseline  (%d) [%d  %d]\n&gt;%s&lt;\n"</span>
00823 <span class="comment">         , strlen(_readpoint)</span>
00824 <span class="comment">         , *_readpoint</span>
00825 <span class="comment">         , '\n'</span>
00826 <span class="comment">         , _readpoint</span>
00827 <span class="comment">         );</span>
00828 <span class="comment">*/</span>
00829       <span class="keywordflow">if</span> ( strncmp( _readpoint, <span class="stringliteral">"PHS "</span>, 4 ) == 0 )
00830       {
00831          <span class="comment">/* Phase Line */</span>
00832 
00833          <span class="keywordflow">if</span> ( p_loc-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m12">nphs</a> == <a class="code" href="global__loc__rw_8h.html#a5">GLOBAL_LOC_MAXPHS</a> )
00834          {
00835             <span class="comment">/* no space for any more Phases */</span>
00836 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToLoc() FAILURE Q\n"</span>);
00837             <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a7">GLOBAL_MSG_MAXCHILDREN</a>;
00838          }
00839 
00840          <span class="comment">/* Advance the pointer to the first data location */</span>
00841          _readpoint += 4;
00842 
00843          <span class="comment">/* Find the end of the PHS line */</span>
00844          <span class="keywordflow">if</span> ( (_linemark = strchr( _readpoint, <span class="charliteral">'\n'</span> )) == NULL )
00845          {
00846             <span class="comment">/* didn't find the newline delimiter */</span>
00847 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToLoc() FAILURE R\n"</span>);
00848             <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a6">GLOBAL_MSG_FORMATERROR</a>;
00849          }
00850 
00851          <span class="comment">/* null-terminate the PHS line (into a string) */</span>
00852          *_linemark = <span class="charliteral">'\0'</span>;
00853 
00854          _phs_pointer = &amp;p_loc-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m13">phases</a>[p_loc-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m12">nphs</a>];
00855 
00856          <span class="comment">/* parse the working buffer into the location's next Phase struct */</span>
00857          <span class="keywordflow">if</span> ( (_processresult = <a class="code" href="global__loc__rw_8c.html#a10">StringToPhaseLine</a>( _phs_pointer, _readpoint )) != <a class="code" href="global__msg_8h.html#a18a3">GLOBAL_MSG_SUCCESS</a> )
00858          {
00859 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToLoc() FAILURE S\n"</span>);
00860             <span class="keywordflow">return</span> _processresult;
00861          }
00862 
00863 
00864          <span class="comment">/* increment the phase count */</span>
00865          p_loc-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m12">nphs</a>++;
00866 
00867          <span class="comment">/* End of PHS Line */</span>
00868 
00869       }
00870       <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( strncmp( _readpoint, <span class="stringliteral">"AMP "</span>, 4 ) == 0 )
00871       {
00872          <span class="comment">/* Amplitude Line */</span>
00873 
00874          <span class="keywordflow">if</span> ( p_loc-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m12">nphs</a> == 0 || _phs_pointer == NULL )
00875          {
00876             <span class="comment">/*</span>
00877 <span class="comment">            ** should already have read a phase line to contain this amp,</span>
00878 <span class="comment">            ** thus, this is an error</span>
00879 <span class="comment">            */</span>
00880 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToLoc() FAILURE T\n"</span>);
00881             <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a6">GLOBAL_MSG_FORMATERROR</a>;
00882          }
00883 
00884 
00885          <span class="comment">/* Advance the pointer to the first data location */</span>
00886          _readpoint += 4;
00887 
00888          <span class="comment">/* Find the end of the AMP line */</span>
00889          <span class="keywordflow">if</span> ( (_linemark = strchr( _readpoint, <span class="charliteral">'\n'</span> )) == NULL )
00890          {
00891             <span class="comment">/* didn't find the newline delimiter */</span>
00892 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToLoc() FAILURE V\n"</span>);
00893             <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a6">GLOBAL_MSG_FORMATERROR</a>;
00894          }
00895 
00896          <span class="comment">/* null-terminate the AMP line (into a string) */</span>
00897          *_linemark = <span class="charliteral">'\0'</span>;
00898 
00899 
00900          <span class="comment">/* parse the working buffer into the current Phase's next Amp struct */</span>
00901          <span class="keywordflow">if</span> ( (_processresult = <a class="code" href="global__loc__rw_8c.html#a9">StringToAmpLine</a>( &amp;_amp_data, _readpoint )) != <a class="code" href="global__msg_8h.html#a18a3">GLOBAL_MSG_SUCCESS</a> )
00902          {
00903 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToLoc() FAILURE W\n"</span>);
00904             <span class="keywordflow">return</span> _processresult;
00905          }
00906 
00907          <span class="comment">/* increment the phase count */</span>
00908          <span class="keywordflow">if</span> ( (_processresult = <a class="code" href="global__loc__rw_8c.html#a12">AddAmpLineToPhase</a>( _phs_pointer, &amp;_amp_data )) &lt; 0 )
00909                  {
00910 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToLoc() FAILURE X\n"</span>);
00911             <span class="keywordflow">return</span> _processresult;
00912                  }
00913 
00914          <span class="comment">/* End of AMP Line */</span>
00915 
00916       }
00917       <span class="keywordflow">else</span>
00918       {
00919          <span class="comment">/* Unrecognized Line start tag */</span>
00920 <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToLoc() FAILURE Y\n&gt;%s&lt;\n"</span>, _readpoint);
00921          <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a10">GLOBAL_MSG_BADCHILD</a>;
00922       }
00923 
00924    } <span class="keywordflow">while</span>( _readingchildren == 1 );
00925 
00926    <span class="keywordflow">if</span> ( p_loc-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m12">nphs</a> != _phscount )
00927    {
00928       <a class="code" href="logit_8c.html#a18">logit</a>( <span class="stringliteral">""</span>, <span class="stringliteral">"DEBUG StringToLoc() FAILURE Z\n"</span>);
00929       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a6">GLOBAL_MSG_FORMATERROR</a>;
00930    }
00931 
00932    <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a3">GLOBAL_MSG_SUCCESS</a>;
00933 }
00934 
00935 <span class="comment">/*</span>
00936 <span class="comment">** ===============================================================================</span>
00937 <span class="comment">*/</span>
00938 
<a name="l00939"></a><a class="code" href="global__loc__rw_8c.html#a12">00939</a> <span class="keywordtype">int</span> <a class="code" href="global__loc__rw_8c.html#a12">AddAmpLineToPhase</a>( <a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html">GLOBAL_PHSLINE_STRUCT</a> * p_phase
00940                      , <a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html">GLOBAL_AMPLINE_STRUCT</a> * p_amp
00941                      )
00942 {
00943    <a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html">GLOBAL_AMPLINE_STRUCT</a> * _destin;
00944 
00945    <span class="keywordtype">int</span> ampindex = <a class="code" href="global__msg_8h.html#a18a12">GLOBAL_MSG_BADAMPTYPE</a>;
00946 
00947    <span class="keywordflow">if</span> ( p_phase == NULL || p_amp == NULL )
00948    {
00949       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a4">GLOBAL_MSG_NULL</a>;
00950    }
00951 
00952    <span class="keywordflow">if</span> ( p_phase-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m0">version</a> != <a class="code" href="global__loc__rw_8c.html#a1">GLOBAL_PHSLINE_VERSION</a> )
00953    {
00954       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a5">GLOBAL_MSG_VERSINVALID</a>;
00955    }
00956 
00957    <span class="keywordflow">if</span> ( p_amp-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m0">version</a> != <a class="code" href="global__loc__rw_8c.html#a0">GLOBAL_AMPLINE_VERSION</a> )
00958    {
00959       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a8">GLOBAL_MSG_BADPARAM</a>;
00960    }
00961 
00962    <span class="comment">/* Index into amp array does not include unknown ('?') */</span>
00963    ampindex = p_amp-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m8">amptype</a> - 1;
00964 
00965    <span class="keywordflow">if</span> ( 0 &lt;= ampindex &amp;&amp; ampindex &lt; <a class="code" href="global__loc__rw_8h.html#a1">MAX_AMPS_PER_GLOBALPHASE</a> )
00966    {
00967       _destin = &amp;p_phase-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m11">amps</a>[ampindex];
00968 
00969               _destin-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m1">logo</a>.<a class="code" href="structMSG__LOGO.html#m0">type</a>     = p_amp-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m1">logo</a>.<a class="code" href="structMSG__LOGO.html#m0">type</a>;
00970               _destin-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m1">logo</a>.<a class="code" href="structMSG__LOGO.html#m1">mod</a>      = p_amp-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m1">logo</a>.<a class="code" href="structMSG__LOGO.html#m1">mod</a>;
00971               _destin-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m1">logo</a>.<a class="code" href="structMSG__LOGO.html#m2">instid</a>   = p_amp-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m1">logo</a>.<a class="code" href="structMSG__LOGO.html#m2">instid</a>;
00972               _destin-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m2">pick_sequence</a> = p_amp-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m2">pick_sequence</a>;
00973               _destin-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m0">version</a>       = p_amp-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m0">version</a>;
00974       strcpy( _destin-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m3">station</a>       , p_amp-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m3">station</a> );
00975       strcpy( _destin-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m4">channel</a>       , p_amp-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m4">channel</a> );
00976       strcpy( _destin-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m5">network</a>       , p_amp-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m5">network</a> );
00977       strcpy( _destin-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m6">location</a>      , p_amp-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m6">location</a> );
00978       strcpy( _destin-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m7">amp_time</a>      , p_amp-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m7">amp_time</a> );
00979               _destin-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m8">amptype</a>       = p_amp-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m8">amptype</a>;
00980               _destin-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m9">adcounts</a>      = p_amp-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m9">adcounts</a>;
00981               _destin-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m10">period</a>        = p_amp-&gt;<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m10">period</a>;
00982 
00983    }
00984 
00985    <span class="keywordflow">return</span> ampindex;
00986 }
00987 
00988 <span class="comment">/* ------------------------------------------------------------------------- */</span>
00989 
<a name="l00990"></a><a class="code" href="global__loc__rw_8c.html#a13">00990</a> <span class="keywordtype">int</span> <a class="code" href="global__loc__rw_8c.html#a13">AddPhaseLineToLoc</a>( <a class="code" href="structGLOBAL__LOC__DATA.html">GLOBAL_LOC_STRUCT</a>     * p_loc
00991                      , <a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html">GLOBAL_PHSLINE_STRUCT</a> * p_phase
00992                      )
00993 {
00994    <span class="keywordtype">int</span> r_code;
00995 
00996    <a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html">GLOBAL_PHSLINE_STRUCT</a> * _destin;
00997 
00998    <span class="keywordtype">short</span>   _a;
00999 
01000    <span class="keywordflow">if</span> ( p_loc == NULL || p_phase == NULL )
01001    {
01002       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a4">GLOBAL_MSG_NULL</a>;
01003    }
01004 
01005    <span class="keywordflow">if</span> ( p_loc-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m0">version</a> != <a class="code" href="global__loc__rw_8c.html#a2">GLOBAL_LOC_VERSION</a> )
01006    {
01007       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a5">GLOBAL_MSG_VERSINVALID</a>;
01008    }
01009 
01010    <span class="keywordflow">if</span> ( p_phase-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m0">version</a> != <a class="code" href="global__loc__rw_8c.html#a1">GLOBAL_PHSLINE_VERSION</a> )
01011    {
01012       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a8">GLOBAL_MSG_BADPARAM</a>;
01013    }
01014 
01015    <span class="keywordflow">if</span> ( p_loc-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m12">nphs</a> == <a class="code" href="global__loc__rw_8h.html#a5">GLOBAL_LOC_MAXPHS</a> )
01016    {
01017       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a7">GLOBAL_MSG_MAXCHILDREN</a>;
01018    }
01019 
01020    _destin = &amp;p_loc-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m13">phases</a>[p_loc-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m12">nphs</a>];
01021 
01022            _destin-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m0">version</a>     = p_phase-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m0">version</a>;
01023            _destin-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m1">logo</a>.<a class="code" href="structMSG__LOGO.html#m0">type</a>   = p_phase-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m1">logo</a>.<a class="code" href="structMSG__LOGO.html#m0">type</a>;
01024            _destin-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m1">logo</a>.<a class="code" href="structMSG__LOGO.html#m1">mod</a>    = p_phase-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m1">logo</a>.<a class="code" href="structMSG__LOGO.html#m1">mod</a>;
01025            _destin-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m1">logo</a>.<a class="code" href="structMSG__LOGO.html#m2">instid</a> = p_phase-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m1">logo</a>.<a class="code" href="structMSG__LOGO.html#m2">instid</a>;
01026            _destin-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m2">sequence</a>    = p_phase-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m2">sequence</a>;
01027    strcpy( _destin-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m3">station</a>     , p_phase-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m3">station</a> );
01028    strcpy( _destin-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m4">channel</a>     , p_phase-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m4">channel</a> );
01029    strcpy( _destin-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m5">network</a>     , p_phase-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m5">network</a> );
01030    strcpy( _destin-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m6">location</a>    , p_phase-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m6">location</a> );
01031    strcpy( _destin-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m7">pick_time</a>   , p_phase-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m7">pick_time</a> );
01032    strcpy( _destin-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m8">phase_name</a>  , p_phase-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m8">phase_name</a> );
01033            _destin-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m9">quality</a>     = p_phase-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m9">quality</a>;
01034            _destin-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m10">polarity</a>    = p_phase-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m10">polarity</a>;
01035 
01036    <span class="keywordflow">for</span> ( _a = 0 ; _a &lt; <a class="code" href="global__loc__rw_8h.html#a1">MAX_AMPS_PER_GLOBALPHASE</a> ; _a++ )
01037    {
01038           <span class="keywordflow">if</span> ( p_phase-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m11">amps</a>[_a].<a class="code" href="struct__GLOBAL__AMPLINE__STRUCT.html#m1">logo</a>.<a class="code" href="structMSG__LOGO.html#m0">type</a> == 0 )
01039           {
01040                   <span class="keywordflow">continue</span>;
01041           }
01042       <span class="keywordflow">if</span> ( (r_code = <a class="code" href="global__loc__rw_8c.html#a12">AddAmpLineToPhase</a>( _destin, &amp;p_phase-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m11">amps</a>[_a] )) &lt; 0 )
01043       {
01044          <span class="keywordflow">return</span> r_code;
01045       }
01046    }
01047 
01048    p_loc-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m12">nphs</a>++;
01049 
01050    <span class="keywordflow">return</span> p_loc-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m12">nphs</a> - 1;
01051 }
01052 
01053 <span class="comment">/*</span>
01054 <span class="comment">** ===============================================================================</span>
01055 <span class="comment">*/</span>
01056 
<a name="l01057"></a><a class="code" href="global__loc__rw_8c.html#a14">01057</a> <span class="keywordtype">int</span> <a class="code" href="global__loc__rw_8c.html#a14">GetLocPhaseIndex</a>( <a class="code" href="structGLOBAL__LOC__DATA.html">GLOBAL_LOC_STRUCT</a>     * p_loc
01058                     , <a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html">GLOBAL_PHSLINE_STRUCT</a> * p_phase
01059                     )
01060 {
01061    <span class="keywordtype">int</span> r_index = 0
01062      , _idx = 0
01063      ;
01064 
01065    <span class="keywordflow">for</span> ( ; _idx &lt; p_loc-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m12">nphs</a> ; _idx++ )
01066    {
01067       <span class="keywordflow">if</span> (   p_phase-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m2">sequence</a>    == p_loc-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m13">phases</a>[_idx].<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m2">sequence</a>
01068           &amp;&amp; p_phase-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m1">logo</a>.<a class="code" href="structMSG__LOGO.html#m1">mod</a>    == p_loc-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m13">phases</a>[_idx].<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m1">logo</a>.<a class="code" href="structMSG__LOGO.html#m1">mod</a>
01069           &amp;&amp; p_phase-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m1">logo</a>.<a class="code" href="structMSG__LOGO.html#m2">instid</a> == p_loc-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m13">phases</a>[_idx].<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m1">logo</a>.<a class="code" href="structMSG__LOGO.html#m2">instid</a>
01070          )
01071       {
01072          <span class="comment">/* this is the match, return */</span>
01073          r_index = _idx;
01074          <span class="keywordflow">break</span>;
01075       }
01076    }
01077 
01078    <span class="keywordflow">return</span> r_index;
01079 }
01080 
01081 <span class="comment">/*</span>
01082 <span class="comment">** ===============================================================================</span>
01083 <span class="comment">*/</span>
01084 
<a name="l01085"></a><a class="code" href="global__loc__rw_8c.html#a15">01085</a> <a class="code" href="global__msg_8h.html#a1">GLOBAL_MSG_STATUS</a> <a class="code" href="global__loc__rw_8c.html#a15">ClearAmpLines</a>( <a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html">GLOBAL_PHSLINE_STRUCT</a> * p_phase )
01086 {
01087    <span class="keywordtype">int</span> _a;
01088 
01089    <span class="keywordflow">if</span> ( p_phase == NULL )
01090    {
01091       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a4">GLOBAL_MSG_NULL</a>;
01092    }
01093    <span class="keywordflow">if</span> ( p_phase-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m0">version</a> != <a class="code" href="global__loc__rw_8c.html#a2">GLOBAL_LOC_VERSION</a> )
01094    {
01095       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a5">GLOBAL_MSG_VERSINVALID</a>;
01096    }
01097    <span class="keywordflow">for</span> ( _a = 0 ; _a &lt; <a class="code" href="global__loc__rw_8h.html#a1">MAX_AMPS_PER_GLOBALPHASE</a> ; _a++ )
01098    {
01099       <a class="code" href="global__loc__rw_8c.html#a3">InitGlobalAmpLine</a>( &amp;p_phase-&gt;<a class="code" href="struct__GLOBAL__PHSLINE__STRUCT.html#m11">amps</a>[_a] );
01100    }
01101    <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a3">GLOBAL_MSG_SUCCESS</a>;
01102 }
01103 
01104 <span class="comment">/* ------------------------------------------------------------------------- */</span>
01105 
<a name="l01106"></a><a class="code" href="global__loc__rw_8c.html#a16">01106</a> <a class="code" href="global__msg_8h.html#a1">GLOBAL_MSG_STATUS</a> <a class="code" href="global__loc__rw_8c.html#a16">ClearPhaseLines</a>( <a class="code" href="structGLOBAL__LOC__DATA.html">GLOBAL_LOC_STRUCT</a> * p_loc )
01107 {
01108    <span class="keywordflow">if</span> ( p_loc == NULL )
01109    {
01110       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a4">GLOBAL_MSG_NULL</a>;
01111    }
01112    <span class="keywordflow">if</span> ( p_loc-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m0">version</a> != <a class="code" href="global__loc__rw_8c.html#a2">GLOBAL_LOC_VERSION</a> )
01113    {
01114       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a5">GLOBAL_MSG_VERSINVALID</a>;
01115    }
01116    p_loc-&gt;<a class="code" href="structGLOBAL__LOC__DATA.html#m12">nphs</a> = 0;
01117    <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a3">GLOBAL_MSG_SUCCESS</a>;
01118 }
01119 
01120 <span class="comment">/*</span>
01121 <span class="comment">** ===============================================================================</span>
01122 <span class="comment">*/</span>
01123 <span class="comment">/*</span>
01124 <span class="comment">** ===============================================================================</span>
01125 <span class="comment">*/</span>
01126 
</pre></div><hr><address style="align: right;"><small>Generated on Tue May 6 09:16:02 2003 for Earthworm Libs by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.3-rc3 </small></address>
</body>
</html>
