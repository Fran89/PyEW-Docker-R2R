<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>brent.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3-rc3 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>brent.c</h1><a href="brent_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 
00002 <span class="comment">/*</span>
00003 <span class="comment"> *   THIS FILE IS UNDER RCS - DO NOT MODIFY UNLESS YOU HAVE</span>
00004 <span class="comment"> *   CHECKED IT OUT USING THE COMMAND CHECKOUT.</span>
00005 <span class="comment"> *</span>
00006 <span class="comment"> *    $Id: brent_8c-source.html 2161 2006-05-19 16:55:03Z paulf $</span>
00007 <span class="comment"> *</span>
00008 <span class="comment"> *    Revision history:</span>
00009 <span class="comment"> *     $Log$
00009 <span class="comment"> *     Revision 1.1  2006/05/19 16:55:01  paulf
00009 <span class="comment"> *     first inclusion
00009 <span class="comment"> *</span>
00010 <span class="comment"> *     Revision 1.1  2000/02/14 18:51:48  lucky</span>
00011 <span class="comment"> *     Initial revision</span>
00012 <span class="comment"> *</span>
00013 <span class="comment"> *</span>
00014 <span class="comment"> */</span>
00015 
00016 <span class="preprocessor">#include &lt;math.h&gt;</span>
00017 
<a name="l00018"></a><a class="code" href="brent_8c.html#a0">00018</a> <span class="preprocessor">#define ITMAX 100</span>
<a name="l00019"></a><a class="code" href="brent_8c.html#a1">00019</a> <span class="preprocessor"></span><span class="preprocessor">#define CGOLD 0.3819660</span>
<a name="l00020"></a><a class="code" href="brent_8c.html#a2">00020</a> <span class="preprocessor"></span><span class="preprocessor">#define ZEPS 1.0e-10</span>
<a name="l00021"></a><a class="code" href="brent_8c.html#a3">00021</a> <span class="preprocessor"></span><span class="preprocessor">#define SIGN(a,b) ((b) &gt; 0.0 ? fabs(a) : -fabs(a))</span>
<a name="l00022"></a><a class="code" href="brent_8c.html#a4">00022</a> <span class="preprocessor"></span><span class="preprocessor">#define SHFT(a,b,c,d) (a)=(b);(b)=(c);(c)=(d);</span>
00023 <span class="preprocessor"></span>
<a name="l00024"></a><a class="code" href="brent_8c.html#a5">00024</a> <span class="keywordtype">float</span> <a class="code" href="brent_8c.html#a5">brent</a>(<span class="keywordtype">float</span> ax, <span class="keywordtype">float</span> bx, <span class="keywordtype">float</span> cx, <span class="keywordtype">float</span> (*f)(<span class="keywordtype">float</span>), <span class="keywordtype">float</span> tol, <span class="keywordtype">float</span> *xmin)
00025 {
00026         <span class="keywordtype">int</span> iter;
00027         <span class="keywordtype">float</span> a,b,etemp,fu,fv,fw,fx,p,q,r,tol1,tol2,u,v,w,x,xm;
00028         <span class="keywordtype">float</span> d=0.0;
00029         <span class="keywordtype">float</span> e=0.0;
00030 
00031         a=((ax &lt; cx) ? ax : cx);
00032         b=((ax &gt; cx) ? ax : cx);
00033         x=w=v=bx;
00034         fw=fv=fx=(*f)(x);
00035 
00036         <span class="keywordflow">for</span> (iter=1;iter&lt;=<a class="code" href="brent_8c.html#a0">ITMAX</a>;iter++)
00037         {
00038            xm=(float)0.5*(a+b);
00039 
00040 
00041            tol2=(float)2.0*(tol1=(float)tol*(float)fabs(x)+(float)<a class="code" href="brent_8c.html#a2">ZEPS</a>);
00042 
00043            <span class="keywordflow">if</span> (fabs(x-xm) &lt;= (tol2-0.5*(b-a)))
00044            {
00045               *xmin=x;
00046               <span class="keywordflow">return</span> fx;
00047            }
00048            <span class="keywordflow">if</span> (fabs(e) &gt; tol1)
00049            {
00050               r=(x-w)*(fx-fv);
00051               q=(x-v)*(fx-fw);
00052               p=(x-v)*q-(x-w)*r;
00053               q=(float)2.0*(q-r);
00054               <span class="keywordflow">if</span> (q &gt; 0.0) p = -p;
00055               q=(float)fabs(q);
00056               etemp=e;
00057               e=d;
00058               <span class="keywordflow">if</span> (fabs(p) &gt;= fabs(0.5*q*etemp) || p &lt;= q*(a-x) || p &gt;= q*(b-x))
00059                  d=(float)<a class="code" href="brent_8c.html#a1">CGOLD</a>*(e=(x &gt;= xm ? a-x : b-x));
00060               <span class="keywordflow">else</span>
00061               {
00062                  d=p/q;
00063                  u=x+d;
00064                  <span class="keywordflow">if</span> (u-a &lt; tol2 || b-u &lt; tol2)
00065                     d=(float)<a class="code" href="brent_8c.html#a3">SIGN</a>(tol1,xm-x);
00066               }
00067            }
00068            <span class="keywordflow">else</span>
00069               d=(float)<a class="code" href="brent_8c.html#a1">CGOLD</a>*(e=(x &gt;= xm ? a-x : b-x));
00070 
00071            u=(float)(fabs(d) &gt;= tol1 ? x+d : x+<a class="code" href="brent_8c.html#a3">SIGN</a>(tol1,d));
00072            fu=(*f)(u);
00073            <span class="keywordflow">if</span> (fu &lt;= fx)
00074            {
00075               <span class="keywordflow">if</span> (u &gt;= x) a=x; <span class="keywordflow">else</span> b=x;
00076               <a class="code" href="brent_8c.html#a4">SHFT</a>(v,w,x,u)
00077               <a class="code" href="brent_8c.html#a4">SHFT</a>(fv,fw,fx,fu)
00078            }
00079            <span class="keywordflow">else</span>
00080            {
00081               <span class="keywordflow">if</span> (u &lt; x) a=u; <span class="keywordflow">else</span> b=u;
00082               <span class="keywordflow">if</span> (fu &lt;= fw || w == x)
00083               {
00084                  v=w;
00085                  w=u;
00086                  fv=fw;
00087                  fw=fu;
00088               }
00089               <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fu &lt;= fv || v == x || v == w)
00090               {
00091                  v=u;
00092                  fv=fu;
00093               }
00094            }
00095         }
00096         *xmin=x;
00097         <span class="keywordflow">return</span> fx;
00098 }
00099 
00100 <span class="preprocessor">#undef ITMAX</span>
00101 <span class="preprocessor"></span><span class="preprocessor">#undef CGOLD</span>
00102 <span class="preprocessor"></span><span class="preprocessor">#undef ZEPS</span>
00103 <span class="preprocessor"></span><span class="preprocessor">#undef SIGN</span>
</pre></div><hr><address style="align: right;"><small>Generated on Tue May 6 09:16:00 2003 for Earthworm Libs by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.3-rc3 </small></address>
</body>
</html>
