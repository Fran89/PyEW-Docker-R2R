<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>magnserverrequest.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3-rc3 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>magnserverrequest.cpp</h1><a href="magnserverrequest_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">// magnserverrequest.cpp: implementation of the ServerMagnitudeRequest class.</span>
00002 <span class="comment">//</span>
00004 <span class="comment"></span>
00005 <span class="preprocessor">#include "<a class="code" href="magnserverrequest_8h.html">magnserverrequest.h</a>"</span>
00006 
00008 <span class="comment">// Construction/Destruction</span>
00010 <span class="comment"></span>
<a name="l00011"></a><a class="code" href="classServerMagnitudeRequest.html#a0">00011</a> <a class="code" href="classServerMagnitudeRequest.html#a0">ServerMagnitudeRequest::ServerMagnitudeRequest</a>()
00012 {
00013    <a class="code" href="classServerMagnitudeRequest.html#n0">TestValue</a> = 0;
00014 }
00015 <span class="comment">//</span>
00016 <span class="comment">// --------------------------------------------------------------------</span>
00017 <span class="comment">//</span>
<a name="l00018"></a><a class="code" href="classServerMagnitudeRequest.html#b0">00018</a> <span class="keywordtype">long</span> <a class="code" href="classServerMagnitudeRequest.html#b0">ServerMagnitudeRequest::BufferInitAlloc</a>()
00019 {
00020    <span class="keywordflow">return</span> (long)(  <a class="code" href="classMutableServerRequest.html#b0">MutableServerRequest::BufferInitAlloc</a>()
00021                  + 10 <span class="comment">// TestValue.length()</span>
00022                  + 1  <span class="comment">// additional '\n'</span>
00023                 )
00024                 ;
00025 }
00026 <span class="comment">//</span>
00027 <span class="comment">// --------------------------------------------------------------------</span>
00028 <span class="comment">//</span>
<a name="l00029"></a><a class="code" href="classServerMagnitudeRequest.html#b1">00029</a> <span class="keywordtype">void</span> <a class="code" href="classServerMagnitudeRequest.html#b1">ServerMagnitudeRequest::FormatDerivativeData</a>()
00030 {
00031    <a class="code" href="classMutableServerRequest.html#b1">MutableServerRequest::FormatDerivativeData</a>();
00032 
00033    <span class="keywordtype">char</span> _b[20];
00034    sprintf( _b, <span class="stringliteral">"%d\n"</span>, TestValue );
00035 
00036    <a class="code" href="classMutableServerMessage.html#n0">MessageBuffer</a>.append( _b );
00037 }
00038 <span class="comment">//</span>
00039 <span class="comment">// --------------------------------------------------------------------</span>
00040 <span class="comment">//</span>
<a name="l00041"></a><a class="code" href="classServerMagnitudeRequest.html#b2">00041</a> <span class="keywordtype">void</span> <a class="code" href="classServerMagnitudeRequest.html#b2">ServerMagnitudeRequest::ParseDerivativeData</a>()
00042 {
00043    <a class="code" href="classMutableServerRequest.html#b2">MutableServerRequest::ParseDerivativeData</a>();
00044 
00045    <span class="keywordtype">long</span> _index;
00046 
00047    std::string _val;
00048 
00049 
00050    <span class="keywordflow">if</span> ( (_index = <a class="code" href="classMutableServerMessage.html#n0">MessageBuffer</a>.find(<span class="stringliteral">"\n"</span>)) == <a class="code" href="classMutableServerMessage.html#n0">MessageBuffer</a>.npos )
00051    {
00052       <span class="keywordflow">throw</span> <a class="code" href="classworm__exception.html">worm_exception</a>(<span class="stringliteral">"unterminated message while parsing TestValue"</span>);
00053    }
00054 
00055    _val = <a class="code" href="classMutableServerMessage.html#n0">MessageBuffer</a>.substr( 0 , _index );
00056 
00057 
00058    <span class="comment">// Remove this line from the buffer</span>
00059 
00060    <a class="code" href="classMutableServerMessage.html#n0">MessageBuffer</a>.erase( 0 , _index + 1 );
00061 
00062 
00063    <span class="comment">// Set the value</span>
00064 
00065    <a class="code" href="classServerMagnitudeRequest.html#n0">TestValue</a> = atoi( _val.c_str() );
00066 }
00067 <span class="comment">//</span>
00068 <span class="comment">//-------------------------------------------------------------------</span>
00069 <span class="comment">//</span>
<a name="l00070"></a><a class="code" href="classServerMagnitudeRequest.html#a1">00070</a> <span class="keywordtype">void</span> <a class="code" href="classServerMagnitudeRequest.html#a1">ServerMagnitudeRequest::SetTestValue</a>( <span class="keywordtype">int</span> p_value )
00071 {
00072    <a class="code" href="classServerMagnitudeRequest.html#n0">TestValue</a> = p_value;
00073    <span class="comment">/*</span>
00074 <span class="comment">   char _b[20];</span>
00075 <span class="comment"></span>
00076 <span class="comment">   sprintf( _b, "%d", p_value );</span>
00077 <span class="comment"></span>
00078 <span class="comment">   TestValue = _b;</span>
00079 <span class="comment">   */</span>
00080 }
00081 <span class="comment">//</span>
00082 <span class="comment">//-------------------------------------------------------------------</span>
00083 <span class="comment">//</span>
<a name="l00084"></a><a class="code" href="classServerMagnitudeRequest.html#a2">00084</a> <span class="keywordtype">int</span> <a class="code" href="classServerMagnitudeRequest.html#a2">ServerMagnitudeRequest::GetTestValue</a>()
00085 {
00086    <span class="keywordflow">return</span> <a class="code" href="classServerMagnitudeRequest.html#n0">TestValue</a>; <span class="comment">// atoi( TestValue.c_str() );</span>
00087 }
00088 <span class="comment">//</span>
00089 <span class="comment">//-------------------------------------------------------------------</span>
00090 <span class="comment">//</span>
</pre></div><hr><address style="align: right;"><small>Generated on Tue May 6 09:16:04 2003 for Earthworm Libs by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.3-rc3 </small></address>
</body>
</html>
