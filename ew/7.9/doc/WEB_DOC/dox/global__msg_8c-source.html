<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>global_msg.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3-rc3 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>global_msg.c</h1><a href="global__msg_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/*</span>
00002 <span class="comment">**</span>
00003 <span class="comment">*/</span>
00004 <span class="preprocessor">#include &lt;<a class="code" href="global__msg_8h.html">global_msg.h</a>&gt;</span>
00005 <span class="preprocessor">#include &lt;time.h&gt;</span>
00006 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
00007 <span class="preprocessor">#include &lt;string.h&gt;</span>
00008 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
00009 
00010 <span class="comment">/* ---------------------------------------------------------------------- */</span>
00011 
<a name="l00012"></a><a class="code" href="global__msg_8c.html#a0">00012</a> <span class="keywordtype">double</span> <a class="code" href="global__msg_8c.html#a0">DTStringToTime</a>( <span class="keyword">const</span> <span class="keywordtype">char</span> * p_datestring )
00013 {
00014     <span class="keyword">struct </span>tm _timestruct;
00015 
00016     time_t _epochtime; <span class="comment">/* secs since 1/1/1970 */</span>
00017 
00018     <span class="keywordtype">char</span> _wrk[5];
00019 
00020     strncpy( _wrk, p_datestring, 4 );
00021     _wrk[4] = <span class="charliteral">'\0'</span>;
00022     _timestruct.tm_year = atoi(_wrk) - 1900;
00023 
00024     strncpy( _wrk, p_datestring + 4, 2 );
00025     _wrk[2] = <span class="charliteral">'\0'</span>;
00026     _timestruct.tm_mon  = atoi(_wrk) - 1;
00027 
00028     strncpy( _wrk, p_datestring + 6, 2 );
00029     _wrk[2] = <span class="charliteral">'\0'</span>;
00030     _timestruct.tm_mday = atoi(_wrk);
00031 
00032     strncpy( _wrk, p_datestring + 8, 2 );
00033     _wrk[2] = <span class="charliteral">'\0'</span>;
00034     _timestruct.tm_hour = atoi(_wrk);
00035 
00036     strncpy( _wrk, p_datestring + 10, 2 );
00037     _wrk[2] = <span class="charliteral">'\0'</span>;
00038     _timestruct.tm_min  = atoi(_wrk);
00039 
00040     strncpy( _wrk, p_datestring + 12, 2 );
00041     _wrk[2] = <span class="charliteral">'\0'</span>;
00042     _timestruct.tm_sec  = atoi(_wrk);
00043 
00044     _timestruct.tm_isdst = -1;
00045 
00046     _epochtime = mktime(&amp;_timestruct);
00047 
00048 
00049     strncpy( _wrk, p_datestring + 15, 3 );
00050     _wrk[3] = <span class="charliteral">'\0'</span>;
00051 
00052     <span class="keywordflow">return</span> (double)_epochtime + atof(_wrk) / 1000.0;
00053 }
00054 
00055 <span class="comment">/* ---------------------------------------------------------------------- */</span>
00056 
<a name="l00057"></a><a class="code" href="global__msg_8c.html#a1">00057</a> <span class="keywordtype">int</span> <a class="code" href="global__msg_8c.html#a1">TimeToDTString</a>( <span class="keyword">const</span> <span class="keywordtype">double</span> p_time, <span class="keywordtype">char</span> * p_buffer )
00058 {
00059    time_t _ltime = (int)p_time;
00060 
00061    <span class="keyword">struct </span>tm * _tmptr;
00062 
00063    <span class="keywordflow">if</span> ( p_buffer == NULL )
00064    {
00065       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a4">GLOBAL_MSG_NULL</a>;
00066    }
00067 
00068    _tmptr = gmtime( &amp;_ltime );
00069 
00070    sprintf( p_buffer
00071           , <span class="stringliteral">"%04d%02d%02d%02d%02d%02d.%03d"</span>
00072           , _tmptr-&gt;tm_year + 1900
00073           , _tmptr-&gt;tm_mon  + 1
00074           , _tmptr-&gt;tm_mday
00075           , _tmptr-&gt;tm_hour
00076           , _tmptr-&gt;tm_min
00077           , _tmptr-&gt;tm_sec
00078           , ((<span class="keywordtype">int</span>)( p_time * 1000 )) % 1000
00079           );
00080 
00081    <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a3">GLOBAL_MSG_SUCCESS</a>;
00082 }
00083 
00084 
00085 <span class="comment">/* ---------------------------------------------------------------------- */</span>
00086 
<a name="l00087"></a><a class="code" href="global__msg_8c.html#a2">00087</a> <a class="code" href="global__msg_8h.html#a1">GLOBAL_MSG_STATUS</a> <a class="code" href="global__msg_8c.html#a2">EncodeAuthor</a>( <a class="code" href="structMSG__LOGO.html">MSG_LOGO</a>   p_logo
00088                               , <span class="keywordtype">char</span>     * r_buffer
00089                               )
00090 {
00091    <span class="keywordflow">if</span> ( r_buffer == NULL )
00092    {
00093       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a4">GLOBAL_MSG_NULL</a>;
00094    }
00095    sprintf( r_buffer
00096           , <span class="stringliteral">"%03u%03u%03u"</span>
00097           , p_logo.<a class="code" href="structMSG__LOGO.html#m0">type</a>
00098           , p_logo.<a class="code" href="structMSG__LOGO.html#m1">mod</a>
00099           , p_logo.<a class="code" href="structMSG__LOGO.html#m2">instid</a>
00100           );
00101 
00102    <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a3">GLOBAL_MSG_SUCCESS</a>;
00103 }
00104 
00105 <span class="comment">/* ------------------------------------------------------------------------- */</span>
00106 
<a name="l00107"></a><a class="code" href="global__msg_8c.html#a3">00107</a> <a class="code" href="global__msg_8h.html#a1">GLOBAL_MSG_STATUS</a> <a class="code" href="global__msg_8c.html#a3">DecodeAuthor</a>( <a class="code" href="structMSG__LOGO.html">MSG_LOGO</a> * p_logo
00108                               , <span class="keywordtype">char</span>     * r_buffer
00109                               )
00110 {
00111    <span class="keywordtype">char</span> _wrk[4];
00112    <span class="keywordtype">short</span> _value;
00113 
00114    <span class="keywordflow">if</span> ( r_buffer == NULL )
00115    {
00116       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a4">GLOBAL_MSG_NULL</a>;
00117    }
00118 
00119    <span class="keywordflow">if</span> ( strlen( r_buffer ) != 9 )
00120    {
00121       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a8">GLOBAL_MSG_BADPARAM</a>;
00122    }
00123 
00124    strncpy( _wrk, r_buffer, 3 );
00125    _wrk[3] = <span class="charliteral">'\0'</span>;
00126 
00127    <span class="keywordflow">if</span> ( (_value = atoi(_wrk)) == 0 )
00128    {
00129       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a6">GLOBAL_MSG_FORMATERROR</a>;
00130    }
00131 
00132    p_logo-&gt;<a class="code" href="structMSG__LOGO.html#m0">type</a> = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)_value;
00133 
00134 
00135    strncpy( _wrk, r_buffer + 3, 3 );
00136    _wrk[3] = <span class="charliteral">'\0'</span>;
00137 
00138    <span class="keywordflow">if</span> ( (_value = atoi(_wrk)) == 0 )
00139    {
00140       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a6">GLOBAL_MSG_FORMATERROR</a>;
00141    }
00142 
00143    p_logo-&gt;<a class="code" href="structMSG__LOGO.html#m1">mod</a> = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)_value;
00144 
00145 
00146    strncpy( _wrk, r_buffer + 6, 3 );
00147    _wrk[3] = <span class="charliteral">'\0'</span>;
00148 
00149    <span class="keywordflow">if</span> ( (_value = atoi(_wrk)) == 0 )
00150    {
00151       <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a6">GLOBAL_MSG_FORMATERROR</a>;
00152    }
00153 
00154    p_logo-&gt;<a class="code" href="structMSG__LOGO.html#m2">instid</a> = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)_value;
00155 
00156    <span class="keywordflow">return</span> <a class="code" href="global__msg_8h.html#a18a3">GLOBAL_MSG_SUCCESS</a>;
00157 }
00158 <span class="comment">/* ------------------------------------------------------------------------- */</span>
00159 
<a name="l00160"></a><a class="code" href="global__msg_8c.html#a4">00160</a> <span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code" href="global__msg_8c.html#a4">GetGlobalAmpTypeName</a>( AMPLITUDE_TYPE p_type )
00161 {
00162    <span class="keywordflow">if</span> ( p_type &lt; 0 || <a class="code" href="earthworm__defs_8h.html#a45">AMPTYPE_COUNT</a> &lt;= p_type )
00163    {
00164       <span class="keywordflow">return</span> AMPLITUDE_NAMES[<a class="code" href="earthworm__defs_8h.html#a39">AMPTYPE_NONE</a>];
00165    }                       
00166    <span class="keywordflow">return</span> AMPLITUDE_NAMES[p_type];
00167 }
00168 
00169 <span class="comment">/* ---------------------------------------------------------------------- */</span>
00170 
</pre></div><hr><address style="align: right;"><small>Generated on Tue May 6 09:16:02 2003 for Earthworm Libs by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.3-rc3 </small></address>
</body>
</html>
