<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
  <title>Earthworm Modules: ewhtmlemail overview</title>

  
  
  <style type="text/css">/* Style Sheet for ewhtmlemail */

#DataTable {
   font-family: Sans-serif;
   font-size: 12;
   border-collapse: collapse;
}

#DataTable th {
   background-color: #000060;
   color: #DDDDFF;
}

#DataTable tr td {
   background-color: white;
   color: #000060;
}

#DataTable tr.alt td {
   background-color: #DDDDFF;
   color: #000060;
}

#WaveTable {
   font-family: Sans-serif;
   font-size: 10;
   border: 1px solid black;
   border-collapse: collapse;
}

#WaveTable th {
   background-color: #000060;
   color: white;
}

#WaveTable tr.WaveTableTextRowClass td {
   background-color: #DDDDFF;
   color: #000060;
}

#WaveTable tr.WaveTableTraceRowClass td {
   height: 80px;
   vertical-align: top;
}


.TraceClass {
   max-height: 60px;
   height: auto;
   height: 60px;
   max-width: 600px;
   width: auto;
   width: 600px;
}
  </style>
</head><body bgcolor="#ffffff">
<center>
<h1>Earthworm Modules:<br>
ewhtmlemail Overview</h1>
<i>(last revised 12 May 2015)</i></center>

<p>
This module reads
hyp2000arc messages from an input ring and generates html alert emails
containing graphical information on the corresponding earthquake. The
graphical
information included in each html email consists of a google map
containing the
locations of the hypocenters and reporting stations. Additionally, the
program
tries to retrieve the waveforms for the event from one or more
waveservers.
These waveforms are displayed as google charts on the html email.<br>
</p>

<img src="ewhtmlemail_diagram.png">
<p>The figure above shows a
schematic diagram of the information flow when using ewhtmlemail. The
program listens
for HYP2000ARC messages from an input ring (in the example, HYPO_RING).
Incoming
messages are processed to determine hypocenter locations and reporting
stations
as well as determine a suitable time interval for the traces. This
information
is used to request waveform data from a set of waveservers and/or
winston
servers. If available, tracebuf2 data will be processed together with
the
hypocenter information to create an html file. The html includes calls
to the
google maps and google charts APIs to plot a map and a set of traces,
respectively. All html files are stored on a user-defined directory and
named
according to the event ID, as assigned by the binder. If the option to
send
emails is active, ewhtmlemail will add a MIME header to the html file
and call the
commonly available linux email program, <i>sendmail</i>. This will
send an html email
based on the created file.
</p>

<p>
Note that the generated emails do not include graphical attachments
such as png or jpg images.
The email contents if only text-based and graphics are provided by the
calls to the google APIs.
As a consequence, visualization of the alert emails requires an email
client with html
capability and an Internet connection.
</p>

<p> Alternatively, the user may disable the email
alerts. In this case, ewhtmlemail will not add the MIME header to the
html
files. This option is available for usage with a third party webserver
(e.g. Apache)
to monitor the events folder and publish the event information on the
web.
<br>
<br>
ewhtmlemail may also be
used with events detected with the Carl Johnson coincidence triggers
(TRIGLIST_SCNL
messages) converted using <i>trig2arc</i>.</p>

<p>As of version "1.0.72 - 2014-08-15" ewhtmlemail can detect and use
magnitude messages generated by the localmag module (if the 'UseML'
command is specified).<br>
</p>

<p> The
figure below shows an example of the html generated by this module.
<br>
</p>

<table style="border: 1px solid black;">

  <tbody>
    <tr>
      <td>
      <table id="DataTable">
        <tbody>
          <tr>
            <th>Location</th>
            <th><br>
            </th>
          </tr>
          <tr>
          </tr>
          <tr class="alt">
            <td>Origin time</td>
            <td>2011.07.05 01:18:24</td>
          </tr>
          <tr>
          </tr>
          <tr>
            <td>Latitude</td>
            <td> 0.0000</td>
          </tr>
          <tr>
          </tr>
          <tr class="alt">
            <td>Longitude</td>
            <td> -0.0000</td>
          </tr>
          <tr>
          </tr>
          <tr>
            <td>Depth</td>
            <td> 0.0</td>
          </tr>
          <tr>
          </tr>
          <tr class="alt">
            <td>Pref. Magnitude</td>
            <td> 0.0</td>
          </tr>
          <tr>
          </tr>
        </tbody>
      </table>
      <br>
      <br>
      <img class="MapClass" alt="" src="http://maps.google.com/maps/api/staticmap?size=600x400&amp;format=png8&amp;maptype=hybrid&amp;sensor=false&amp;markers=icon:http:%2F%2Fmaps.google.com%2Fmapfiles%2Fkml%2Fshapes%2Fplacemark_circle.png%7Cshadow:false%7C38.469140,-28.462350%7C38.626870,-28.710740%7C38.590950,-28.630670%7C38.514410,-28.507010">
      <br>
      <br>
      <table id="WaveTable">
        <tbody>
          <tr>
            <th>Waveforms</th>
          </tr>
          <tr class="WaveTableTextRowClass">
            <td> PCND.EHZ.CP.--</td>
          </tr>
          <tr class="WaveTableTraceRowClass">
            <td><img class="TraceClass" alt="" src="http://chart.apis.google.com/chart?chs=600x61&amp;cht=ls&amp;chxt=x&amp;chxl=0:%7CP&amp;chxp=0,38&amp;chxtc=0,-600&amp;chco=000060&amp;chma=0,0,0,0&amp;chls=2&amp;chd=s:eqamViVlXbkYpUjZlWenYiapaoWYsUkUpXnUZkWpUkVkUXlWoVkXmZalYlZmToUTgXjZkWkZZkWlQnZnXalalVpWiWXlXnWkXkWZmWiToVkemMiJmUiWazSjXhUnZYiYjViXkXYlYjUmalVZlWmYnXnValYqUkViZYlVgToZlWanWjXkUjTZjVkYnalUZiWoYkWkNSlWnXoZlQYjWmZkYiYkVgWkUkYeoUiVkWmUbnWlYkVsVZjUmWnWiVblYmTjVoTWoKoJnIwMP1MzA5RxGTrPnHnQyLRuOpWlXqSUrUnDoQoSVnVpUlTlbLwRnamVlQOnXnUlTnamZnOkZlVZoSmUmRoVbkYjWnXpWYkVmSpWnVbnVhWmZlYWhRlQlYqVbnXhTmXnZUmYmWjVnYajXiYoYoVbnXlalXjVVmXnVpZkWakQiZnUkdlTjYjWibekMjYmboVXlWjZkZnWVnWlTnVhNNjZnXqYiQXnUmSnYjTWmWhXnaoTYlYiXnWlTZiWnZkWlVXnWnYmXhVXlWjWkVlUalZmSrXiembmUlYlQVnXpVjWnUVlYjRhXlWWmYlWlRhSVjUlXnTnYZiWoUkUlWYmXnWkYkTUlWmYhNjZZnZkVoWjUWnZmRjWjYSlamXlYpWOnXkTiYncmXqUkWlWemVkYkVqSepZhXnXjNbnZkVkYmTeeeeeeeeeeeee"></td>
          </tr>
          <tr class="WaveTableTextRowClass">
            <td> PCUT.EHZ.CP.--</td>
          </tr>
          <tr class="WaveTableTraceRowClass">
            <td><img class="TraceClass" alt="" src="http://chart.apis.google.com/chart?chs=600x61&amp;cht=ls&amp;chxt=x&amp;chxl=0:%7CP&amp;chxp=0,34&amp;chxtc=0,-600&amp;chco=000060&amp;chma=0,0,0,0&amp;chls=2&amp;chd=s:dfcgcfcfcchcfcgbgccgafbgcfbcfagYhcgbagbgbfcfbbgchcgbgbbgbgchbfbcgbgbicicchbgbfbfbbgaibgbfbcfbgbhchdbgbgbfagdgcfagcgcbfcfbgchbbfagcfbfbbfbfcfafccgbfbgbgbcgbfbgcgbcgbfbfcfabfbgagbfacgbfchafbafcgafcgbbgbgbgbfbcgahagbhegbgbgbhcdgbgbgWiaalUtApU2PXwToVlUlYbjYkZiZiXchbhagZhZbibhahagbbhagbhagZcgZhbgbgbaiahahbgbchbgaibfbcfbgbhbfacgcfbgbgdgbfbgbfbcfbgbfbgbbgcfafcgbcgcgcgbfcchbfahbfabhbgXgbgcbfbgZgcgbbgbibfbgbahbgcgbfbcfbgcfbgbbfbhcgbgcbgbhahbgdgbfbfcgccfcgbgbfbchbgcfbgccfbhcgbgbcgbhbhbfbbfbfafbgbbgchbfbfacgbhbjagbagafbibgbbhcgbhagbchbhbhbhbaeafcfbhehbgcgbgbcgcgcgbgcdhbgbgcgbbgbgbibhcbgbgcfbfcchcfcgbgbcgZgafcgcchbfcgchacgcfcgbfbcgbfagbfcbgcgbhcfbeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee"></td>
          </tr>
          <tr class="WaveTableTextRowClass">
            <td> PLGR.EHZ.CP.--</td>
          </tr>
          <tr class="WaveTableTraceRowClass">
            <td><img class="TraceClass" alt="" src="http://chart.apis.google.com/chart?chs=600x61&amp;cht=ls&amp;chxt=x&amp;chxl=0:%7CP&amp;chxp=0,36&amp;chxtc=0,-600&amp;chco=000060&amp;chma=0,0,0,0&amp;chls=2&amp;chd=s:bhWhZiZlaejZgZjaiXbjZiajYhaajZjYlZgXXhajZiXiZViZjZhZhYXkWgXibjaXhajalbjZYiajaiZhZbiVkajViZZjZiZjakZZjWhZiZhajZhakciZaiakZjYkZYiWiahWiYbiaiajZiabhahZlakZZjZgaiYiaZgWlXiZiaZiaiXhakTYgZmZiahYbkUjYiYgaaiakYiYkWZiahXiZkekXhZjahaeiYhajZiaclYiYkYlZUnRmFwJyMAqOnRqVoXXlVjXjVlUbiUlWjZjYXmXiWibjWajZkagWhaZhZgYjbkVahYiagZiZYjYhWiajZaiXiZjVhcjajaiZhaZiWjZiYiXahZkajZhXZiYkaibiYajYkZhWiaajZlVhXkaciakZiYhaYjZkWiahZZiViZjakXYjZiYkajcbiXiYkYhZajYhXibhajZjaiahXbiaiXiXjYXkaiYiakXZhXjWhSiabiTiZkWiYYiYiajXjZbkZiZgWjabjYgZiZiZaibhajZgYbjXiXjXjaakYiZiaiZaiaiZiZiciYhaiahabkZhZiZiYYiZiYgaiYamYhbhYiXdlXhaiYjZbiaibiahZZiXhWhZjabhZhbhZjVajWiaiZhZZkYhYjYhXVkXgZjaiZeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee"></td>
          </tr>
          <tr class="WaveTableTextRowClass">
            <td> PMAD.EHZ.CP.--</td>
          </tr>
          <tr class="WaveTableTraceRowClass">
            <td><img class="TraceClass" alt="" src="http://chart.apis.google.com/chart?chs=600x61&amp;cht=ls&amp;chxt=x&amp;chxl=0:%7CP&amp;chxp=0,38&amp;chxtc=0,-600&amp;chco=000060&amp;chma=0,0,0,0&amp;chls=2&amp;chd=s:ejajXiZhaaiahbhYgZbhbgZibgZbgbgYhcgaaiXhZhahbbhbgbhahabgZhaiakaZiahVibhZYhahcjXhZajZgbjZgbbkbhYgYhabiahahXheiYiZhahbdiagagZhaZjahbjaiXdhbgahZjaagZhajagZaiZhYhagZagZichagYYjYhahZhbahbhbhaeZZiYjZiZjaahahaiajWakahZiZieiXgbhbiZejaiXhZiXZiZiakZgXciXiaibjYekZgaiUiZYjU1AzHnFOxQjTtWqPWoUkViXmXYiWnYiZlZXiZjYjZhXciXgakcibbhZhbiZgaajaiZhVhbhbiZiYiZZibiahbhbbhahZiaibcibjZibgZZiahZiZhbchXgYhZlZbhahahahZagakbfbiYahYiajXfabkahYjZhYagYibiZiZZiYhaiahdhajZgagabjZhZhaiXagZjajZhZbjbhYiYgaahZhahahZahaibiZiZaiaiZhZgabiagaibhYYhZhYjbhaahZjYibgabkbhagZiYbiciZfZiaiagZgaibbgYfahZibZgYgbiaibViciagZgYbhZhahbiYahagbiXhabgXiaiZhablahahafYajahahZhYagYjbhbhaagXjclZgYeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee"></td>
          </tr>
        </tbody>
      </table>
      </td>
    </tr>
  </tbody>
</table>

<p>
The above figure shows the general aspect of the html emails using the
default settings.
However, some aspects of the generated html email can be controlled by
changing a .css configuration file.
This allows the setting of options such as the colors, fonts and sizes of the
different elements.
</p>

<p>
ewhtmlemail has been written by Ruben S. Luis, Center of Volcanology
and Geological Risks Assessment,
University of the Azores. Great ideas (such as the phase indication) and testing have been
contributed by Jean-Marie Saurel, from OVSM/IPGP.<br>
</p>


<center> <a href="../modules.html">Module Index</a> | <a href="../cmd/ewhtmlemail_cmd.html">ewhtmlemail Commands</a>
</center>

<br>

<!-- USGS-required stuff at the end -->
<hr>
<address>&nbsp;<b>
<address>Questions? Issues? <a href="http://groups.google.com/group/earthworm_forum?hl=en" target="_blank">Subscribe to the Earthworm Google Groups List. </a></address>
</b><br>
</address>

</body></html>