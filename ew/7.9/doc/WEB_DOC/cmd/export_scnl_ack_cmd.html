<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>Earthworm Modules: Export_scnl_ack commands</title>
</head>
<body style="color: rgb(0, 0, 0); background-color: rgb(250, 223, 175);"
 alink="#ff0000" link="#0000ee" vlink="#551a8b">
<center>
<h1><br>
Export_scnl_ack Configuration File </h1>
<i>(last revised 1 June 2006)</i></center>
<p>
</p>
<h2>1. EXAMPLE CONFIGURATION FILE</h2>
<pre>#<br># export_scnl_ack configuration file<br>#<br># Export_scnl_ack expects to receive an acknowledgment packet for every<br># packet that is writes to socket. It keeps a SendQueue of messages it has<br># sent and their status. The SocketSend thread will not re-use a slot in<br># its SendQueue until the SocketRecv thread has marked that slot as ACKed.<br>#<br># Import/Export send heartbeats to each other, as well as into their<br># local earthworm systems. If the socket heartbeat from the distant partner<br># is not received whithin the expected time period (RcvAliveInt) the link is<br># terminated, and an attempt to reconnect is initiated. If things go<br># seriously wrong, the heartbeat into the local earthworm system in<br># stopped. The expectation is that "restartMe" has been set in the .desc<br># file, and we'll be killed and restarted.<br>#<br># Socket heartbeats are not put in either the message stacking queue<br># or in the SendQueue, so they do not take up precious space when<br># the connection between import/export is down.<br>#<br># All socket operations are performed with a timeout. This is noramlly<br># defaulted, but can be set in this file (SocketTimeout).<br>#<br># Export maintains a circular FIFO buffer of messages to be shipped. <br># Let's call this the MessageStacking queue. The depth of this queue <br># (RingSize) controls the maximum latency of the data.<br>#<br>#<br># Configuration notes:<br>#<br># "restartMe" should be uncommented in my .desc file.<br>#<br># The period of our local heartbeat (HeartBeatInt) must be safely smaller<br># (faster) than our advertised period in our .desc file (tsec:).<br># Otherwise we'll get continually restarted for no good reason.<br># Note that tsec:0 implies no heartbeats expected, and so we'll never get<br># restarted.<br>#<br># The rate at which we send socket heartbeats to our distant partner should<br># be considerably faster than the rate at which our partner expects them.<br># Otherwise, a heartbeat delayed in transmission will cause our partner to<br># conclude that the link is broken, and cause them to break the link and<br># reinitialize. Which will cause us to do the same.<br>#<br># For export, the ServerIPAdr is the address of the port to be used in<br># the exporting machine.  This is to specify a network card case the<br># exporting machine has several network cards.  <br># Using ServerIPAdr 0.0.0.0 will allow export to answer connections<br># on any valid address of the machine.<br>#<br># If SocketTimeout is specified, it should be at least as large as the<br># expected period of heartbeats from our distant partner.<br><br># Basic Earthworm setup<br>#----------------------<br> MyModuleId     MOD_EXPORT_SCNL_ACK # module id for this program<br> RingName       PICK_RING           # transport ring to use for input/output<br> HeartBeatInt   30                  # EW internal heartbeat interval (sec)<br>                                    #   Should be &gt;= RcvAliveInt<br># Logging Control<br>#----------------<br> LogFile        1      # If 0, don't write logfile<br>                       #    1, write to logfile and stdout<br>                       #    2, write to module log but not stderr/stdout<br>#Verbose               # If uncommented, VERY LARGE logfiles will be <br>                       #   generated with info about queue status of <br>                       #   each msg, socket alive msgs sent &amp; received.<br><br># Logos of messages to export to client systems.<br>#------------------------------------------------<br># Installation and Module can be wildcards.<br># Knows how to decipher these message types:<br>#  w/  location code: TYPE_TRACEBUF2, TYPE_TRACE2_COMP_UA, <br>#                     TYPE_PICK_SCNL, TYPE_CODA_SCNL<br>#  w/o location code: TYPE_TRACEBUF, TYPE_TRACE_COMP_UA,<br>#                     TYPE_PICK2K, TYPE_CODA2K msgs<br>#<br>#              Installation       Module       Message Type<br>#--------------------------------------------------------------<br> GetMsgLogo    INST_UNKNOWN    MOD_WILDCARD     TYPE_TRACEBUF2<br><br># Set up Message Queues <br># Note: socket "alive" messages are not put in either queue<br>#---------------------------------------------------------- <br> MaxMsgSize             4096   # maximum size (bytes) for input/output msgs<br> RingSize                200   # number of msgs in MessageStacking queue.<br>                               #  (msgs waiting to be sent to socket)<br> SendQueueLength         100   # Optional command: #msgs in SendQueue<br>                               #  (msgs sent, acknowledgments pending)<br>                               #  Valid range: 1-254 (default 100) <br>                               #  shipped on export restarts.<br>#MaxLatency               60   # Optional command: Packets with delay time<br>                               #  (i.e., time between present and packet<br>                               #  start time) greater than this amount will be<br>                               #  filtered out. Time is in minutes.  0 -&gt; time<br>                               #  is not checked. System time must be accurate.<br>                               #  Only works on waveform messages.<br> <br># Set up server/client communications<br>#------------------------------------<br> ServerIPAdr  aaa.bbb.ccc.dd   # Listen for connections on this IPaddress.<br>                               #  0.0.0.0 will use any address on machine.<br> ServerPort            16005   # Well-known port number to export msgs on<br><br> SendAliveText      ExpAlive   # string sent to client as heartbeat<br> SendAliveInt             30   # seconds between alive msgs sent to client.<br>                               #  0 =&gt; no heartbeat<br> RcvAliveText       ImpAlive   # text of client's heartbeat (we get this)<br> RcvAliveInt              60   # seconds between client's heartbeats to us.<br>                               #  0 =&gt; no heartbeat<br><br># Optional Socket commands:<br># SocketTimeout defaults to RcvAliveInt + 3 <br>#  If set to -1, all socket calls will block (no timeout).<br>#  SocketTimeout has no effect in export, unless it is set to -1,<br>#  because there is no code in export to handle socket timeouts.<br>#  If set to -1, the program may run slightly more efficiently because<br>#  timeout checking code will not execute.<br>#----------------------------------------------------------------------<br>#SocketTimeout 200000  # Timeout length in milliseconds for socket calls<br><br> SocketDebug   0       # if 1, socket_ew debug statements are logged<br>                       # if 0, socket_ew debug is turned off (default)<br><br># List of station/channel/network/loc codes to export.<br>#--------------------------------------------------------<br># NOTE: Send_scn and Send_scn_remap commands are now obsolete, and <br># have been replaced with Send_scnl and Send_scnl_remap (which <br># include the location code field).  If the old commands are used, <br># export_scn sets the location code field to * (wildcard).<br>#<br># Use any combination of Send_scnl (to send data as-is) and <br>#   Send_scnl_remap (to change the SCNL on the fly) commands.<br># Use * as a wildcard for any field. A wildcard in the<br>#   "map to" fields of Send_scnl_remap means that field will<br>#   not be renamed.<br>#--------------------------------------------------------<br>#                  send SCNL     map to SCNL<br> Send_scnl       JMP ASZ NC 01                # send this specific channel<br> Send_scnl       JPS *   NC *                 # send all components of JPS NC<br> Send_scnl_remap JGR VHZ NC --   *   EHZ * *  # change component code only<br> Send_scnl_remap CAL *   NC *    ALM *   * *  # send all component of CAL, but<br>                                              # change the site code to ALM<br><br></pre>
<center><a name="suggest"> </a><a href="../modules.html">Module Index</a>
| <a href="../ovr/import-export_ovr.html#export_ack">Export_scnl_ack
Overview</a>
</center>
<!-- USGS-required stuff at the end -->
<hr>
Contact: <b><address> Questions? Issues? <a href="http://groups.google.com/group/earthworm_forum?hl=en" target="_blank">Subscribe to the Earthworm Google Groups List. </a></address></b><br>
</address>
</body>
</html>
