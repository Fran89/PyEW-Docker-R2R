<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
<HEAD>
	<TITLE>Earthworm Modules: Gmew Commands</TITLE>
</HEAD>
<BODY TEXT="#000000" LINK="#0000ee" VLINK="#551a8b" BGCOLOR="#fadfaf">
<H1 ALIGN=CENTER>Earthworm Modules: <BR>Gmew Configuration File 
</H1>
<P ALIGN=CENTER STYLE="margin-bottom: 0in"><I>(last revised 10 June,
2001)</I></P>
<P>Page Index:
<OL>
<li><A HREF="#function">Functional command listing</A>
<li><A HREF="#alphabet">Alphabetic command listing &amp; description</A>
<li><A HREF="#sample_config">Sample Configuration File</A>
</ol>
<P>On startup, gmew reads commands from a configuration file. Commands in this file set all the parameters for configuring the Earthworm gmew module.
In the control file, lines may begin with a valid gmew command 
(listed below) or with one of 2 special characters: 
</P>
<PRE STYLE="margin-left: 0.39in; margin-right: 0.39in">#  marks the line as a comment (example: # This is a comment).
   
@  allows control files to be nested; one control file can be 
   accessed from another with the command &quot;@&quot; followed by 
   a string representing the path name of the next control file 
   (example: @model.d).</PRE><P>
Command names must be typed in the control file exactly as shown in
this document (upper/lower case matters!). Blank lines are also
permitted in the control file. 
</PRE>

<H2><A NAME="function"></A>1. FUNCTIONAL COMMAND LISTING</H2>
<div align=center>
<Table cols=3 width=80%>
<TR>
<TH colspan=2 align=left> Earthworm system setup:</th>
<tr><td align=center><A HREF="#MyModuleId">MyModuleId</A>     <td>Required</td>
<tr><td align=center><A HREF="#RingInName">RingInName</A>         <td>Required</td>
<tr><td align=center><A HREF="#RingOutName">RingOutName</A>         <td>Required</td>
<tr><td align=center><A HREF="#getEventsFrom">getEventsFrom</A>
<td>Required</td>
<tr><td align=center><A HREF="#HeartBeatInterval">HeartBeatInterval</A>
<td>Required</td>
<tr><td align=center><A HREF="#logSwitch">log switch</A>
                       <td>Optional</td><td></td>

<tr><th colspan=2 align=left>Memory allocation commands</th>
<tr><td align=center><A HREF="#maxSta">maxSta</A>             <td>Required</td>
<tr><td align=center><A HREF="#maxTrace">maxTrace</A>         <td>Required</td>

<tr><th colspan=2 align=left>Event and Trace commands</th>
<tr><td align=center><A HREF="#traceSource">traceSource</A>
                     <td>Optional</td><td>-t</td>
<tr><td align=center><A HREF="#traceTimes">traceTimes</A>     <td>Optional</td>
<tr><td align=center><A HREF="#Add">Add</A>                   <td>Optional</td>
<tr><td align=center><A HREF="#Del">Del</A>                   <td>Optional</td>
<tr><td align=center><A HREF="#maxDist">maxDist</A>           <td>Required</td>
<tr><td align=center><A HREF="#saveTrace">saveTrace</A>
                    <td>Optional</td>
<tr><td align=center><A HREF="#searchWindow">searchWindow</A> <td>Optional</td>

<tr><TH colspan=2 align=left>Auxiliary Data Sources</TH>
<tr><td align=center><A HREF="#respSource">respSource</A>     <td>Optional</td>
<tr><td align=center><A HREF="#staLoc">staLoc</A>             <td>Required</td>
<tr><td align=center><A HREF="#velocity">velocity model</A>   <td>Optional</td>
<tr><td align=center><A HREF="#SCNpar">SCNpar</A>             <td>Optional</td>

<tr><TH colspan=2 align=left>Miscellaneous Commands</TH>
<tr><td align=center><A HREF="#Debug">Debug</A><td>Optional</td>
<tr><td align=center><A HREF="#wsTimeout">wsTimeout</A>       <td>Optional</td>
<tr><td align=center><A HREF="#XMLDir">XMLDir</A>       <td>Optional</td>
<tr><td align=center><A HREF="#TempDir">TempDir</A>       <td>Optional</td>
<tr><td align=center><A HREF="#MappingFile">MappingFile</A>       <td>Optional</td>

</table></center>
<p>

<H2><A NAME="alphabet"></A>2. ALPHABETIC COMMAND LISTING &amp; DESCRIPTION</H2>

<P>In the following section, all configuration file commands are
listed in alphabetical order. Listed along with the command
(bold-type) are its arguments (in red.) A detailed description of the command
and is also given. Default values and example commands are listed after each
command description. 
</P>

<TABLE cols=2>
<TR><TD>command <FONT COLOR="#ff0000">arg1</FONT><TD>  function</TR>
<TR><TD colspan=2><HR></td>

<TR><TD><A NAME="Add"></A>Add <FONT COLOR="#ff0000">STA COMP NET</FONT>
                           <TD>Event and Trace Commands</TR>

<TR><TD colspan=2><ul>Add the trace(s) with station name <FONT
 COLOR="#ff0000">STA</FONT>, component name <FONT COLOR="#ff0000">COMP</FONT>
 and network name <FONT COLOR="#ff0000">NET</FONT> to the selection list. Any
 of STA, COMP and NET may be the wildcard character `*'. COMP may be given as
 the first two letters of the component name, to select all direction
 desgnators (North and East) are accepted for that component. Zero, one or
 many Add commands may be listed in the configuration file. If no Add
 commands are given, all SCNs from the trace source
 will be selected. The <A HREF="#Del">Del</A> command may be used to narrow
 the selection implied by wildcard values in an Add command or by the absence
 of any Add commands.</UL></TR>
<TR><TD colspan=2><PRE STYLE="margin-left: 0.39in; margin-right: 0.39in">
Default: all traces are selected from a trace source
Example: Add * BH *
         Add SEA EH UW</PRE>
<HR></TR>



<TR><TD><A NAME="Debug"></A>Debug <FONT
COLOR="#ff0000">D</FONT><TD>Miscellaneous Commands</TR>
<TR><TD colspan=2><ul>Set the debug level to <B>D</B>.
There are many different debug options; one or more of them may be activated
using the Debug command. More than one Debug command may be used, or the
different values (from the table) may be added together into one Debug
command. Except as noted, the debug information is printed to STDERR and the
log file (depending on the setting of <A HREF="#logSwitch"> log switch</A>.)
Select from these debug options:
<dl>
   <dt><FONT COLOR="#ff0000">1</FONT>:
   <dd>trace and search times and P and S arrival estimates (relative to event
   origin time)

   <dt><FONT COLOR="#ff0000">2</FONT>:
   <dd>SCN selection tests

   <dt><FONT COLOR="#ff0000">16</FONT>:
   <dd>ws_client debugging

   <dt><FONT COLOR="#ff0000">32</FONT>:
   <dd>poles. zeros and gain values

   <dt><FONT COLOR="#ff0000">64</FONT>:
   <dd>trial frequency response functions to STDOUT. Produces about 1500 lines
   for each SCN, which should be saved to a file.

   <dt><FONT COLOR="#ff0000">128</FONT>:
   <dd>full frequency response function to STDOUT. Produces several thousand
   lines for each SCN, which should be saved to a file.

   <dt><FONT COLOR="#ff0000">256</FONT>:
   <dd>Input and output trace data including in padded arear to
   STDOUT. Produces several thousand lines for each SCN, which should be saved
   to a file. 
</dl></ul></tr>
<TR><TD colspan=2><PRE STYLE="margin-left: 0.39in; margin-right: 0.39in">
Default: 0; no debug output
Example: Debug 3 # turns on options 1 and 2</PRE>
<HR></TR>

<TR><TD><A NAME="Del"></A>Del <FONT COLOR="#ff0000">STA COMP NET</FONT>
                           <TD>Event and Trace Commands</TR>

<TR><TD colspan=2><ul>Delete the trace(s) with station name <FONT
 COLOR="#ff0000">STA</FONT>, component name <FONT COLOR="#ff0000">COMP</FONT>
 and network name <FONT COLOR="#ff0000">NET</FONT> from the selection list. Any
 of STA, COMP and NET may be the wildcard character `*'. COMP may be given as
 the first two letters of the component name, to select all direction
 desgnators (Vertical, North and East) are accepted for that component.  Zero, one or
 many Del commands may be listed in the configuration file. </UL></TR>
<TR><TD colspan=2><PRE STYLE="margin-left: 0.39in; margin-right: 0.39in">
Default: all traces are selected from a trace source
Example: Del SEA BH UW</PRE>
<HR></TR>

<TR><TD><A NAME="getEventsFrom"></A>getEventsFrom <FONT COLOR="#ff0000">INST MOD</FONT><TD>  Earthworm Setup</TR>
<TR><TD colspan=2><ul>Get event messages (TYPE_HYP2000ARC) from installation
<FONT COLOR="#ff0000">INST</FONT> and module <FONT COLOR="#ff0000">MOD</FONT>.
These installation and module IDs are found in earthworm.d and
earthworm_global.d. Use as many <B>getEventsFrom</B> commands as necessary.</ul>
<TR><TD colspan=2><PRE STYLE="margin-left: 0.39in; margin-right: 0.39in">
Default:  none
Example:  getEventsFrom INST_WILDCARD MOD_EQPROC</PRE>
<HR>
</tr>

<TR><TD><A NAME="HeartBeatInterval"></A>HeartBeatInterval <FONT COLOR="#ff0000">H</FONT><TD>  Earthworm Setup</TR>
<TR><TD colspan=2><ul>Send TYPE_HEARTBEAT messages every <FONT
COLOR="#ff0000">H</FONT> seconds to the transport ring. 
<TR><TD colspan=2><PRE STYLE="margin-left: 0.39in; margin-right: 0.39in">
Default:  none
Example:  HeartbeatInterval 30</PRE>
<HR>
</tr>


<TR><TD><A NAME="logSwitch"></A>log switch: 
<code>-l<FONT COLOR="#ff0000">S</FONT></code><td>Earthworm Setup</TR>
<TR><TD colspan=2><ul>This is not a config-file command but a command line switch
Sets the value of the logging switch to <FONT COLOR="#ff0000">S</FONT>.
Possible values of S are:
<dl>
  <dt><FONT COLOR="#ff0000">0</FONT>:
  <dd>Do not create a log file. Some logging data will be printed to the
  screen (stdout or stderr.)
  <dt><FONT COLOR="#ff0000">1</FONT>:
  <dd>Create a log file in the directory named by the EW_LOG environment
  variable. The log file name will based on the config-file name and the
  current data. A new file will be created for each day (but only if there are
  logging entries to be made.) Some logging data will be printed to the
  screen (stdout or stderr,) as with option `0' above.
  <dt><FONT COLOR="#ff0000">2</FONT>:
  <dd>Create a log file as for option `1', but do not write anything to the
  screen (stdout or stderr.)
</dl></ul>
<PRE STYLE="margin-left: 0.39in; margin-right: 0.39in">
Default: 1
Example (on the command-line):  -l0 (lower-case ell zero; turns off creation of
        log file)</PRE>
<HR></TR>

<TR><TD><A NAME="MappingFile"></A>MappingFile <FONT
COLOR="#ff0000">map-file</FONT><TD>Miscellaneous Commands</TR>
<TR><TD colspan=2><ul>Specifes that name of a mapping file for use in writing
XML files (see <A HREF="#XMLDir">XMLDir</A>). This file provides for three
different mappings: from station-net codes (used in SCN) to descriptive
station names; from net codes to descriptivce agency names, and from
station-component-network codes to instrument type. See the file NCSN.map in
the gmew source distribution for an example of this file. This file is not
required by gmew, and the descriptivce names are not required by
shakemap.</ul> 
<PRE STYLE="margin-left: 0.39in; margin-right: 0.39in">
Default: no mapping file if this command is not given
Example: MappingFile NCSN.map</PRE>
<HR></TR>

<TR><TD><A NAME="maxSta"></A>maxSta <FONT
COLOR="#ff0000">N</FONT><TD>Memory Allocation</TR>
<TR><TD colspan=2><ul>At startup, gmew will allocate space for <FONT
COLOR="#ff0000">N</FONT> individual stations (unique station/network names.)
Each station may have any number of different components (BHE/BHN/HHE/HHN.) If
gmew tries to read more than <B>N</B> stations, the excess ones will be
skipped with a logged warning message. The order that stations are read into
gmew is determined by the trace source and thus
may be arbitrary.</ul>
<PRE STYLE="margin-left: 0.39in; margin-right: 0.39in">
Default: none, this command is required.
Example: maxSta 100</PRE>
<HR></TR>

<TR><TD><A NAME="maxTrace"></A>maxTrace <FONT
COLOR="#ff0000">M</FONT><TD>Memory Allocation</TR>
<TR><TD colspan=2><ul>Allocate memory for <FONT COLOR="#ff0000">M</FONT
data samples to process for one trace. This is the product of the trace length
in seconds and the highest expected sample rate. For example, 10 minutes of
data at 100 samples per second gives 60000 samples. The time duration of
traces used by gmew is determined by the <A
HREF="#traceTimes">traceTimes</A> command and the estimated P and S phase
arrival times.</ul>
<PRE STYLE="margin-left: 0.39in; margin-right: 0.39in">
Default: none, this command is required
Example: maxTrace 60000</BRE>
<HR></TR>

<TR><TD><A NAME="MyModuleId"></A>MyModuleId <FONT
COLOR="#ff0000">mod_id</FONT><TD>Earthworm setup</TR>
<TR><TD colspan=2><ul>Sets the module id for labeling
all outgoing gmew, heartbeat, and error messages. <FONT
COLOR="#ff0000">mod_id</FONT> is a character string (valid strings are listed
in earthworm.d) that relates to a unique single-byte number. In general, a
different module ID is needed for each instance of gmew. 
</ul>
<PRE STYLE="margin-left: 0.39in; margin-right: 0.39in">
Default: none
Example: MyModuleId MOD_LOCALMAG</PRE>
<HR></tr>

<TR><TD><A NAME="respSource"></A>respSource <FONT COLOR="#ff0000">SOURCE [params]</FONT>
<TD>Auxilliary Data Sources</TR>
<TR><TD colspan=2><ul>Tells gmew where to find instrument response
data. This command is required. Choices
for <B>SOURCE</B> are:
<dl>
  <dt><FONT COLOR="#ff0000">FILE dirname pz-filename-format</FONT>

  <dd>find response files in the <B>dirname</B>
  directory. <B>pz-filename-format</B> is a string similar to the printf
  format: %S, %C, %N are replaced by station, component and network names,
  respectively, all in upper case. Similarly %s, %c, %n work for lower-case
  station, component and network. The digraph %% stands for %; all other
  characters are taken literally.  <p>The response file format is similar to
  that used by SAC POLEZERO files with some extra requirements. The options in
  the file are keyword driven and the numbers are in free format.  You may
  specify a multiplicative scaling constant by putting a line in the file
  containing the keyword "CONSTANT" followed by a floating point number.  The
  default for this constant is 1.0 if you omit this line.  You specify the
  number of poles by putting a line in the file with the keyword "POLES"
  following by an integer number.  The next lines in the file until another
  keyword is read become the poles for this instrument.  Each such line
  contains two floating point numbers specifying the real and imaginary parts
  of one of the poles.  If you have fewer lines specifying poles than you
  stated on the "POLES" line, the remaining poles are assumed to lie at the
  origin.  You specify the zeros in the same way with a "ZEROS" keyword line
  following by lines specifying the zeros that do not lie at the origin.  You
  may specify up to as many poles and zeros as you need.  <p>The poles, zeros
  and gain constant of the response file <B>MUST</B> be for an input of
  displacement in nanometers. See the <A
  HREF="http://seismo.ethz.ch/autodrm/autodrm_doc.html">documentation</A>
  provided by the NEIC AutoDRM for more details. The poles and zeros specify
  the Laplace transform of the analogue instrument response. Currently gmew
  has no provision for handling digital FIR or IIR filter responses.  For
  example, the following is the specification for the NSN broadband
  seismometer OCWA.BHE.US:
 
<PRE><BLOCKQUOTE>
CONSTANT    0.50280E+11
ZEROS       3
        0.00000E+00    0.00000E+00
        0.00000E+00    0.00000E+00
        0.00000E+00    0.00000E+00
POLES       6
       -0.31420E-01    0.00000E+00
       -0.19790E+00    0.00000E+00
       -0.20110E+03    0.00000E+00
       -0.69740E+03    0.00000E+00
       -0.75400E+03    0.00000E+00
       -0.10560E+04    0.00000E+00
</BLOCKQUOTE></PRE>

  <dt><FONT COLOR="#ff0000">EWDB</FONT>
  <dd>Query an Earthworm Database for reponse information. Not currently
  implemented. 

</dl></ul>
<PRE STYLE="margin-left: 0.39in; margin-right: 0.39in">
Default: none
Example: File /earthworm/responses %S_%C_%N.pz</PRE>
<HR></TR>

<TR><TD><A NAME="RingInName"></A>RingInName <FONT COLOR="#ff0000">ring</FONT> 
<TD>Earthworm setup</TR>
<TR><TD colspan=2><ul>Tells gmew which shared
memory region to use for input transport. <FONT COLOR="#ff0000">ring</FONT> is
a character string (valid strings are listed in earthworm.d) that
relates (in earthworm.d) to a unique number for the key to the shared
memory region. Gmew reads TYPE_HYP2ARC messages from this ring.</ul>
<PRE STYLE="margin-left: 0.39in; margin-right: 0.39in">
Default:  none
Example:  RingInName HYPO_RING</PRE>
<HR></TR>

<TR><TD><A NAME="RingOutName"></A>RingOutName <FONT COLOR="#ff0000">ring</FONT> 
<TD>Earthworm setup</TR>
<TR><TD colspan=2><ul>Tells gmew which shared
memory region to use for output transport. <FONT COLOR="#ff0000">ring</FONT> is
a character string (valid strings are listed in earthworm.d) that
relates (in earthworm.d) to a unique number for the key to the shared
memory region. Gmew writes TYPE_STRONGMOTIONII, TYPE_HEARTBEAT and 
TYPE_ERROR messages to this ring. RingOutName can be the same as RingInName if
desired.</ul>
<PRE STYLE="margin-left: 0.39in; margin-right: 0.39in">
Default:  none
Example:  RingOutName SM_RING</PRE>
<HR></TR>

<TR><TD><A NAME="saveTrace"></A>saveTrace ST [params] <FONT
COLOR="#ff0000">DIR FORMAT</FONT><TD>Event and Trace Commands</TR>
<TR><TD colspan=2><ul>Tells gmew whether and how to save synthetic
 traces. If the <B>saveTrace</B> command is absent, no traces
will be saved. Choices for <B>ST</B> include:
<dl>
  <dt><FONT COLOR="#ff0000">SAC baseDir dirFormat filename-format</FONT>
  <dd>Save synthetic traces in SAC-format files. The full pathname for
  each SAC file will be made up of base directory, formatted directory, and
  formatted filename plus a descriptive ending; all concatenated together with
  appropriate path separators. The endings are "-acc", "-vel", "-disp",
  "-psa03", "-psa10" and "-psa30" for the appropriate traces.
    <dl>
       <dt><FONT COLOR="#ff0000">baseDir</FONT>
       <dd>Specifies a fixed directory name. This can be an absolute directory
       path or a path relative to the current directory. It can contain one or
       more parts with pathname separators. This all components of this path
       (except possibly the last) must exist before gmew is started.

       <dt><FONT COLOR="#ff0000">dirFormat</FONT>
       <dd>Gives a formattted subdirectory name; the format string is that
       used for the Unix <B>date</B> command applied to the event origin time,
       with the addition of `%i' to indicate the event ID. Be careful with
       this; some formats produce output not compatible with directory names.
       The directory name derived from <B>dirFormat</B> must not contain any
       path separators. Suitable format strings include:
       <dl>
         <dt><FONT COLOR="#ff0000">%C</FONT>
         <dd>Century number (the year divided by 100 and truncated to an
       integer as a decimal number [1,99]); single digits are preceded by 0.
         <dt><FONT COLOR="#ff0000">%d</FONT>
         <dd>Day of month [1,31]; single digits are preceded by 0.
         <dt><FONT COLOR="#ff0000">%h</FONT>
         <dd>Locale's abbreviated month name.
         <dt><FONT COLOR="#ff0000">%H</FONT>
         <dd>Hour (24-hour clock) [0,23]; single digits are preceded by 0.
         <dt><FONT COLOR="#ff0000">%i</FONT>
         <dd>The Earthworm event ID. Currently this event ID can only be read
       from a hyp2000 archive message.
         <dt><FONT COLOR="#ff0000">%j</FONT>
         <dd>Day number of year [1,366]; single digits are preceded by 0.
         <dt><FONT COLOR="#ff0000">%m</FONT>
         <dd>Month number [1,12]; single digits are preceded by 0.
         <dt><FONT COLOR="#ff0000">%M</FONT>
         <dd>Minute [00,59]; leading zero is permitted but not required.
         <dt><FONT COLOR="#ff0000">%R</FONT>
         <dd>Time as %H:%M
         <dt><FONT COLOR="#ff0000">%S</FONT>
         <dd>Seconds [00,61]
         <dt><FONT COLOR="#ff0000">%T</FONT>
         <dd>Time as %H:%M:%S
         <dt><FONT COLOR="#ff0000">%u</FONT>
         <dd>Weekday as a decimal number [1,7], with 1 representing Sunday.
         <dt><FONT COLOR="#ff0000">%U</FONT>
         <dd>Week number of year as  a  decimal  number [00,53], with Sunday
       as the first day of week 1.
         <dt><FONT COLOR="#ff0000">%V</FONT>
         <dd>Week number of the year as a decimal number [01,53],
             with  Monday  as  the first day of the week.  If the
             week containing 1 January has four or more  days  in
             the  new  year, then it is considered week 1; otherwise, it is
       week 53 of the previous  year,  and  the next week is week 1.
         <dt><FONT COLOR="#ff0000">%w</FONT>
         <dd>Weekday as a decimal number [0,6], with 0 representing Sunday.
         <dt><FONT COLOR="#ff0000">%W</FONT>
         <dd>Week number of year as  a  decimal  number  [00,53],
             with Monday as the first day of week 1.
         <dt><FONT COLOR="#ff0000">%y</FONT>
         <dd>Year within century [00,99].
         <dt><FONT COLOR="#ff0000">%Y</FONT>
         <dd>Year, including the century (for example 1993),
       </dl>

       <dt><FONT COLOR="#ff0000">filename-format </FONT>
       <dd>Gives the formatted file name using % to introduce one of the
       format specifiers "sScCnN%" `s' is the station name in lower case; `S'
       is upper case. Likewise for component and network names; `%' stands for
       itself. All other characters are taken literally. This works in the
       same way as the format string for response files.
    </dl>

    Gmew adds the following special fields to SAC file headers. The peak
    amplitude is written to user0; in t0 is the time, relitive to event
    origin, of the peak amplitude. In kuser0 and kt0 are the labels for these
    user values. For the acceleration, the labels would be "Acc_max" and
    "Acc_amp", respectively. Other traces have similar labels. The SAC header
    variable kinst has the units for the trace, such as "cm/sec^2" for
    acceleration. 

</dl></ul>
<PRE STYLE="margin-left: 0.39in; margin-right: 0.39in">
Default:  command is absent (no traces are saved)
Example: SAC /earthworm/SAC/GM %Y%j%i %S.%C.%N
<HR></TR>

<TR><TD><A NAME="SCNpar"></A>SCNpar <FONT
COLOR="#ff0000">STA COMP NET special-parameters</FONT><TD>Auxilliary Data
Sources</TR>
<TR><TD colspan=2><ul>Set certain parameters (described below) for specific
traces identified by their SCN: <B>STA</B>, <B>COMP</B>, and <B>NET</B>
(station/component/network name.) No wildcards are permitted here; each SCN
must be given explicitly, but only if special values are needed for that
SCN. Often, the default values will be adequate for most SCNs. If there are
only a few of these commands, they may be listed in the configuration
file. But if a large number of them are needed, it may be more convenient to
place them in a separate file. Then that file will get included with the
configuration file by the syntax: <BLOCKQUOTE>@scn_param_file</BLOCKQUOTE>
Note that the format of this files is identical to the one used by the
localmag module.
Each SCNpar command must include the STA, COMP, NET names followed by the
following seven decimal values. Use spaces between all elevent items in each SCNpar
line. All values must be present; no default values are used for an SCN if it
has an SCNpar line. The seven decimal values are:
<dl>
  <dt><FONT COLOR="#ff0000">magnitude correction</FONT>
  <dd>This value is ignored by gmew; it is used only by the localmag module.
  <dt><FONT COLOR="#ff0000">taper low-freq off</FONT>
  <dd>The frequency at the low end of the passband below which the cosine
  taper has zero value. This taper is applied to the frequency response
  function before it is convolved with the trace. Frequency units are Hz.
  <dt><FONT COLOR="#ff0000">taper low-freq on</FONT>
  <dd>The frequency at the low end of the passband above which the cosine
  taper has a value of 1. The low-end taper can be eliminated by setting the
  off and on values to the same value. The default low-end taper is turned
  off, passing all low frequencies.
  <dt><FONT COLOR="#ff0000">taper high-freq on</FONT>
  <dd>The frequency at the high end of the passband below which the cosine
  taper has a value of 1.
  <dt><FONT COLOR="#ff0000">taper high-freq off</FONT>
  <dd>The frequency at the high end of the passband above which the cosine
  taper has a value of 0. The high-end taper can be eliminated by setting the
  off and on values to the same value. The default high-end taper has an off
  value equal to the trace Nyquist frequency (one half the sample rate.) The
  default on frequency is 90% of the Nyquist frequency.
  <dt><FONT COLOR="#ff0000">clipping limit</FONT>
  <dd>The value, in digital counts, beyond which in absolute value the
  unprocessed trace should be considered clipped. If the trace is declared
  clipped by gmew, it will synthesized into ground motion traces, but it
  will not have amplitude picks performed. The
  default clipping limit is 7.55e+06 counts, 90% of 2^23, the limit of a
  24-bit digitizer.
  <dt><FONT COLOR="#ff0000">taper time interval</FONT>
  <dd>The number of seconds for which a cosine taper will be applied to both
  ends of the input time series before it is transformed to the frequency
  domain. This taper will shorten the useful length of the time series from
  the length specifed by the <A HREF="#traceTimes">traceTimes</A> command by
  twice this taper interval. The default value is 0 - no taper is applied to
  time series. 
</dl></ul>
<PRE STYLE="margin-left: 0.39in; margin-right: 0.39in">
Default: as described above
Example: SCNpar SEA EHE UW 0.2   0.1 0.1 20 25   2.9e4 1.0
<HR></TR>

<TR><TD><A NAME="searchWindow"></A>searchWindow <FONT
COLOR="#ff0000">A B C D</FONT><TD>Amplitude Controls</TR>
<TR><TD colspan=2><ul>Specify the time interval in which gmew will search
for peak amplitudes in the synthetic traces. Together with the P- and
S-phase arrival times estimated from the <A HREF="#velocity">velocity
model</A>, these four parameters set the start and end times of this search
window. The four parameters are:
<dl>
  <dt><FONT COLOR="#ff0000">A</FONT>:
  <dd>The multiple of the estimated interval P - S to start the search before
  estimated S arrival. Use a negative value to start after the S arrival.
  <dt><FONT COLOR="#ff0000">B</FONT>:
  <dd>The minimum number of seconds before estimated S arrival to start the
  peak search.
  <dt><FONT COLOR="#ff0000">C</FONT>:
  <dd>The multiple of the estimated interval P - S to end the search after the
  estimated S arrival. 
  <dt><FONT COLOR="#ff0000">D</FONT>:
  <dd>The minimum number of seconds after estimated S arrival to start the
  peak search.
</dl></ul>
<PRE STYLE="margin-left: 0.39in; margin-right: 0.39in">
Default: searchWindow 0.0 2.0 0.0 30.0 # Search window runs from 2 seconds
        before to 30 seconds after the estimated S arrival, independent of
        the P - S interval.
Example: searchWindow 0.1 2.0 2.0 15.0 # some random values
<HR></TR>

<TR><TD><A NAME="staLoc"></A>staLoc <FONT
COLOR="#ff0000">LOC [params]</FONT><TD>Auxilliary Data Sources</TR>
<TR><TD colspan=2><ul>Tells gmew where to find station location
information. Station locations are used to find the station-epicenter
distance, which is then used in the estimate of P and S phase arrivals. The
choices for <B>LOC</B> are: 
<dl>
  <dt><FONT COLOR="#ff0000">File loc-file</FONT>:
  <dd>Get station locations from a hyp2000-format station location file named
     <B>loc-file</B>. This file must be in text format, not the binary-format
     file sometimes used by hyp2000. If the file is not located in the current
     directory, partial or full path information must be included in
     <B>loc-file</B>.
  <dt><FONT COLOR="#ff0000">EWDB</FONT>
  <dd>Query the Earthworm database for station locations. Not currently
  implemented. 
</dl></ul>
<PRE STYLE="margin-left: 0.39in; margin-right: 0.39in">
Default: none; this command is required
Example: staLoc File /earthworm/run/params/hypoinverse/stas/uw_sta.hinv
<HR></TR>

<TR><TD><A NAME="TempDir"></A>TempDir <FONT
COLOR="#ff0000">temp-dir</FONT><TD>Miscellaneous Commands</TR>
<TR><TD colspan=2><ul>Specify the temporary directory for writing an XML file
(see <A HREF="#XMLDir">XMLDir</A>). This command is ignored unless an XMLDir
command is given, in which case TempDIr is required.
</ul>
<PRE STYLE="margin-left: 0.39in; margin-right: 0.39in">
Default: none; this command is required if XMLDir is given
Example: TempDir Shake/temp
<HR></TR>

<TR><TD><A NAME="traceSource"></A>tracesource <FONT
COLOR="#ff0000">SOURCE [params]</FONT><TD>Event and Trace Commands</TR>
<TR><TD colspan=2><ul>Directs gmew to obtain trace data from
<B>SOURCE</B>. Choices are:
<dl>
  <dt><FONT COLOR="#ff0000">waveServer server-list</FONT>
  <dd>Obtain trace data from the wave servers in <B>server-list</B>, a space
  delimited list of one or more <B>server:port</B> pairs. The <B>server</B>
  can be an IP address or a hostname for the wave server. The <B>port</B> is
  the port number used by that wave server.

  <dt><FONT COLOR="#ff0000">waveServer File server-file</FONT>
  <dd>Command line: <B>-tv</B>Obtain trace data from the wave servers listed
  in the file named <B>server-file</B>. This file consists of lines listing
  <B>server</B> and <B>port</B>, one server to each line. The two entries on a
  line may be separated by space or colon.
  <P>Gmew will connect to one server at a
  time. For each connection, it will obtain the server's current menu, match
  SCNs on the menu against the selection list from <A HREF="#Add">Add</A> and
  <A HREF="#Del">Del</A> commands, obtain and process the trace data segment
  for each of the selected SCNs. The time interval for each trace is
  established by the <A HREF"#traceTimes">traceTimes</A> command. After all
  the selected SCNs for one wave server have been processed, the connection to
  that server will be closed and the next server will be accessed.

</dl></ul>
<PRE STYLE="margin-left: 0.39in; margin-right: 0.39in">
Default:  waveServer with list of servers read from the file $EW_PARAMS/servers
Example: traceSource waveServer 123.45.67.89:16021 123.45.67.89:16022
<HR></TR>

<TR><TD><A NAME="traceTimes"></A>traceTimes <FONT
COLOR="#ff0000">START END</FONT><TD>Event and Trace Commands</TR>
<TR><TD colspan=2><ul>Specify the start and end times of trace data to be used
from any trace source. 
<dl>
  <dt><FONT COLOR="#ff0000">START</FONT>:
  <dd>is the number of seconds before estimated P arrival to start the trace.

  <dt><FONT COLOR="#ff0000">END</FONT>:
  <dd>is the number of seconds after estimated S arrival to end the trace.
</dl></ul>
<PRE STYLE="margin-left: 0.39in; margin-right: 0.39in">
Default: traceTimes 5.0 60.0
Example: traceTimes 10.0 40.0
<HR></TR>

<TR><TD><A NAME="velocity"></A>velocity model<TD>Auxilliary Data Sources</TR>
<TR><TD colspan=2><ul>Read in the one-dimensional velocity model to be used to
estimate P and S phase arrival times. This is done using the syntax:
<BLOCKQUOTE>@velocity_file</BLOCKQUOTE> Typically this will be the same file
as used for binder_ew. Gmew will always look for this file in the current
directory, so appropriate path information must be included if the file is
located elsewhere. Ask Earthworm Central for documentation of this long-used
file format.
<PRE STYLE="margin-left: 0.39in; margin-right: 0.39in">
Default:  none
Example: @/earthworm/run/params/uw_velovity.d
<HR></TmR>

<TR><TD><A NAME="wsTimeout"></A>wsTimeout <FONT
COLOR="#ff0000">M</FONT><TD>Miscellaneous Commands</TR>
<TR><TD colspan=2><ul>Set the timeout for wave server connections to <B>M</B>
milliseconds. If no response is heard from the wave server after this time,
gmew will assume this wave server is dead and proceed to the next one.
<PRE STYLE="margin-left: 0.39in; margin-right: 0.39in">
Default: 5000 milliseconds
Example: wsTimeout 10000
<HR></TR>

<TR><TD><A NAME="XMLDir"></A>XMLDir <FONT
COLOR="#ff0000">xml-dir</FONT><TD>Miscellaneous Commands</TR>
<TR><TD colspan=2><ul>Gmew can optionally write an XML file for an event. This
file will be in the format used by ShakeMap (version 2). While the file is
being written, it will reside in <A HREF="#TempDir">temp-dir</A>. When the file
is completed, it will be moved to <FONT COLOR="#ff0000">xml-dir</FONT>. The
file's name will be "_dig_dat.xml" with the Event ID prepended. By writing to
a temporary directory and moving the completed file to xml-dir, gmew will
ensure that only a complete XML file will be in xml-dir. (On Unix, you must
ensure that temp-dir and xml-dir are on the same filesystem; otherwise the
file movement will not be an atomic operation.)


<PRE STYLE="margin-left: 0.39in; margin-right: 0.39in">
Default: XMLDir command not given; no XML file is written
Example: XMLDir  Shake/input
<HR></TR>
</TABLE>

<H2><A NAME="sample_config"></A><BR>3. Sample Configuration File 
</H2>

<PRE>
# Configuration file for gmew
# Some of these parameters can be overridden on the command-line;
# some of them only make sense on the command-line.
#
# Required Commands: 
# The following five commands are always required by gmew.
# Other commands below may be required when certain options are given.
#
# Earthworm Transport commands
# RingInName <ring>: specify the name of the earthworm transport ring from
#  which to read TYPE_HYP2000ARC messages for event notification.

RingInName HYPO_RING

# RingOutName <ring>: specify the name of the earthworm transport ring from
#  which to write Magnitude, Heartbeat and Error messages. This may be
#  the same is the RingInName if desired.

RingOutName GM_RING

# MyModId &lt;module-id&gt;: specify the module ID for gmew
 MyModId MOD_GMEW

# HeartBeatInterval int: How often gmew should beat its heart.

HeartBeatInterval 30

# getEventsFrom  INST_ID MOD_ID
# Specify the installation ID and module ID names from which to get
# hypoinverse archive messages to read event data. These names may be
# selected from earthworm.d and earthworm_global.d. No default values.
Use as many of these commands as necessary.

getEventsFrom INST_UW MOD_WILDCARD
getEventsFrom INST_MENLO MOD_WILDCARD


# maxSta number
# The number of stations to be used by gmew must be specified with
# the maxSta command. This is the number of unique SNs to be used; each
# SN combination can have any number of components. The maxSta command
# must come before any "Pri" commands.

maxSta 100

# maxDist km
# The maximum epicenter - station distance in kilometers. 
# Stations lying outside this radius will not be used by gmew.
#
maxDist 600


# maxTrace nsamples
# The maximum number of trace data samples to process from one SCN.
# This is the product of the trace length in seconds and the highest 
# expected sample rate. For example, 10 minutes of data at 100 samples per
# second gives 60000 samples.

maxTrace 60000


# staLoc: station location source
#    Choices: File &lt; loc-file&gt; - get station locations from a hyp2000-format
#                               file named loc-file
#             EWDB - query the EW database for station locations; access info
#                    given below.

staLoc File /earthworm/run/params/hypoinverse/stas/uw_sta.hinv


# Regional Velocity model: must be specified as "@vel_model_file". Typically
#    this will be the same file as used for binder_ew.

@uw_velocity.d


# traceSource: Where gmew will obtain trace data
#    choices are: waveServer <server-list> - raw traces from wave_servers; 
#                              server-list is either a space separated list
#                              of ip-address:port or 
#                           "File <server-file>"
#    default: waveServer with list of servers read from $EW_PARAMS/servers

traceSource waveServer 123.45.67.89:16021 123.45.67.89:16022


# Add STA COMP NET
# Del STA COMP NET
# SCN selection is done by a selection list and a rejection list.
# The station selection command `Add' specifies the names of 
# STA (station), COMP (component), and NET (network). 
# The wildcard `*' may be used for any or all of STA, COMP, NET.
# COMP may be given as the first two letters of the component name,
# to select all direction desgnators are accepted for that component.
# If no Add commands are given, all SCNs will be selected.
# The Del command is used to put SCNs on the rejection list:
# for example: "Add * EL UW" followed by "Del LAB EL UW" to include
# all ELE and ELN components from UW except LAB.ELE.UW and LAB.ELN.UW.
# List as many Add and Del commands as desired, one to a line

Add * BH *
Add * HH *
Add * SL *
Add * EL *
Del LAB * UW


# respSource: Tells gmew where to get response information; 
#    Choices: EWDB - query the EW databse for pole-zero-gain responses.
#             File &lt; dirname*gt; &lt; pz-filename-format&gt; - find response files in the 
#                            directory dirname. dirname can be 
#                            a full directory name, or relative to $EW_PARAMS.
#                            filename-format is a string similar to printf
#                            format: %S, %C, %N are replaced by station, 
#                            component and network names, respectively,
#                            all in upper case. Similarly %s, %c, %n work
#                            for lower-case station, component and network.
#                            The digraph %% stands for %; all other 
#                            characters are taken literally.
#                            The response file format is that used by SAC.
# 
#    default: none; you must specify one of the above choices.

respSource File responses %S_%C_%N.pz


# traceTimes start end
# The start and end times for traces is set here. 
#   &lt; start&gt; is the number of seconds before estimated P arrival to start
#           the trace.
#   &lt;end&gt; is the number of seconds after estimated S arrival to end the trace.
#   default: traceTimes 5.0 60.0 # starts trace 5 seconds before estimated P
#           arrival and ends trace 60 seconds after estimated S arrival.

traceTimes 5.0 60.0


# searchWindow A B C D
# The time window for searching for peak amplitudes is set here.
#    &lt;A&gt; is the multiple of the estimated interval P - S to start the 
#        search before estimated S arrival.
#    &lt;B&gt; is the minimum number of seconds before estimated S arrival to
#        start the peak search.
#    &lt;C&gt; is the multiple of the estimated interval P - S to end the
#        search after the estimated S arrival.
#    &lt;D&gt; is the minimum number of seconds after estimated S arrival to
#        start the peak search.
# default: searchWindow 0.0 2.0 0.0 30.0 # Search window runs from 2 seconds
#        before to 30 seconds after the estimated S arrival, independent of
#        the P - S interval.

searchWindow 0.0 2.0 0.0 30.0

#saveTrace: whether and how to save synthetic ground-motion traces
#            If saveTrace command is absent, no traces will be saved.
#   Choices: SAC &lt;baseDir&gt; &lt;dirFormat&gt; &lt;filename-format&gt; - 
#                  save gm traces in SAC-format files. 
#                baseDir specifies a fixed directory name.
#                dirFormat gives a formattted subdirectory name; the
#                  format string is that used for the "date" command applied
#                  to the event origin time, with the addition of `%i' 
#                  to indicate the event ID. Be careful with this; some
#                  formats produce output not compatible with file names.
#                filename-format gives the formatted file name using
#                  % to introduce one of the format specifiers "sScCnN%"
#                  `s' is the station name in lower case; `S' is upper case
#                  Likewise for component and network names; `%' stands for
#                  itself. All other characters are taken literally.
#
#   default: None (no traces are saved.)


# XMLDir dirname
# Optional command to cause ground-motion results to be written to
#   a ShakeMap XML file. This directory must already exist.
XMLDir Shake/input

# TempDir dirname
# Temporary directory for writing XML file. If XMLDir is given, TempDir must
#   also be given. On Solaris (Unix), these two directories should be on 
#   the same filesystem. This will ensure that the XML file will be complete
#   as soon as it is moved into XMLDir. This directory must already exist.
TempDir Shake/temp

# MappingFile filename
# To provide descriptive names in the shakemap XML file, a mapping file
#   may optionally be given. This file contain mappings of SCN to instrument 
#   type, SN to long station names, and N to agency names.
MappingFile   PNSN.map              
                                    

# Debug N
# There are several different debug features, listed below. 
# You can give one Debug command for each feature you want to turn on, 
# or you can add together the values of desired features and give 
# one Debug command.
# value   feature
#     1   trace and search times and P and S arrival estimates
#     2   SCN selection tests
#    16   ws_client debugging
#    32   poles. zeros and gain values
#    64   trial frequency response functions to STDOUT
#   128   full frequency response function to STDOUT


# SCN Parameters: normally this command will be given as "@scn_param_file"
# to cause the separate file "scn_param_file" to be processed.
</PRE>
<hr>

<hr>
<P ALIGN=CENTER STYLE="margin-bottom: 0in"><A HREF="../modules.html">Module
Index</A> | <A HREF="../ovr/gmew_ovr.html">gmew Overview</A> 
</P>
<P STYLE="border-top: none; border-bottom: 1.10pt double #808080; border-left: none; border-right: none; padding: 0in">
<FONT SIZE=1 STYLE="font-size: 6pt"><!-- USGS-required stuff at the end --></FONT></P>
<ADDRESS>The URL of this page is
<B>[http://www.cnss.org/EWAB/cmd/gmew_cmd.html]</B><BR>Contact:
<B>lombard@gldrocky.cr.usgs.gov</B></ADDRESS>
</BODY>
</HTML>
